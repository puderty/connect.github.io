var Ao=Object.defineProperty;var Eo=(a,t,e)=>t in a?Ao(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var ee=(a,t,e)=>Eo(a,typeof t!="symbol"?t+"":t,e);import{r as mi,B as re,i as ys,j as $,a as Ro,C as Po,p as $i,n as To}from"./ConnectLayout-BJa5Oh9h.js";import{g as de,j as ws,k as yi,d as Bo,a as Hi,_ as Lo,r as Gn,o as jn,c as Jn,w as Re,b as Ir,e as Co,t as No,f as pr,i as Gi}from"./index-axP6eKlA.js";import{e as Or}from"./ed25519-Bz8XlsxS.js";import{b as Oo,a as ae}from"./index-CRAv_Z_H.js";import{s as wi,e as ji}from"./secp256k1-BHJWReMe.js";import{k as Ji}from"./sha3-DfhIl4lu.js";var vs={},gn={},vi={exports:{}};vi.exports;(function(a){(function(t,e){function r(g,n){if(!g)throw new Error(n||"Assertion failed")}function s(g,n){g.super_=n;var c=function(){};c.prototype=n.prototype,g.prototype=new c,g.prototype.constructor=g}function i(g,n,c){if(i.isBN(g))return g;this.negative=0,this.words=null,this.length=0,this.red=null,g!==null&&((n==="le"||n==="be")&&(c=n,n=10),this._init(g||0,n||10,c||"be"))}typeof t=="object"?t.exports=i:e.BN=i,i.BN=i,i.wordSize=26;var u;try{typeof window<"u"&&typeof window.Buffer<"u"?u=window.Buffer:u=mi.Buffer}catch{}i.isBN=function(n){return n instanceof i?!0:n!==null&&typeof n=="object"&&n.constructor.wordSize===i.wordSize&&Array.isArray(n.words)},i.max=function(n,c){return n.cmp(c)>0?n:c},i.min=function(n,c){return n.cmp(c)<0?n:c},i.prototype._init=function(n,c,h){if(typeof n=="number")return this._initNumber(n,c,h);if(typeof n=="object")return this._initArray(n,c,h);c==="hex"&&(c=16),r(c===(c|0)&&c>=2&&c<=36),n=n.toString().replace(/\s+/g,"");var f=0;n[0]==="-"&&(f++,this.negative=1),f<n.length&&(c===16?this._parseHex(n,f,h):(this._parseBase(n,c,f),h==="le"&&this._initArray(this.toArray(),c,h)))},i.prototype._initNumber=function(n,c,h){n<0&&(this.negative=1,n=-n),n<67108864?(this.words=[n&67108863],this.length=1):n<4503599627370496?(this.words=[n&67108863,n/67108864&67108863],this.length=2):(r(n<9007199254740992),this.words=[n&67108863,n/67108864&67108863,1],this.length=3),h==="le"&&this._initArray(this.toArray(),c,h)},i.prototype._initArray=function(n,c,h){if(r(typeof n.length=="number"),n.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(n.length/3),this.words=new Array(this.length);for(var f=0;f<this.length;f++)this.words[f]=0;var p,y,v=0;if(h==="be")for(f=n.length-1,p=0;f>=0;f-=3)y=n[f]|n[f-1]<<8|n[f-2]<<16,this.words[p]|=y<<v&67108863,this.words[p+1]=y>>>26-v&67108863,v+=24,v>=26&&(v-=26,p++);else if(h==="le")for(f=0,p=0;f<n.length;f+=3)y=n[f]|n[f+1]<<8|n[f+2]<<16,this.words[p]|=y<<v&67108863,this.words[p+1]=y>>>26-v&67108863,v+=24,v>=26&&(v-=26,p++);return this._strip()};function m(g,n){var c=g.charCodeAt(n);if(c>=48&&c<=57)return c-48;if(c>=65&&c<=70)return c-55;if(c>=97&&c<=102)return c-87;r(!1,"Invalid character in "+g)}function w(g,n,c){var h=m(g,c);return c-1>=n&&(h|=m(g,c-1)<<4),h}i.prototype._parseHex=function(n,c,h){this.length=Math.ceil((n.length-c)/6),this.words=new Array(this.length);for(var f=0;f<this.length;f++)this.words[f]=0;var p=0,y=0,v;if(h==="be")for(f=n.length-1;f>=c;f-=2)v=w(n,c,f)<<p,this.words[y]|=v&67108863,p>=18?(p-=18,y+=1,this.words[y]|=v>>>26):p+=8;else{var l=n.length-c;for(f=l%2===0?c+1:c;f<n.length;f+=2)v=w(n,c,f)<<p,this.words[y]|=v&67108863,p>=18?(p-=18,y+=1,this.words[y]|=v>>>26):p+=8}this._strip()};function b(g,n,c,h){for(var f=0,p=0,y=Math.min(g.length,c),v=n;v<y;v++){var l=g.charCodeAt(v)-48;f*=h,l>=49?p=l-49+10:l>=17?p=l-17+10:p=l,r(l>=0&&p<h,"Invalid character"),f+=p}return f}i.prototype._parseBase=function(n,c,h){this.words=[0],this.length=1;for(var f=0,p=1;p<=67108863;p*=c)f++;f--,p=p/c|0;for(var y=n.length-h,v=y%f,l=Math.min(y,y-v)+h,o=0,d=h;d<l;d+=f)o=b(n,d,d+f,c),this.imuln(p),this.words[0]+o<67108864?this.words[0]+=o:this._iaddn(o);if(v!==0){var P=1;for(o=b(n,d,n.length,c),d=0;d<v;d++)P*=c;this.imuln(P),this.words[0]+o<67108864?this.words[0]+=o:this._iaddn(o)}this._strip()},i.prototype.copy=function(n){n.words=new Array(this.length);for(var c=0;c<this.length;c++)n.words[c]=this.words[c];n.length=this.length,n.negative=this.negative,n.red=this.red};function M(g,n){g.words=n.words,g.length=n.length,g.negative=n.negative,g.red=n.red}if(i.prototype._move=function(n){M(n,this)},i.prototype.clone=function(){var n=new i(null);return this.copy(n),n},i.prototype._expand=function(n){for(;this.length<n;)this.words[this.length++]=0;return this},i.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{i.prototype[Symbol.for("nodejs.util.inspect.custom")]=x}catch{i.prototype.inspect=x}else i.prototype.inspect=x;function x(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var L=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],_=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],E=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(n,c){n=n||10,c=c|0||1;var h;if(n===16||n==="hex"){h="";for(var f=0,p=0,y=0;y<this.length;y++){var v=this.words[y],l=((v<<f|p)&16777215).toString(16);p=v>>>24-f&16777215,f+=2,f>=26&&(f-=26,y--),p!==0||y!==this.length-1?h=L[6-l.length]+l+h:h=l+h}for(p!==0&&(h=p.toString(16)+h);h.length%c!==0;)h="0"+h;return this.negative!==0&&(h="-"+h),h}if(n===(n|0)&&n>=2&&n<=36){var o=_[n],d=E[n];h="";var P=this.clone();for(P.negative=0;!P.isZero();){var R=P.modrn(d).toString(n);P=P.idivn(d),P.isZero()?h=R+h:h=L[o-R.length]+R+h}for(this.isZero()&&(h="0"+h);h.length%c!==0;)h="0"+h;return this.negative!==0&&(h="-"+h),h}r(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var n=this.words[0];return this.length===2?n+=this.words[1]*67108864:this.length===3&&this.words[2]===1?n+=4503599627370496+this.words[1]*67108864:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-n:n},i.prototype.toJSON=function(){return this.toString(16,2)},u&&(i.prototype.toBuffer=function(n,c){return this.toArrayLike(u,n,c)}),i.prototype.toArray=function(n,c){return this.toArrayLike(Array,n,c)};var A=function(n,c){return n.allocUnsafe?n.allocUnsafe(c):new n(c)};i.prototype.toArrayLike=function(n,c,h){this._strip();var f=this.byteLength(),p=h||Math.max(1,f);r(f<=p,"byte array longer than desired length"),r(p>0,"Requested array length <= 0");var y=A(n,p),v=c==="le"?"LE":"BE";return this["_toArrayLike"+v](y,f),y},i.prototype._toArrayLikeLE=function(n,c){for(var h=0,f=0,p=0,y=0;p<this.length;p++){var v=this.words[p]<<y|f;n[h++]=v&255,h<n.length&&(n[h++]=v>>8&255),h<n.length&&(n[h++]=v>>16&255),y===6?(h<n.length&&(n[h++]=v>>24&255),f=0,y=0):(f=v>>>24,y+=2)}if(h<n.length)for(n[h++]=f;h<n.length;)n[h++]=0},i.prototype._toArrayLikeBE=function(n,c){for(var h=n.length-1,f=0,p=0,y=0;p<this.length;p++){var v=this.words[p]<<y|f;n[h--]=v&255,h>=0&&(n[h--]=v>>8&255),h>=0&&(n[h--]=v>>16&255),y===6?(h>=0&&(n[h--]=v>>24&255),f=0,y=0):(f=v>>>24,y+=2)}if(h>=0)for(n[h--]=f;h>=0;)n[h--]=0},Math.clz32?i.prototype._countBits=function(n){return 32-Math.clz32(n)}:i.prototype._countBits=function(n){var c=n,h=0;return c>=4096&&(h+=13,c>>>=13),c>=64&&(h+=7,c>>>=7),c>=8&&(h+=4,c>>>=4),c>=2&&(h+=2,c>>>=2),h+c},i.prototype._zeroBits=function(n){if(n===0)return 26;var c=n,h=0;return c&8191||(h+=13,c>>>=13),c&127||(h+=7,c>>>=7),c&15||(h+=4,c>>>=4),c&3||(h+=2,c>>>=2),c&1||h++,h},i.prototype.bitLength=function(){var n=this.words[this.length-1],c=this._countBits(n);return(this.length-1)*26+c};function N(g){for(var n=new Array(g.bitLength()),c=0;c<n.length;c++){var h=c/26|0,f=c%26;n[c]=g.words[h]>>>f&1}return n}i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var n=0,c=0;c<this.length;c++){var h=this._zeroBits(this.words[c]);if(n+=h,h!==26)break}return n},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(n){return this.negative!==0?this.abs().inotn(n).iaddn(1):this.clone()},i.prototype.fromTwos=function(n){return this.testn(n-1)?this.notn(n).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(n){for(;this.length<n.length;)this.words[this.length++]=0;for(var c=0;c<n.length;c++)this.words[c]=this.words[c]|n.words[c];return this._strip()},i.prototype.ior=function(n){return r((this.negative|n.negative)===0),this.iuor(n)},i.prototype.or=function(n){return this.length>n.length?this.clone().ior(n):n.clone().ior(this)},i.prototype.uor=function(n){return this.length>n.length?this.clone().iuor(n):n.clone().iuor(this)},i.prototype.iuand=function(n){var c;this.length>n.length?c=n:c=this;for(var h=0;h<c.length;h++)this.words[h]=this.words[h]&n.words[h];return this.length=c.length,this._strip()},i.prototype.iand=function(n){return r((this.negative|n.negative)===0),this.iuand(n)},i.prototype.and=function(n){return this.length>n.length?this.clone().iand(n):n.clone().iand(this)},i.prototype.uand=function(n){return this.length>n.length?this.clone().iuand(n):n.clone().iuand(this)},i.prototype.iuxor=function(n){var c,h;this.length>n.length?(c=this,h=n):(c=n,h=this);for(var f=0;f<h.length;f++)this.words[f]=c.words[f]^h.words[f];if(this!==c)for(;f<c.length;f++)this.words[f]=c.words[f];return this.length=c.length,this._strip()},i.prototype.ixor=function(n){return r((this.negative|n.negative)===0),this.iuxor(n)},i.prototype.xor=function(n){return this.length>n.length?this.clone().ixor(n):n.clone().ixor(this)},i.prototype.uxor=function(n){return this.length>n.length?this.clone().iuxor(n):n.clone().iuxor(this)},i.prototype.inotn=function(n){r(typeof n=="number"&&n>=0);var c=Math.ceil(n/26)|0,h=n%26;this._expand(c),h>0&&c--;for(var f=0;f<c;f++)this.words[f]=~this.words[f]&67108863;return h>0&&(this.words[f]=~this.words[f]&67108863>>26-h),this._strip()},i.prototype.notn=function(n){return this.clone().inotn(n)},i.prototype.setn=function(n,c){r(typeof n=="number"&&n>=0);var h=n/26|0,f=n%26;return this._expand(h+1),c?this.words[h]=this.words[h]|1<<f:this.words[h]=this.words[h]&~(1<<f),this._strip()},i.prototype.iadd=function(n){var c;if(this.negative!==0&&n.negative===0)return this.negative=0,c=this.isub(n),this.negative^=1,this._normSign();if(this.negative===0&&n.negative!==0)return n.negative=0,c=this.isub(n),n.negative=1,c._normSign();var h,f;this.length>n.length?(h=this,f=n):(h=n,f=this);for(var p=0,y=0;y<f.length;y++)c=(h.words[y]|0)+(f.words[y]|0)+p,this.words[y]=c&67108863,p=c>>>26;for(;p!==0&&y<h.length;y++)c=(h.words[y]|0)+p,this.words[y]=c&67108863,p=c>>>26;if(this.length=h.length,p!==0)this.words[this.length]=p,this.length++;else if(h!==this)for(;y<h.length;y++)this.words[y]=h.words[y];return this},i.prototype.add=function(n){var c;return n.negative!==0&&this.negative===0?(n.negative=0,c=this.sub(n),n.negative^=1,c):n.negative===0&&this.negative!==0?(this.negative=0,c=n.sub(this),this.negative=1,c):this.length>n.length?this.clone().iadd(n):n.clone().iadd(this)},i.prototype.isub=function(n){if(n.negative!==0){n.negative=0;var c=this.iadd(n);return n.negative=1,c._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(n),this.negative=1,this._normSign();var h=this.cmp(n);if(h===0)return this.negative=0,this.length=1,this.words[0]=0,this;var f,p;h>0?(f=this,p=n):(f=n,p=this);for(var y=0,v=0;v<p.length;v++)c=(f.words[v]|0)-(p.words[v]|0)+y,y=c>>26,this.words[v]=c&67108863;for(;y!==0&&v<f.length;v++)c=(f.words[v]|0)+y,y=c>>26,this.words[v]=c&67108863;if(y===0&&v<f.length&&f!==this)for(;v<f.length;v++)this.words[v]=f.words[v];return this.length=Math.max(this.length,v),f!==this&&(this.negative=1),this._strip()},i.prototype.sub=function(n){return this.clone().isub(n)};function U(g,n,c){c.negative=n.negative^g.negative;var h=g.length+n.length|0;c.length=h,h=h-1|0;var f=g.words[0]|0,p=n.words[0]|0,y=f*p,v=y&67108863,l=y/67108864|0;c.words[0]=v;for(var o=1;o<h;o++){for(var d=l>>>26,P=l&67108863,R=Math.min(o,n.length-1),T=Math.max(0,o-g.length+1);T<=R;T++){var zt=o-T|0;f=g.words[zt]|0,p=n.words[T]|0,y=f*p+P,d+=y/67108864|0,P=y&67108863}c.words[o]=P|0,l=d|0}return l!==0?c.words[o]=l|0:c.length--,c._strip()}var G=function(n,c,h){var f=n.words,p=c.words,y=h.words,v=0,l,o,d,P=f[0]|0,R=P&8191,T=P>>>13,zt=f[1]|0,V=zt&8191,H=zt>>>13,Dr=f[2]|0,J=Dr&8191,Z=Dr>>>13,Vr=f[3]|0,Y=Vr&8191,X=Vr>>>13,$r=f[4]|0,Q=$r&8191,tt=$r>>>13,Hr=f[5]|0,et=Hr&8191,rt=Hr>>>13,Gr=f[6]|0,nt=Gr&8191,it=Gr>>>13,jr=f[7]|0,st=jr&8191,ot=jr>>>13,Jr=f[8]|0,at=Jr&8191,ct=Jr>>>13,Zr=f[9]|0,ut=Zr&8191,ht=Zr>>>13,Yr=p[0]|0,lt=Yr&8191,ft=Yr>>>13,Xr=p[1]|0,dt=Xr&8191,pt=Xr>>>13,Qr=p[2]|0,gt=Qr&8191,mt=Qr>>>13,tn=p[3]|0,yt=tn&8191,wt=tn>>>13,en=p[4]|0,vt=en&8191,bt=en>>>13,rn=p[5]|0,kt=rn&8191,St=rn>>>13,nn=p[6]|0,Mt=nn&8191,_t=nn>>>13,sn=p[7]|0,xt=sn&8191,It=sn>>>13,on=p[8]|0,At=on&8191,Et=on>>>13,an=p[9]|0,Rt=an&8191,Pt=an>>>13;h.negative=n.negative^c.negative,h.length=19,l=Math.imul(R,lt),o=Math.imul(R,ft),o=o+Math.imul(T,lt)|0,d=Math.imul(T,ft);var Je=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(Je>>>26)|0,Je&=67108863,l=Math.imul(V,lt),o=Math.imul(V,ft),o=o+Math.imul(H,lt)|0,d=Math.imul(H,ft),l=l+Math.imul(R,dt)|0,o=o+Math.imul(R,pt)|0,o=o+Math.imul(T,dt)|0,d=d+Math.imul(T,pt)|0;var Ze=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(Ze>>>26)|0,Ze&=67108863,l=Math.imul(J,lt),o=Math.imul(J,ft),o=o+Math.imul(Z,lt)|0,d=Math.imul(Z,ft),l=l+Math.imul(V,dt)|0,o=o+Math.imul(V,pt)|0,o=o+Math.imul(H,dt)|0,d=d+Math.imul(H,pt)|0,l=l+Math.imul(R,gt)|0,o=o+Math.imul(R,mt)|0,o=o+Math.imul(T,gt)|0,d=d+Math.imul(T,mt)|0;var Ye=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(Ye>>>26)|0,Ye&=67108863,l=Math.imul(Y,lt),o=Math.imul(Y,ft),o=o+Math.imul(X,lt)|0,d=Math.imul(X,ft),l=l+Math.imul(J,dt)|0,o=o+Math.imul(J,pt)|0,o=o+Math.imul(Z,dt)|0,d=d+Math.imul(Z,pt)|0,l=l+Math.imul(V,gt)|0,o=o+Math.imul(V,mt)|0,o=o+Math.imul(H,gt)|0,d=d+Math.imul(H,mt)|0,l=l+Math.imul(R,yt)|0,o=o+Math.imul(R,wt)|0,o=o+Math.imul(T,yt)|0,d=d+Math.imul(T,wt)|0;var Xe=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,l=Math.imul(Q,lt),o=Math.imul(Q,ft),o=o+Math.imul(tt,lt)|0,d=Math.imul(tt,ft),l=l+Math.imul(Y,dt)|0,o=o+Math.imul(Y,pt)|0,o=o+Math.imul(X,dt)|0,d=d+Math.imul(X,pt)|0,l=l+Math.imul(J,gt)|0,o=o+Math.imul(J,mt)|0,o=o+Math.imul(Z,gt)|0,d=d+Math.imul(Z,mt)|0,l=l+Math.imul(V,yt)|0,o=o+Math.imul(V,wt)|0,o=o+Math.imul(H,yt)|0,d=d+Math.imul(H,wt)|0,l=l+Math.imul(R,vt)|0,o=o+Math.imul(R,bt)|0,o=o+Math.imul(T,vt)|0,d=d+Math.imul(T,bt)|0;var Qe=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(Qe>>>26)|0,Qe&=67108863,l=Math.imul(et,lt),o=Math.imul(et,ft),o=o+Math.imul(rt,lt)|0,d=Math.imul(rt,ft),l=l+Math.imul(Q,dt)|0,o=o+Math.imul(Q,pt)|0,o=o+Math.imul(tt,dt)|0,d=d+Math.imul(tt,pt)|0,l=l+Math.imul(Y,gt)|0,o=o+Math.imul(Y,mt)|0,o=o+Math.imul(X,gt)|0,d=d+Math.imul(X,mt)|0,l=l+Math.imul(J,yt)|0,o=o+Math.imul(J,wt)|0,o=o+Math.imul(Z,yt)|0,d=d+Math.imul(Z,wt)|0,l=l+Math.imul(V,vt)|0,o=o+Math.imul(V,bt)|0,o=o+Math.imul(H,vt)|0,d=d+Math.imul(H,bt)|0,l=l+Math.imul(R,kt)|0,o=o+Math.imul(R,St)|0,o=o+Math.imul(T,kt)|0,d=d+Math.imul(T,St)|0;var tr=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(tr>>>26)|0,tr&=67108863,l=Math.imul(nt,lt),o=Math.imul(nt,ft),o=o+Math.imul(it,lt)|0,d=Math.imul(it,ft),l=l+Math.imul(et,dt)|0,o=o+Math.imul(et,pt)|0,o=o+Math.imul(rt,dt)|0,d=d+Math.imul(rt,pt)|0,l=l+Math.imul(Q,gt)|0,o=o+Math.imul(Q,mt)|0,o=o+Math.imul(tt,gt)|0,d=d+Math.imul(tt,mt)|0,l=l+Math.imul(Y,yt)|0,o=o+Math.imul(Y,wt)|0,o=o+Math.imul(X,yt)|0,d=d+Math.imul(X,wt)|0,l=l+Math.imul(J,vt)|0,o=o+Math.imul(J,bt)|0,o=o+Math.imul(Z,vt)|0,d=d+Math.imul(Z,bt)|0,l=l+Math.imul(V,kt)|0,o=o+Math.imul(V,St)|0,o=o+Math.imul(H,kt)|0,d=d+Math.imul(H,St)|0,l=l+Math.imul(R,Mt)|0,o=o+Math.imul(R,_t)|0,o=o+Math.imul(T,Mt)|0,d=d+Math.imul(T,_t)|0;var er=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(er>>>26)|0,er&=67108863,l=Math.imul(st,lt),o=Math.imul(st,ft),o=o+Math.imul(ot,lt)|0,d=Math.imul(ot,ft),l=l+Math.imul(nt,dt)|0,o=o+Math.imul(nt,pt)|0,o=o+Math.imul(it,dt)|0,d=d+Math.imul(it,pt)|0,l=l+Math.imul(et,gt)|0,o=o+Math.imul(et,mt)|0,o=o+Math.imul(rt,gt)|0,d=d+Math.imul(rt,mt)|0,l=l+Math.imul(Q,yt)|0,o=o+Math.imul(Q,wt)|0,o=o+Math.imul(tt,yt)|0,d=d+Math.imul(tt,wt)|0,l=l+Math.imul(Y,vt)|0,o=o+Math.imul(Y,bt)|0,o=o+Math.imul(X,vt)|0,d=d+Math.imul(X,bt)|0,l=l+Math.imul(J,kt)|0,o=o+Math.imul(J,St)|0,o=o+Math.imul(Z,kt)|0,d=d+Math.imul(Z,St)|0,l=l+Math.imul(V,Mt)|0,o=o+Math.imul(V,_t)|0,o=o+Math.imul(H,Mt)|0,d=d+Math.imul(H,_t)|0,l=l+Math.imul(R,xt)|0,o=o+Math.imul(R,It)|0,o=o+Math.imul(T,xt)|0,d=d+Math.imul(T,It)|0;var rr=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(rr>>>26)|0,rr&=67108863,l=Math.imul(at,lt),o=Math.imul(at,ft),o=o+Math.imul(ct,lt)|0,d=Math.imul(ct,ft),l=l+Math.imul(st,dt)|0,o=o+Math.imul(st,pt)|0,o=o+Math.imul(ot,dt)|0,d=d+Math.imul(ot,pt)|0,l=l+Math.imul(nt,gt)|0,o=o+Math.imul(nt,mt)|0,o=o+Math.imul(it,gt)|0,d=d+Math.imul(it,mt)|0,l=l+Math.imul(et,yt)|0,o=o+Math.imul(et,wt)|0,o=o+Math.imul(rt,yt)|0,d=d+Math.imul(rt,wt)|0,l=l+Math.imul(Q,vt)|0,o=o+Math.imul(Q,bt)|0,o=o+Math.imul(tt,vt)|0,d=d+Math.imul(tt,bt)|0,l=l+Math.imul(Y,kt)|0,o=o+Math.imul(Y,St)|0,o=o+Math.imul(X,kt)|0,d=d+Math.imul(X,St)|0,l=l+Math.imul(J,Mt)|0,o=o+Math.imul(J,_t)|0,o=o+Math.imul(Z,Mt)|0,d=d+Math.imul(Z,_t)|0,l=l+Math.imul(V,xt)|0,o=o+Math.imul(V,It)|0,o=o+Math.imul(H,xt)|0,d=d+Math.imul(H,It)|0,l=l+Math.imul(R,At)|0,o=o+Math.imul(R,Et)|0,o=o+Math.imul(T,At)|0,d=d+Math.imul(T,Et)|0;var nr=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(nr>>>26)|0,nr&=67108863,l=Math.imul(ut,lt),o=Math.imul(ut,ft),o=o+Math.imul(ht,lt)|0,d=Math.imul(ht,ft),l=l+Math.imul(at,dt)|0,o=o+Math.imul(at,pt)|0,o=o+Math.imul(ct,dt)|0,d=d+Math.imul(ct,pt)|0,l=l+Math.imul(st,gt)|0,o=o+Math.imul(st,mt)|0,o=o+Math.imul(ot,gt)|0,d=d+Math.imul(ot,mt)|0,l=l+Math.imul(nt,yt)|0,o=o+Math.imul(nt,wt)|0,o=o+Math.imul(it,yt)|0,d=d+Math.imul(it,wt)|0,l=l+Math.imul(et,vt)|0,o=o+Math.imul(et,bt)|0,o=o+Math.imul(rt,vt)|0,d=d+Math.imul(rt,bt)|0,l=l+Math.imul(Q,kt)|0,o=o+Math.imul(Q,St)|0,o=o+Math.imul(tt,kt)|0,d=d+Math.imul(tt,St)|0,l=l+Math.imul(Y,Mt)|0,o=o+Math.imul(Y,_t)|0,o=o+Math.imul(X,Mt)|0,d=d+Math.imul(X,_t)|0,l=l+Math.imul(J,xt)|0,o=o+Math.imul(J,It)|0,o=o+Math.imul(Z,xt)|0,d=d+Math.imul(Z,It)|0,l=l+Math.imul(V,At)|0,o=o+Math.imul(V,Et)|0,o=o+Math.imul(H,At)|0,d=d+Math.imul(H,Et)|0,l=l+Math.imul(R,Rt)|0,o=o+Math.imul(R,Pt)|0,o=o+Math.imul(T,Rt)|0,d=d+Math.imul(T,Pt)|0;var ir=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(ir>>>26)|0,ir&=67108863,l=Math.imul(ut,dt),o=Math.imul(ut,pt),o=o+Math.imul(ht,dt)|0,d=Math.imul(ht,pt),l=l+Math.imul(at,gt)|0,o=o+Math.imul(at,mt)|0,o=o+Math.imul(ct,gt)|0,d=d+Math.imul(ct,mt)|0,l=l+Math.imul(st,yt)|0,o=o+Math.imul(st,wt)|0,o=o+Math.imul(ot,yt)|0,d=d+Math.imul(ot,wt)|0,l=l+Math.imul(nt,vt)|0,o=o+Math.imul(nt,bt)|0,o=o+Math.imul(it,vt)|0,d=d+Math.imul(it,bt)|0,l=l+Math.imul(et,kt)|0,o=o+Math.imul(et,St)|0,o=o+Math.imul(rt,kt)|0,d=d+Math.imul(rt,St)|0,l=l+Math.imul(Q,Mt)|0,o=o+Math.imul(Q,_t)|0,o=o+Math.imul(tt,Mt)|0,d=d+Math.imul(tt,_t)|0,l=l+Math.imul(Y,xt)|0,o=o+Math.imul(Y,It)|0,o=o+Math.imul(X,xt)|0,d=d+Math.imul(X,It)|0,l=l+Math.imul(J,At)|0,o=o+Math.imul(J,Et)|0,o=o+Math.imul(Z,At)|0,d=d+Math.imul(Z,Et)|0,l=l+Math.imul(V,Rt)|0,o=o+Math.imul(V,Pt)|0,o=o+Math.imul(H,Rt)|0,d=d+Math.imul(H,Pt)|0;var sr=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(sr>>>26)|0,sr&=67108863,l=Math.imul(ut,gt),o=Math.imul(ut,mt),o=o+Math.imul(ht,gt)|0,d=Math.imul(ht,mt),l=l+Math.imul(at,yt)|0,o=o+Math.imul(at,wt)|0,o=o+Math.imul(ct,yt)|0,d=d+Math.imul(ct,wt)|0,l=l+Math.imul(st,vt)|0,o=o+Math.imul(st,bt)|0,o=o+Math.imul(ot,vt)|0,d=d+Math.imul(ot,bt)|0,l=l+Math.imul(nt,kt)|0,o=o+Math.imul(nt,St)|0,o=o+Math.imul(it,kt)|0,d=d+Math.imul(it,St)|0,l=l+Math.imul(et,Mt)|0,o=o+Math.imul(et,_t)|0,o=o+Math.imul(rt,Mt)|0,d=d+Math.imul(rt,_t)|0,l=l+Math.imul(Q,xt)|0,o=o+Math.imul(Q,It)|0,o=o+Math.imul(tt,xt)|0,d=d+Math.imul(tt,It)|0,l=l+Math.imul(Y,At)|0,o=o+Math.imul(Y,Et)|0,o=o+Math.imul(X,At)|0,d=d+Math.imul(X,Et)|0,l=l+Math.imul(J,Rt)|0,o=o+Math.imul(J,Pt)|0,o=o+Math.imul(Z,Rt)|0,d=d+Math.imul(Z,Pt)|0;var or=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(or>>>26)|0,or&=67108863,l=Math.imul(ut,yt),o=Math.imul(ut,wt),o=o+Math.imul(ht,yt)|0,d=Math.imul(ht,wt),l=l+Math.imul(at,vt)|0,o=o+Math.imul(at,bt)|0,o=o+Math.imul(ct,vt)|0,d=d+Math.imul(ct,bt)|0,l=l+Math.imul(st,kt)|0,o=o+Math.imul(st,St)|0,o=o+Math.imul(ot,kt)|0,d=d+Math.imul(ot,St)|0,l=l+Math.imul(nt,Mt)|0,o=o+Math.imul(nt,_t)|0,o=o+Math.imul(it,Mt)|0,d=d+Math.imul(it,_t)|0,l=l+Math.imul(et,xt)|0,o=o+Math.imul(et,It)|0,o=o+Math.imul(rt,xt)|0,d=d+Math.imul(rt,It)|0,l=l+Math.imul(Q,At)|0,o=o+Math.imul(Q,Et)|0,o=o+Math.imul(tt,At)|0,d=d+Math.imul(tt,Et)|0,l=l+Math.imul(Y,Rt)|0,o=o+Math.imul(Y,Pt)|0,o=o+Math.imul(X,Rt)|0,d=d+Math.imul(X,Pt)|0;var ar=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(ar>>>26)|0,ar&=67108863,l=Math.imul(ut,vt),o=Math.imul(ut,bt),o=o+Math.imul(ht,vt)|0,d=Math.imul(ht,bt),l=l+Math.imul(at,kt)|0,o=o+Math.imul(at,St)|0,o=o+Math.imul(ct,kt)|0,d=d+Math.imul(ct,St)|0,l=l+Math.imul(st,Mt)|0,o=o+Math.imul(st,_t)|0,o=o+Math.imul(ot,Mt)|0,d=d+Math.imul(ot,_t)|0,l=l+Math.imul(nt,xt)|0,o=o+Math.imul(nt,It)|0,o=o+Math.imul(it,xt)|0,d=d+Math.imul(it,It)|0,l=l+Math.imul(et,At)|0,o=o+Math.imul(et,Et)|0,o=o+Math.imul(rt,At)|0,d=d+Math.imul(rt,Et)|0,l=l+Math.imul(Q,Rt)|0,o=o+Math.imul(Q,Pt)|0,o=o+Math.imul(tt,Rt)|0,d=d+Math.imul(tt,Pt)|0;var cr=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(cr>>>26)|0,cr&=67108863,l=Math.imul(ut,kt),o=Math.imul(ut,St),o=o+Math.imul(ht,kt)|0,d=Math.imul(ht,St),l=l+Math.imul(at,Mt)|0,o=o+Math.imul(at,_t)|0,o=o+Math.imul(ct,Mt)|0,d=d+Math.imul(ct,_t)|0,l=l+Math.imul(st,xt)|0,o=o+Math.imul(st,It)|0,o=o+Math.imul(ot,xt)|0,d=d+Math.imul(ot,It)|0,l=l+Math.imul(nt,At)|0,o=o+Math.imul(nt,Et)|0,o=o+Math.imul(it,At)|0,d=d+Math.imul(it,Et)|0,l=l+Math.imul(et,Rt)|0,o=o+Math.imul(et,Pt)|0,o=o+Math.imul(rt,Rt)|0,d=d+Math.imul(rt,Pt)|0;var ur=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(ur>>>26)|0,ur&=67108863,l=Math.imul(ut,Mt),o=Math.imul(ut,_t),o=o+Math.imul(ht,Mt)|0,d=Math.imul(ht,_t),l=l+Math.imul(at,xt)|0,o=o+Math.imul(at,It)|0,o=o+Math.imul(ct,xt)|0,d=d+Math.imul(ct,It)|0,l=l+Math.imul(st,At)|0,o=o+Math.imul(st,Et)|0,o=o+Math.imul(ot,At)|0,d=d+Math.imul(ot,Et)|0,l=l+Math.imul(nt,Rt)|0,o=o+Math.imul(nt,Pt)|0,o=o+Math.imul(it,Rt)|0,d=d+Math.imul(it,Pt)|0;var hr=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(hr>>>26)|0,hr&=67108863,l=Math.imul(ut,xt),o=Math.imul(ut,It),o=o+Math.imul(ht,xt)|0,d=Math.imul(ht,It),l=l+Math.imul(at,At)|0,o=o+Math.imul(at,Et)|0,o=o+Math.imul(ct,At)|0,d=d+Math.imul(ct,Et)|0,l=l+Math.imul(st,Rt)|0,o=o+Math.imul(st,Pt)|0,o=o+Math.imul(ot,Rt)|0,d=d+Math.imul(ot,Pt)|0;var lr=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(lr>>>26)|0,lr&=67108863,l=Math.imul(ut,At),o=Math.imul(ut,Et),o=o+Math.imul(ht,At)|0,d=Math.imul(ht,Et),l=l+Math.imul(at,Rt)|0,o=o+Math.imul(at,Pt)|0,o=o+Math.imul(ct,Rt)|0,d=d+Math.imul(ct,Pt)|0;var fr=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(fr>>>26)|0,fr&=67108863,l=Math.imul(ut,Rt),o=Math.imul(ut,Pt),o=o+Math.imul(ht,Rt)|0,d=Math.imul(ht,Pt);var dr=(v+l|0)+((o&8191)<<13)|0;return v=(d+(o>>>13)|0)+(dr>>>26)|0,dr&=67108863,y[0]=Je,y[1]=Ze,y[2]=Ye,y[3]=Xe,y[4]=Qe,y[5]=tr,y[6]=er,y[7]=rr,y[8]=nr,y[9]=ir,y[10]=sr,y[11]=or,y[12]=ar,y[13]=cr,y[14]=ur,y[15]=hr,y[16]=lr,y[17]=fr,y[18]=dr,v!==0&&(y[19]=v,h.length++),h};Math.imul||(G=U);function qt(g,n,c){c.negative=n.negative^g.negative,c.length=g.length+n.length;for(var h=0,f=0,p=0;p<c.length-1;p++){var y=f;f=0;for(var v=h&67108863,l=Math.min(p,n.length-1),o=Math.max(0,p-g.length+1);o<=l;o++){var d=p-o,P=g.words[d]|0,R=n.words[o]|0,T=P*R,zt=T&67108863;y=y+(T/67108864|0)|0,zt=zt+v|0,v=zt&67108863,y=y+(zt>>>26)|0,f+=y>>>26,y&=67108863}c.words[p]=v,h=y,y=f}return h!==0?c.words[p]=h:c.length--,c._strip()}function Ft(g,n,c){return qt(g,n,c)}i.prototype.mulTo=function(n,c){var h,f=this.length+n.length;return this.length===10&&n.length===10?h=G(this,n,c):f<63?h=U(this,n,c):f<1024?h=qt(this,n,c):h=Ft(this,n,c),h},i.prototype.mul=function(n){var c=new i(null);return c.words=new Array(this.length+n.length),this.mulTo(n,c)},i.prototype.mulf=function(n){var c=new i(null);return c.words=new Array(this.length+n.length),Ft(this,n,c)},i.prototype.imul=function(n){return this.clone().mulTo(n,this)},i.prototype.imuln=function(n){var c=n<0;c&&(n=-n),r(typeof n=="number"),r(n<67108864);for(var h=0,f=0;f<this.length;f++){var p=(this.words[f]|0)*n,y=(p&67108863)+(h&67108863);h>>=26,h+=p/67108864|0,h+=y>>>26,this.words[f]=y&67108863}return h!==0&&(this.words[f]=h,this.length++),c?this.ineg():this},i.prototype.muln=function(n){return this.clone().imuln(n)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(n){var c=N(n);if(c.length===0)return new i(1);for(var h=this,f=0;f<c.length&&c[f]===0;f++,h=h.sqr());if(++f<c.length)for(var p=h.sqr();f<c.length;f++,p=p.sqr())c[f]!==0&&(h=h.mul(p));return h},i.prototype.iushln=function(n){r(typeof n=="number"&&n>=0);var c=n%26,h=(n-c)/26,f=67108863>>>26-c<<26-c,p;if(c!==0){var y=0;for(p=0;p<this.length;p++){var v=this.words[p]&f,l=(this.words[p]|0)-v<<c;this.words[p]=l|y,y=v>>>26-c}y&&(this.words[p]=y,this.length++)}if(h!==0){for(p=this.length-1;p>=0;p--)this.words[p+h]=this.words[p];for(p=0;p<h;p++)this.words[p]=0;this.length+=h}return this._strip()},i.prototype.ishln=function(n){return r(this.negative===0),this.iushln(n)},i.prototype.iushrn=function(n,c,h){r(typeof n=="number"&&n>=0);var f;c?f=(c-c%26)/26:f=0;var p=n%26,y=Math.min((n-p)/26,this.length),v=67108863^67108863>>>p<<p,l=h;if(f-=y,f=Math.max(0,f),l){for(var o=0;o<y;o++)l.words[o]=this.words[o];l.length=y}if(y!==0)if(this.length>y)for(this.length-=y,o=0;o<this.length;o++)this.words[o]=this.words[o+y];else this.words[0]=0,this.length=1;var d=0;for(o=this.length-1;o>=0&&(d!==0||o>=f);o--){var P=this.words[o]|0;this.words[o]=d<<26-p|P>>>p,d=P&v}return l&&d!==0&&(l.words[l.length++]=d),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},i.prototype.ishrn=function(n,c,h){return r(this.negative===0),this.iushrn(n,c,h)},i.prototype.shln=function(n){return this.clone().ishln(n)},i.prototype.ushln=function(n){return this.clone().iushln(n)},i.prototype.shrn=function(n){return this.clone().ishrn(n)},i.prototype.ushrn=function(n){return this.clone().iushrn(n)},i.prototype.testn=function(n){r(typeof n=="number"&&n>=0);var c=n%26,h=(n-c)/26,f=1<<c;if(this.length<=h)return!1;var p=this.words[h];return!!(p&f)},i.prototype.imaskn=function(n){r(typeof n=="number"&&n>=0);var c=n%26,h=(n-c)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=h)return this;if(c!==0&&h++,this.length=Math.min(h,this.length),c!==0){var f=67108863^67108863>>>c<<c;this.words[this.length-1]&=f}return this._strip()},i.prototype.maskn=function(n){return this.clone().imaskn(n)},i.prototype.iaddn=function(n){return r(typeof n=="number"),r(n<67108864),n<0?this.isubn(-n):this.negative!==0?this.length===1&&(this.words[0]|0)<=n?(this.words[0]=n-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(n),this.negative=1,this):this._iaddn(n)},i.prototype._iaddn=function(n){this.words[0]+=n;for(var c=0;c<this.length&&this.words[c]>=67108864;c++)this.words[c]-=67108864,c===this.length-1?this.words[c+1]=1:this.words[c+1]++;return this.length=Math.max(this.length,c+1),this},i.prototype.isubn=function(n){if(r(typeof n=="number"),r(n<67108864),n<0)return this.iaddn(-n);if(this.negative!==0)return this.negative=0,this.iaddn(n),this.negative=1,this;if(this.words[0]-=n,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var c=0;c<this.length&&this.words[c]<0;c++)this.words[c]+=67108864,this.words[c+1]-=1;return this._strip()},i.prototype.addn=function(n){return this.clone().iaddn(n)},i.prototype.subn=function(n){return this.clone().isubn(n)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(n,c,h){var f=n.length+h,p;this._expand(f);var y,v=0;for(p=0;p<n.length;p++){y=(this.words[p+h]|0)+v;var l=(n.words[p]|0)*c;y-=l&67108863,v=(y>>26)-(l/67108864|0),this.words[p+h]=y&67108863}for(;p<this.length-h;p++)y=(this.words[p+h]|0)+v,v=y>>26,this.words[p+h]=y&67108863;if(v===0)return this._strip();for(r(v===-1),v=0,p=0;p<this.length;p++)y=-(this.words[p]|0)+v,v=y>>26,this.words[p]=y&67108863;return this.negative=1,this._strip()},i.prototype._wordDiv=function(n,c){var h=this.length-n.length,f=this.clone(),p=n,y=p.words[p.length-1]|0,v=this._countBits(y);h=26-v,h!==0&&(p=p.ushln(h),f.iushln(h),y=p.words[p.length-1]|0);var l=f.length-p.length,o;if(c!=="mod"){o=new i(null),o.length=l+1,o.words=new Array(o.length);for(var d=0;d<o.length;d++)o.words[d]=0}var P=f.clone()._ishlnsubmul(p,1,l);P.negative===0&&(f=P,o&&(o.words[l]=1));for(var R=l-1;R>=0;R--){var T=(f.words[p.length+R]|0)*67108864+(f.words[p.length+R-1]|0);for(T=Math.min(T/y|0,67108863),f._ishlnsubmul(p,T,R);f.negative!==0;)T--,f.negative=0,f._ishlnsubmul(p,1,R),f.isZero()||(f.negative^=1);o&&(o.words[R]=T)}return o&&o._strip(),f._strip(),c!=="div"&&h!==0&&f.iushrn(h),{div:o||null,mod:f}},i.prototype.divmod=function(n,c,h){if(r(!n.isZero()),this.isZero())return{div:new i(0),mod:new i(0)};var f,p,y;return this.negative!==0&&n.negative===0?(y=this.neg().divmod(n,c),c!=="mod"&&(f=y.div.neg()),c!=="div"&&(p=y.mod.neg(),h&&p.negative!==0&&p.iadd(n)),{div:f,mod:p}):this.negative===0&&n.negative!==0?(y=this.divmod(n.neg(),c),c!=="mod"&&(f=y.div.neg()),{div:f,mod:y.mod}):this.negative&n.negative?(y=this.neg().divmod(n.neg(),c),c!=="div"&&(p=y.mod.neg(),h&&p.negative!==0&&p.isub(n)),{div:y.div,mod:p}):n.length>this.length||this.cmp(n)<0?{div:new i(0),mod:this}:n.length===1?c==="div"?{div:this.divn(n.words[0]),mod:null}:c==="mod"?{div:null,mod:new i(this.modrn(n.words[0]))}:{div:this.divn(n.words[0]),mod:new i(this.modrn(n.words[0]))}:this._wordDiv(n,c)},i.prototype.div=function(n){return this.divmod(n,"div",!1).div},i.prototype.mod=function(n){return this.divmod(n,"mod",!1).mod},i.prototype.umod=function(n){return this.divmod(n,"mod",!0).mod},i.prototype.divRound=function(n){var c=this.divmod(n);if(c.mod.isZero())return c.div;var h=c.div.negative!==0?c.mod.isub(n):c.mod,f=n.ushrn(1),p=n.andln(1),y=h.cmp(f);return y<0||p===1&&y===0?c.div:c.div.negative!==0?c.div.isubn(1):c.div.iaddn(1)},i.prototype.modrn=function(n){var c=n<0;c&&(n=-n),r(n<=67108863);for(var h=(1<<26)%n,f=0,p=this.length-1;p>=0;p--)f=(h*f+(this.words[p]|0))%n;return c?-f:f},i.prototype.modn=function(n){return this.modrn(n)},i.prototype.idivn=function(n){var c=n<0;c&&(n=-n),r(n<=67108863);for(var h=0,f=this.length-1;f>=0;f--){var p=(this.words[f]|0)+h*67108864;this.words[f]=p/n|0,h=p%n}return this._strip(),c?this.ineg():this},i.prototype.divn=function(n){return this.clone().idivn(n)},i.prototype.egcd=function(n){r(n.negative===0),r(!n.isZero());var c=this,h=n.clone();c.negative!==0?c=c.umod(n):c=c.clone();for(var f=new i(1),p=new i(0),y=new i(0),v=new i(1),l=0;c.isEven()&&h.isEven();)c.iushrn(1),h.iushrn(1),++l;for(var o=h.clone(),d=c.clone();!c.isZero();){for(var P=0,R=1;!(c.words[0]&R)&&P<26;++P,R<<=1);if(P>0)for(c.iushrn(P);P-- >0;)(f.isOdd()||p.isOdd())&&(f.iadd(o),p.isub(d)),f.iushrn(1),p.iushrn(1);for(var T=0,zt=1;!(h.words[0]&zt)&&T<26;++T,zt<<=1);if(T>0)for(h.iushrn(T);T-- >0;)(y.isOdd()||v.isOdd())&&(y.iadd(o),v.isub(d)),y.iushrn(1),v.iushrn(1);c.cmp(h)>=0?(c.isub(h),f.isub(y),p.isub(v)):(h.isub(c),y.isub(f),v.isub(p))}return{a:y,b:v,gcd:h.iushln(l)}},i.prototype._invmp=function(n){r(n.negative===0),r(!n.isZero());var c=this,h=n.clone();c.negative!==0?c=c.umod(n):c=c.clone();for(var f=new i(1),p=new i(0),y=h.clone();c.cmpn(1)>0&&h.cmpn(1)>0;){for(var v=0,l=1;!(c.words[0]&l)&&v<26;++v,l<<=1);if(v>0)for(c.iushrn(v);v-- >0;)f.isOdd()&&f.iadd(y),f.iushrn(1);for(var o=0,d=1;!(h.words[0]&d)&&o<26;++o,d<<=1);if(o>0)for(h.iushrn(o);o-- >0;)p.isOdd()&&p.iadd(y),p.iushrn(1);c.cmp(h)>=0?(c.isub(h),f.isub(p)):(h.isub(c),p.isub(f))}var P;return c.cmpn(1)===0?P=f:P=p,P.cmpn(0)<0&&P.iadd(n),P},i.prototype.gcd=function(n){if(this.isZero())return n.abs();if(n.isZero())return this.abs();var c=this.clone(),h=n.clone();c.negative=0,h.negative=0;for(var f=0;c.isEven()&&h.isEven();f++)c.iushrn(1),h.iushrn(1);do{for(;c.isEven();)c.iushrn(1);for(;h.isEven();)h.iushrn(1);var p=c.cmp(h);if(p<0){var y=c;c=h,h=y}else if(p===0||h.cmpn(1)===0)break;c.isub(h)}while(!0);return h.iushln(f)},i.prototype.invm=function(n){return this.egcd(n).a.umod(n)},i.prototype.isEven=function(){return(this.words[0]&1)===0},i.prototype.isOdd=function(){return(this.words[0]&1)===1},i.prototype.andln=function(n){return this.words[0]&n},i.prototype.bincn=function(n){r(typeof n=="number");var c=n%26,h=(n-c)/26,f=1<<c;if(this.length<=h)return this._expand(h+1),this.words[h]|=f,this;for(var p=f,y=h;p!==0&&y<this.length;y++){var v=this.words[y]|0;v+=p,p=v>>>26,v&=67108863,this.words[y]=v}return p!==0&&(this.words[y]=p,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(n){var c=n<0;if(this.negative!==0&&!c)return-1;if(this.negative===0&&c)return 1;this._strip();var h;if(this.length>1)h=1;else{c&&(n=-n),r(n<=67108863,"Number is too big");var f=this.words[0]|0;h=f===n?0:f<n?-1:1}return this.negative!==0?-h|0:h},i.prototype.cmp=function(n){if(this.negative!==0&&n.negative===0)return-1;if(this.negative===0&&n.negative!==0)return 1;var c=this.ucmp(n);return this.negative!==0?-c|0:c},i.prototype.ucmp=function(n){if(this.length>n.length)return 1;if(this.length<n.length)return-1;for(var c=0,h=this.length-1;h>=0;h--){var f=this.words[h]|0,p=n.words[h]|0;if(f!==p){f<p?c=-1:f>p&&(c=1);break}}return c},i.prototype.gtn=function(n){return this.cmpn(n)===1},i.prototype.gt=function(n){return this.cmp(n)===1},i.prototype.gten=function(n){return this.cmpn(n)>=0},i.prototype.gte=function(n){return this.cmp(n)>=0},i.prototype.ltn=function(n){return this.cmpn(n)===-1},i.prototype.lt=function(n){return this.cmp(n)===-1},i.prototype.lten=function(n){return this.cmpn(n)<=0},i.prototype.lte=function(n){return this.cmp(n)<=0},i.prototype.eqn=function(n){return this.cmpn(n)===0},i.prototype.eq=function(n){return this.cmp(n)===0},i.red=function(n){return new j(n)},i.prototype.toRed=function(n){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),n.convertTo(this)._forceRed(n)},i.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(n){return this.red=n,this},i.prototype.forceRed=function(n){return r(!this.red,"Already a number in reduction context"),this._forceRed(n)},i.prototype.redAdd=function(n){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,n)},i.prototype.redIAdd=function(n){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,n)},i.prototype.redSub=function(n){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,n)},i.prototype.redISub=function(n){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,n)},i.prototype.redShl=function(n){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,n)},i.prototype.redMul=function(n){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,n),this.red.mul(this,n)},i.prototype.redIMul=function(n){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,n),this.red.imul(this,n)},i.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(n){return r(this.red&&!n.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,n)};var Qt={k256:null,p224:null,p192:null,p25519:null};function Lt(g,n){this.name=g,this.p=new i(n,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}Lt.prototype._tmp=function(){var n=new i(null);return n.words=new Array(Math.ceil(this.n/13)),n},Lt.prototype.ireduce=function(n){var c=n,h;do this.split(c,this.tmp),c=this.imulK(c),c=c.iadd(this.tmp),h=c.bitLength();while(h>this.n);var f=h<this.n?-1:c.ucmp(this.p);return f===0?(c.words[0]=0,c.length=1):f>0?c.isub(this.p):c.strip!==void 0?c.strip():c._strip(),c},Lt.prototype.split=function(n,c){n.iushrn(this.n,0,c)},Lt.prototype.imulK=function(n){return n.imul(this.k)};function te(){Lt.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}s(te,Lt),te.prototype.split=function(n,c){for(var h=4194303,f=Math.min(n.length,9),p=0;p<f;p++)c.words[p]=n.words[p];if(c.length=f,n.length<=9){n.words[0]=0,n.length=1;return}var y=n.words[9];for(c.words[c.length++]=y&h,p=10;p<n.length;p++){var v=n.words[p]|0;n.words[p-10]=(v&h)<<4|y>>>22,y=v}y>>>=22,n.words[p-10]=y,y===0&&n.length>10?n.length-=10:n.length-=9},te.prototype.imulK=function(n){n.words[n.length]=0,n.words[n.length+1]=0,n.length+=2;for(var c=0,h=0;h<n.length;h++){var f=n.words[h]|0;c+=f*977,n.words[h]=c&67108863,c=f*64+(c/67108864|0)}return n.words[n.length-1]===0&&(n.length--,n.words[n.length-1]===0&&n.length--),n};function Ee(){Lt.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}s(Ee,Lt);function Fr(){Lt.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}s(Fr,Lt);function je(){Lt.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}s(je,Lt),je.prototype.imulK=function(n){for(var c=0,h=0;h<n.length;h++){var f=(n.words[h]|0)*19+c,p=f&67108863;f>>>=26,n.words[h]=p,c=f}return c!==0&&(n.words[n.length++]=c),n},i._prime=function(n){if(Qt[n])return Qt[n];var c;if(n==="k256")c=new te;else if(n==="p224")c=new Ee;else if(n==="p192")c=new Fr;else if(n==="p25519")c=new je;else throw new Error("Unknown prime "+n);return Qt[n]=c,c};function j(g){if(typeof g=="string"){var n=i._prime(g);this.m=n.p,this.prime=n}else r(g.gtn(1),"modulus must be greater than 1"),this.m=g,this.prime=null}j.prototype._verify1=function(n){r(n.negative===0,"red works only with positives"),r(n.red,"red works only with red numbers")},j.prototype._verify2=function(n,c){r((n.negative|c.negative)===0,"red works only with positives"),r(n.red&&n.red===c.red,"red works only with red numbers")},j.prototype.imod=function(n){return this.prime?this.prime.ireduce(n)._forceRed(this):(M(n,n.umod(this.m)._forceRed(this)),n)},j.prototype.neg=function(n){return n.isZero()?n.clone():this.m.sub(n)._forceRed(this)},j.prototype.add=function(n,c){this._verify2(n,c);var h=n.add(c);return h.cmp(this.m)>=0&&h.isub(this.m),h._forceRed(this)},j.prototype.iadd=function(n,c){this._verify2(n,c);var h=n.iadd(c);return h.cmp(this.m)>=0&&h.isub(this.m),h},j.prototype.sub=function(n,c){this._verify2(n,c);var h=n.sub(c);return h.cmpn(0)<0&&h.iadd(this.m),h._forceRed(this)},j.prototype.isub=function(n,c){this._verify2(n,c);var h=n.isub(c);return h.cmpn(0)<0&&h.iadd(this.m),h},j.prototype.shl=function(n,c){return this._verify1(n),this.imod(n.ushln(c))},j.prototype.imul=function(n,c){return this._verify2(n,c),this.imod(n.imul(c))},j.prototype.mul=function(n,c){return this._verify2(n,c),this.imod(n.mul(c))},j.prototype.isqr=function(n){return this.imul(n,n.clone())},j.prototype.sqr=function(n){return this.mul(n,n)},j.prototype.sqrt=function(n){if(n.isZero())return n.clone();var c=this.m.andln(3);if(r(c%2===1),c===3){var h=this.m.add(new i(1)).iushrn(2);return this.pow(n,h)}for(var f=this.m.subn(1),p=0;!f.isZero()&&f.andln(1)===0;)p++,f.iushrn(1);r(!f.isZero());var y=new i(1).toRed(this),v=y.redNeg(),l=this.m.subn(1).iushrn(1),o=this.m.bitLength();for(o=new i(2*o*o).toRed(this);this.pow(o,l).cmp(v)!==0;)o.redIAdd(v);for(var d=this.pow(o,f),P=this.pow(n,f.addn(1).iushrn(1)),R=this.pow(n,f),T=p;R.cmp(y)!==0;){for(var zt=R,V=0;zt.cmp(y)!==0;V++)zt=zt.redSqr();r(V<T);var H=this.pow(d,new i(1).iushln(T-V-1));P=P.redMul(H),d=H.redSqr(),R=R.redMul(d),T=V}return P},j.prototype.invm=function(n){var c=n._invmp(this.m);return c.negative!==0?(c.negative=0,this.imod(c).redNeg()):this.imod(c)},j.prototype.pow=function(n,c){if(c.isZero())return new i(1).toRed(this);if(c.cmpn(1)===0)return n.clone();var h=4,f=new Array(1<<h);f[0]=new i(1).toRed(this),f[1]=n;for(var p=2;p<f.length;p++)f[p]=this.mul(f[p-1],n);var y=f[0],v=0,l=0,o=c.bitLength()%26;for(o===0&&(o=26),p=c.length-1;p>=0;p--){for(var d=c.words[p],P=o-1;P>=0;P--){var R=d>>P&1;if(y!==f[0]&&(y=this.sqr(y)),R===0&&v===0){l=0;continue}v<<=1,v|=R,l++,!(l!==h&&(p!==0||P!==0))&&(y=this.mul(y,f[v]),l=0,v=0)}o=26}return y},j.prototype.convertTo=function(n){var c=n.umod(this.m);return c===n?c.clone():c},j.prototype.convertFrom=function(n){var c=n.clone();return c.red=null,c},i.mont=function(n){return new pe(n)};function pe(g){j.call(this,g),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}s(pe,j),pe.prototype.convertTo=function(n){return this.imod(n.ushln(this.shift))},pe.prototype.convertFrom=function(n){var c=this.imod(n.mul(this.rinv));return c.red=null,c},pe.prototype.imul=function(n,c){if(n.isZero()||c.isZero())return n.words[0]=0,n.length=1,n;var h=n.imul(c),f=h.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),p=h.isub(f).iushrn(this.shift),y=p;return p.cmp(this.m)>=0?y=p.isub(this.m):p.cmpn(0)<0&&(y=p.iadd(this.m)),y._forceRed(this)},pe.prototype.mul=function(n,c){if(n.isZero()||c.isZero())return new i(0)._forceRed(this);var h=n.mul(c),f=h.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),p=h.isub(f).iushrn(this.shift),y=p;return p.cmp(this.m)>=0?y=p.isub(this.m):p.cmpn(0)<0&&(y=p.iadd(this.m)),y._forceRed(this)},pe.prototype.invm=function(n){var c=this.imod(n._invmp(this.m).mul(this.r2));return c._forceRed(this)}})(a,de)})(vi);var zo=vi.exports;const Zi=ws(zo);var oe={},bi={exports:{}};bi.exports;(function(a){(function(t,e){function r(g,n){if(!g)throw new Error(n||"Assertion failed")}function s(g,n){g.super_=n;var c=function(){};c.prototype=n.prototype,g.prototype=new c,g.prototype.constructor=g}function i(g,n,c){if(i.isBN(g))return g;this.negative=0,this.words=null,this.length=0,this.red=null,g!==null&&((n==="le"||n==="be")&&(c=n,n=10),this._init(g||0,n||10,c||"be"))}typeof t=="object"?t.exports=i:e.BN=i,i.BN=i,i.wordSize=26;var u;try{typeof window<"u"&&typeof window.Buffer<"u"?u=window.Buffer:u=mi.Buffer}catch{}i.isBN=function(n){return n instanceof i?!0:n!==null&&typeof n=="object"&&n.constructor.wordSize===i.wordSize&&Array.isArray(n.words)},i.max=function(n,c){return n.cmp(c)>0?n:c},i.min=function(n,c){return n.cmp(c)<0?n:c},i.prototype._init=function(n,c,h){if(typeof n=="number")return this._initNumber(n,c,h);if(typeof n=="object")return this._initArray(n,c,h);c==="hex"&&(c=16),r(c===(c|0)&&c>=2&&c<=36),n=n.toString().replace(/\s+/g,"");var f=0;n[0]==="-"&&(f++,this.negative=1),f<n.length&&(c===16?this._parseHex(n,f,h):(this._parseBase(n,c,f),h==="le"&&this._initArray(this.toArray(),c,h)))},i.prototype._initNumber=function(n,c,h){n<0&&(this.negative=1,n=-n),n<67108864?(this.words=[n&67108863],this.length=1):n<4503599627370496?(this.words=[n&67108863,n/67108864&67108863],this.length=2):(r(n<9007199254740992),this.words=[n&67108863,n/67108864&67108863,1],this.length=3),h==="le"&&this._initArray(this.toArray(),c,h)},i.prototype._initArray=function(n,c,h){if(r(typeof n.length=="number"),n.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(n.length/3),this.words=new Array(this.length);for(var f=0;f<this.length;f++)this.words[f]=0;var p,y,v=0;if(h==="be")for(f=n.length-1,p=0;f>=0;f-=3)y=n[f]|n[f-1]<<8|n[f-2]<<16,this.words[p]|=y<<v&67108863,this.words[p+1]=y>>>26-v&67108863,v+=24,v>=26&&(v-=26,p++);else if(h==="le")for(f=0,p=0;f<n.length;f+=3)y=n[f]|n[f+1]<<8|n[f+2]<<16,this.words[p]|=y<<v&67108863,this.words[p+1]=y>>>26-v&67108863,v+=24,v>=26&&(v-=26,p++);return this._strip()};function m(g,n){var c=g.charCodeAt(n);if(c>=48&&c<=57)return c-48;if(c>=65&&c<=70)return c-55;if(c>=97&&c<=102)return c-87;r(!1,"Invalid character in "+g)}function w(g,n,c){var h=m(g,c);return c-1>=n&&(h|=m(g,c-1)<<4),h}i.prototype._parseHex=function(n,c,h){this.length=Math.ceil((n.length-c)/6),this.words=new Array(this.length);for(var f=0;f<this.length;f++)this.words[f]=0;var p=0,y=0,v;if(h==="be")for(f=n.length-1;f>=c;f-=2)v=w(n,c,f)<<p,this.words[y]|=v&67108863,p>=18?(p-=18,y+=1,this.words[y]|=v>>>26):p+=8;else{var l=n.length-c;for(f=l%2===0?c+1:c;f<n.length;f+=2)v=w(n,c,f)<<p,this.words[y]|=v&67108863,p>=18?(p-=18,y+=1,this.words[y]|=v>>>26):p+=8}this._strip()};function b(g,n,c,h){for(var f=0,p=0,y=Math.min(g.length,c),v=n;v<y;v++){var l=g.charCodeAt(v)-48;f*=h,l>=49?p=l-49+10:l>=17?p=l-17+10:p=l,r(l>=0&&p<h,"Invalid character"),f+=p}return f}i.prototype._parseBase=function(n,c,h){this.words=[0],this.length=1;for(var f=0,p=1;p<=67108863;p*=c)f++;f--,p=p/c|0;for(var y=n.length-h,v=y%f,l=Math.min(y,y-v)+h,o=0,d=h;d<l;d+=f)o=b(n,d,d+f,c),this.imuln(p),this.words[0]+o<67108864?this.words[0]+=o:this._iaddn(o);if(v!==0){var P=1;for(o=b(n,d,n.length,c),d=0;d<v;d++)P*=c;this.imuln(P),this.words[0]+o<67108864?this.words[0]+=o:this._iaddn(o)}this._strip()},i.prototype.copy=function(n){n.words=new Array(this.length);for(var c=0;c<this.length;c++)n.words[c]=this.words[c];n.length=this.length,n.negative=this.negative,n.red=this.red};function M(g,n){g.words=n.words,g.length=n.length,g.negative=n.negative,g.red=n.red}if(i.prototype._move=function(n){M(n,this)},i.prototype.clone=function(){var n=new i(null);return this.copy(n),n},i.prototype._expand=function(n){for(;this.length<n;)this.words[this.length++]=0;return this},i.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{i.prototype[Symbol.for("nodejs.util.inspect.custom")]=x}catch{i.prototype.inspect=x}else i.prototype.inspect=x;function x(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var L=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],_=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],E=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(n,c){n=n||10,c=c|0||1;var h;if(n===16||n==="hex"){h="";for(var f=0,p=0,y=0;y<this.length;y++){var v=this.words[y],l=((v<<f|p)&16777215).toString(16);p=v>>>24-f&16777215,f+=2,f>=26&&(f-=26,y--),p!==0||y!==this.length-1?h=L[6-l.length]+l+h:h=l+h}for(p!==0&&(h=p.toString(16)+h);h.length%c!==0;)h="0"+h;return this.negative!==0&&(h="-"+h),h}if(n===(n|0)&&n>=2&&n<=36){var o=_[n],d=E[n];h="";var P=this.clone();for(P.negative=0;!P.isZero();){var R=P.modrn(d).toString(n);P=P.idivn(d),P.isZero()?h=R+h:h=L[o-R.length]+R+h}for(this.isZero()&&(h="0"+h);h.length%c!==0;)h="0"+h;return this.negative!==0&&(h="-"+h),h}r(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var n=this.words[0];return this.length===2?n+=this.words[1]*67108864:this.length===3&&this.words[2]===1?n+=4503599627370496+this.words[1]*67108864:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-n:n},i.prototype.toJSON=function(){return this.toString(16,2)},u&&(i.prototype.toBuffer=function(n,c){return this.toArrayLike(u,n,c)}),i.prototype.toArray=function(n,c){return this.toArrayLike(Array,n,c)};var A=function(n,c){return n.allocUnsafe?n.allocUnsafe(c):new n(c)};i.prototype.toArrayLike=function(n,c,h){this._strip();var f=this.byteLength(),p=h||Math.max(1,f);r(f<=p,"byte array longer than desired length"),r(p>0,"Requested array length <= 0");var y=A(n,p),v=c==="le"?"LE":"BE";return this["_toArrayLike"+v](y,f),y},i.prototype._toArrayLikeLE=function(n,c){for(var h=0,f=0,p=0,y=0;p<this.length;p++){var v=this.words[p]<<y|f;n[h++]=v&255,h<n.length&&(n[h++]=v>>8&255),h<n.length&&(n[h++]=v>>16&255),y===6?(h<n.length&&(n[h++]=v>>24&255),f=0,y=0):(f=v>>>24,y+=2)}if(h<n.length)for(n[h++]=f;h<n.length;)n[h++]=0},i.prototype._toArrayLikeBE=function(n,c){for(var h=n.length-1,f=0,p=0,y=0;p<this.length;p++){var v=this.words[p]<<y|f;n[h--]=v&255,h>=0&&(n[h--]=v>>8&255),h>=0&&(n[h--]=v>>16&255),y===6?(h>=0&&(n[h--]=v>>24&255),f=0,y=0):(f=v>>>24,y+=2)}if(h>=0)for(n[h--]=f;h>=0;)n[h--]=0},Math.clz32?i.prototype._countBits=function(n){return 32-Math.clz32(n)}:i.prototype._countBits=function(n){var c=n,h=0;return c>=4096&&(h+=13,c>>>=13),c>=64&&(h+=7,c>>>=7),c>=8&&(h+=4,c>>>=4),c>=2&&(h+=2,c>>>=2),h+c},i.prototype._zeroBits=function(n){if(n===0)return 26;var c=n,h=0;return c&8191||(h+=13,c>>>=13),c&127||(h+=7,c>>>=7),c&15||(h+=4,c>>>=4),c&3||(h+=2,c>>>=2),c&1||h++,h},i.prototype.bitLength=function(){var n=this.words[this.length-1],c=this._countBits(n);return(this.length-1)*26+c};function N(g){for(var n=new Array(g.bitLength()),c=0;c<n.length;c++){var h=c/26|0,f=c%26;n[c]=g.words[h]>>>f&1}return n}i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var n=0,c=0;c<this.length;c++){var h=this._zeroBits(this.words[c]);if(n+=h,h!==26)break}return n},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(n){return this.negative!==0?this.abs().inotn(n).iaddn(1):this.clone()},i.prototype.fromTwos=function(n){return this.testn(n-1)?this.notn(n).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(n){for(;this.length<n.length;)this.words[this.length++]=0;for(var c=0;c<n.length;c++)this.words[c]=this.words[c]|n.words[c];return this._strip()},i.prototype.ior=function(n){return r((this.negative|n.negative)===0),this.iuor(n)},i.prototype.or=function(n){return this.length>n.length?this.clone().ior(n):n.clone().ior(this)},i.prototype.uor=function(n){return this.length>n.length?this.clone().iuor(n):n.clone().iuor(this)},i.prototype.iuand=function(n){var c;this.length>n.length?c=n:c=this;for(var h=0;h<c.length;h++)this.words[h]=this.words[h]&n.words[h];return this.length=c.length,this._strip()},i.prototype.iand=function(n){return r((this.negative|n.negative)===0),this.iuand(n)},i.prototype.and=function(n){return this.length>n.length?this.clone().iand(n):n.clone().iand(this)},i.prototype.uand=function(n){return this.length>n.length?this.clone().iuand(n):n.clone().iuand(this)},i.prototype.iuxor=function(n){var c,h;this.length>n.length?(c=this,h=n):(c=n,h=this);for(var f=0;f<h.length;f++)this.words[f]=c.words[f]^h.words[f];if(this!==c)for(;f<c.length;f++)this.words[f]=c.words[f];return this.length=c.length,this._strip()},i.prototype.ixor=function(n){return r((this.negative|n.negative)===0),this.iuxor(n)},i.prototype.xor=function(n){return this.length>n.length?this.clone().ixor(n):n.clone().ixor(this)},i.prototype.uxor=function(n){return this.length>n.length?this.clone().iuxor(n):n.clone().iuxor(this)},i.prototype.inotn=function(n){r(typeof n=="number"&&n>=0);var c=Math.ceil(n/26)|0,h=n%26;this._expand(c),h>0&&c--;for(var f=0;f<c;f++)this.words[f]=~this.words[f]&67108863;return h>0&&(this.words[f]=~this.words[f]&67108863>>26-h),this._strip()},i.prototype.notn=function(n){return this.clone().inotn(n)},i.prototype.setn=function(n,c){r(typeof n=="number"&&n>=0);var h=n/26|0,f=n%26;return this._expand(h+1),c?this.words[h]=this.words[h]|1<<f:this.words[h]=this.words[h]&~(1<<f),this._strip()},i.prototype.iadd=function(n){var c;if(this.negative!==0&&n.negative===0)return this.negative=0,c=this.isub(n),this.negative^=1,this._normSign();if(this.negative===0&&n.negative!==0)return n.negative=0,c=this.isub(n),n.negative=1,c._normSign();var h,f;this.length>n.length?(h=this,f=n):(h=n,f=this);for(var p=0,y=0;y<f.length;y++)c=(h.words[y]|0)+(f.words[y]|0)+p,this.words[y]=c&67108863,p=c>>>26;for(;p!==0&&y<h.length;y++)c=(h.words[y]|0)+p,this.words[y]=c&67108863,p=c>>>26;if(this.length=h.length,p!==0)this.words[this.length]=p,this.length++;else if(h!==this)for(;y<h.length;y++)this.words[y]=h.words[y];return this},i.prototype.add=function(n){var c;return n.negative!==0&&this.negative===0?(n.negative=0,c=this.sub(n),n.negative^=1,c):n.negative===0&&this.negative!==0?(this.negative=0,c=n.sub(this),this.negative=1,c):this.length>n.length?this.clone().iadd(n):n.clone().iadd(this)},i.prototype.isub=function(n){if(n.negative!==0){n.negative=0;var c=this.iadd(n);return n.negative=1,c._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(n),this.negative=1,this._normSign();var h=this.cmp(n);if(h===0)return this.negative=0,this.length=1,this.words[0]=0,this;var f,p;h>0?(f=this,p=n):(f=n,p=this);for(var y=0,v=0;v<p.length;v++)c=(f.words[v]|0)-(p.words[v]|0)+y,y=c>>26,this.words[v]=c&67108863;for(;y!==0&&v<f.length;v++)c=(f.words[v]|0)+y,y=c>>26,this.words[v]=c&67108863;if(y===0&&v<f.length&&f!==this)for(;v<f.length;v++)this.words[v]=f.words[v];return this.length=Math.max(this.length,v),f!==this&&(this.negative=1),this._strip()},i.prototype.sub=function(n){return this.clone().isub(n)};function U(g,n,c){c.negative=n.negative^g.negative;var h=g.length+n.length|0;c.length=h,h=h-1|0;var f=g.words[0]|0,p=n.words[0]|0,y=f*p,v=y&67108863,l=y/67108864|0;c.words[0]=v;for(var o=1;o<h;o++){for(var d=l>>>26,P=l&67108863,R=Math.min(o,n.length-1),T=Math.max(0,o-g.length+1);T<=R;T++){var zt=o-T|0;f=g.words[zt]|0,p=n.words[T]|0,y=f*p+P,d+=y/67108864|0,P=y&67108863}c.words[o]=P|0,l=d|0}return l!==0?c.words[o]=l|0:c.length--,c._strip()}var G=function(n,c,h){var f=n.words,p=c.words,y=h.words,v=0,l,o,d,P=f[0]|0,R=P&8191,T=P>>>13,zt=f[1]|0,V=zt&8191,H=zt>>>13,Dr=f[2]|0,J=Dr&8191,Z=Dr>>>13,Vr=f[3]|0,Y=Vr&8191,X=Vr>>>13,$r=f[4]|0,Q=$r&8191,tt=$r>>>13,Hr=f[5]|0,et=Hr&8191,rt=Hr>>>13,Gr=f[6]|0,nt=Gr&8191,it=Gr>>>13,jr=f[7]|0,st=jr&8191,ot=jr>>>13,Jr=f[8]|0,at=Jr&8191,ct=Jr>>>13,Zr=f[9]|0,ut=Zr&8191,ht=Zr>>>13,Yr=p[0]|0,lt=Yr&8191,ft=Yr>>>13,Xr=p[1]|0,dt=Xr&8191,pt=Xr>>>13,Qr=p[2]|0,gt=Qr&8191,mt=Qr>>>13,tn=p[3]|0,yt=tn&8191,wt=tn>>>13,en=p[4]|0,vt=en&8191,bt=en>>>13,rn=p[5]|0,kt=rn&8191,St=rn>>>13,nn=p[6]|0,Mt=nn&8191,_t=nn>>>13,sn=p[7]|0,xt=sn&8191,It=sn>>>13,on=p[8]|0,At=on&8191,Et=on>>>13,an=p[9]|0,Rt=an&8191,Pt=an>>>13;h.negative=n.negative^c.negative,h.length=19,l=Math.imul(R,lt),o=Math.imul(R,ft),o=o+Math.imul(T,lt)|0,d=Math.imul(T,ft);var Je=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(Je>>>26)|0,Je&=67108863,l=Math.imul(V,lt),o=Math.imul(V,ft),o=o+Math.imul(H,lt)|0,d=Math.imul(H,ft),l=l+Math.imul(R,dt)|0,o=o+Math.imul(R,pt)|0,o=o+Math.imul(T,dt)|0,d=d+Math.imul(T,pt)|0;var Ze=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(Ze>>>26)|0,Ze&=67108863,l=Math.imul(J,lt),o=Math.imul(J,ft),o=o+Math.imul(Z,lt)|0,d=Math.imul(Z,ft),l=l+Math.imul(V,dt)|0,o=o+Math.imul(V,pt)|0,o=o+Math.imul(H,dt)|0,d=d+Math.imul(H,pt)|0,l=l+Math.imul(R,gt)|0,o=o+Math.imul(R,mt)|0,o=o+Math.imul(T,gt)|0,d=d+Math.imul(T,mt)|0;var Ye=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(Ye>>>26)|0,Ye&=67108863,l=Math.imul(Y,lt),o=Math.imul(Y,ft),o=o+Math.imul(X,lt)|0,d=Math.imul(X,ft),l=l+Math.imul(J,dt)|0,o=o+Math.imul(J,pt)|0,o=o+Math.imul(Z,dt)|0,d=d+Math.imul(Z,pt)|0,l=l+Math.imul(V,gt)|0,o=o+Math.imul(V,mt)|0,o=o+Math.imul(H,gt)|0,d=d+Math.imul(H,mt)|0,l=l+Math.imul(R,yt)|0,o=o+Math.imul(R,wt)|0,o=o+Math.imul(T,yt)|0,d=d+Math.imul(T,wt)|0;var Xe=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,l=Math.imul(Q,lt),o=Math.imul(Q,ft),o=o+Math.imul(tt,lt)|0,d=Math.imul(tt,ft),l=l+Math.imul(Y,dt)|0,o=o+Math.imul(Y,pt)|0,o=o+Math.imul(X,dt)|0,d=d+Math.imul(X,pt)|0,l=l+Math.imul(J,gt)|0,o=o+Math.imul(J,mt)|0,o=o+Math.imul(Z,gt)|0,d=d+Math.imul(Z,mt)|0,l=l+Math.imul(V,yt)|0,o=o+Math.imul(V,wt)|0,o=o+Math.imul(H,yt)|0,d=d+Math.imul(H,wt)|0,l=l+Math.imul(R,vt)|0,o=o+Math.imul(R,bt)|0,o=o+Math.imul(T,vt)|0,d=d+Math.imul(T,bt)|0;var Qe=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(Qe>>>26)|0,Qe&=67108863,l=Math.imul(et,lt),o=Math.imul(et,ft),o=o+Math.imul(rt,lt)|0,d=Math.imul(rt,ft),l=l+Math.imul(Q,dt)|0,o=o+Math.imul(Q,pt)|0,o=o+Math.imul(tt,dt)|0,d=d+Math.imul(tt,pt)|0,l=l+Math.imul(Y,gt)|0,o=o+Math.imul(Y,mt)|0,o=o+Math.imul(X,gt)|0,d=d+Math.imul(X,mt)|0,l=l+Math.imul(J,yt)|0,o=o+Math.imul(J,wt)|0,o=o+Math.imul(Z,yt)|0,d=d+Math.imul(Z,wt)|0,l=l+Math.imul(V,vt)|0,o=o+Math.imul(V,bt)|0,o=o+Math.imul(H,vt)|0,d=d+Math.imul(H,bt)|0,l=l+Math.imul(R,kt)|0,o=o+Math.imul(R,St)|0,o=o+Math.imul(T,kt)|0,d=d+Math.imul(T,St)|0;var tr=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(tr>>>26)|0,tr&=67108863,l=Math.imul(nt,lt),o=Math.imul(nt,ft),o=o+Math.imul(it,lt)|0,d=Math.imul(it,ft),l=l+Math.imul(et,dt)|0,o=o+Math.imul(et,pt)|0,o=o+Math.imul(rt,dt)|0,d=d+Math.imul(rt,pt)|0,l=l+Math.imul(Q,gt)|0,o=o+Math.imul(Q,mt)|0,o=o+Math.imul(tt,gt)|0,d=d+Math.imul(tt,mt)|0,l=l+Math.imul(Y,yt)|0,o=o+Math.imul(Y,wt)|0,o=o+Math.imul(X,yt)|0,d=d+Math.imul(X,wt)|0,l=l+Math.imul(J,vt)|0,o=o+Math.imul(J,bt)|0,o=o+Math.imul(Z,vt)|0,d=d+Math.imul(Z,bt)|0,l=l+Math.imul(V,kt)|0,o=o+Math.imul(V,St)|0,o=o+Math.imul(H,kt)|0,d=d+Math.imul(H,St)|0,l=l+Math.imul(R,Mt)|0,o=o+Math.imul(R,_t)|0,o=o+Math.imul(T,Mt)|0,d=d+Math.imul(T,_t)|0;var er=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(er>>>26)|0,er&=67108863,l=Math.imul(st,lt),o=Math.imul(st,ft),o=o+Math.imul(ot,lt)|0,d=Math.imul(ot,ft),l=l+Math.imul(nt,dt)|0,o=o+Math.imul(nt,pt)|0,o=o+Math.imul(it,dt)|0,d=d+Math.imul(it,pt)|0,l=l+Math.imul(et,gt)|0,o=o+Math.imul(et,mt)|0,o=o+Math.imul(rt,gt)|0,d=d+Math.imul(rt,mt)|0,l=l+Math.imul(Q,yt)|0,o=o+Math.imul(Q,wt)|0,o=o+Math.imul(tt,yt)|0,d=d+Math.imul(tt,wt)|0,l=l+Math.imul(Y,vt)|0,o=o+Math.imul(Y,bt)|0,o=o+Math.imul(X,vt)|0,d=d+Math.imul(X,bt)|0,l=l+Math.imul(J,kt)|0,o=o+Math.imul(J,St)|0,o=o+Math.imul(Z,kt)|0,d=d+Math.imul(Z,St)|0,l=l+Math.imul(V,Mt)|0,o=o+Math.imul(V,_t)|0,o=o+Math.imul(H,Mt)|0,d=d+Math.imul(H,_t)|0,l=l+Math.imul(R,xt)|0,o=o+Math.imul(R,It)|0,o=o+Math.imul(T,xt)|0,d=d+Math.imul(T,It)|0;var rr=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(rr>>>26)|0,rr&=67108863,l=Math.imul(at,lt),o=Math.imul(at,ft),o=o+Math.imul(ct,lt)|0,d=Math.imul(ct,ft),l=l+Math.imul(st,dt)|0,o=o+Math.imul(st,pt)|0,o=o+Math.imul(ot,dt)|0,d=d+Math.imul(ot,pt)|0,l=l+Math.imul(nt,gt)|0,o=o+Math.imul(nt,mt)|0,o=o+Math.imul(it,gt)|0,d=d+Math.imul(it,mt)|0,l=l+Math.imul(et,yt)|0,o=o+Math.imul(et,wt)|0,o=o+Math.imul(rt,yt)|0,d=d+Math.imul(rt,wt)|0,l=l+Math.imul(Q,vt)|0,o=o+Math.imul(Q,bt)|0,o=o+Math.imul(tt,vt)|0,d=d+Math.imul(tt,bt)|0,l=l+Math.imul(Y,kt)|0,o=o+Math.imul(Y,St)|0,o=o+Math.imul(X,kt)|0,d=d+Math.imul(X,St)|0,l=l+Math.imul(J,Mt)|0,o=o+Math.imul(J,_t)|0,o=o+Math.imul(Z,Mt)|0,d=d+Math.imul(Z,_t)|0,l=l+Math.imul(V,xt)|0,o=o+Math.imul(V,It)|0,o=o+Math.imul(H,xt)|0,d=d+Math.imul(H,It)|0,l=l+Math.imul(R,At)|0,o=o+Math.imul(R,Et)|0,o=o+Math.imul(T,At)|0,d=d+Math.imul(T,Et)|0;var nr=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(nr>>>26)|0,nr&=67108863,l=Math.imul(ut,lt),o=Math.imul(ut,ft),o=o+Math.imul(ht,lt)|0,d=Math.imul(ht,ft),l=l+Math.imul(at,dt)|0,o=o+Math.imul(at,pt)|0,o=o+Math.imul(ct,dt)|0,d=d+Math.imul(ct,pt)|0,l=l+Math.imul(st,gt)|0,o=o+Math.imul(st,mt)|0,o=o+Math.imul(ot,gt)|0,d=d+Math.imul(ot,mt)|0,l=l+Math.imul(nt,yt)|0,o=o+Math.imul(nt,wt)|0,o=o+Math.imul(it,yt)|0,d=d+Math.imul(it,wt)|0,l=l+Math.imul(et,vt)|0,o=o+Math.imul(et,bt)|0,o=o+Math.imul(rt,vt)|0,d=d+Math.imul(rt,bt)|0,l=l+Math.imul(Q,kt)|0,o=o+Math.imul(Q,St)|0,o=o+Math.imul(tt,kt)|0,d=d+Math.imul(tt,St)|0,l=l+Math.imul(Y,Mt)|0,o=o+Math.imul(Y,_t)|0,o=o+Math.imul(X,Mt)|0,d=d+Math.imul(X,_t)|0,l=l+Math.imul(J,xt)|0,o=o+Math.imul(J,It)|0,o=o+Math.imul(Z,xt)|0,d=d+Math.imul(Z,It)|0,l=l+Math.imul(V,At)|0,o=o+Math.imul(V,Et)|0,o=o+Math.imul(H,At)|0,d=d+Math.imul(H,Et)|0,l=l+Math.imul(R,Rt)|0,o=o+Math.imul(R,Pt)|0,o=o+Math.imul(T,Rt)|0,d=d+Math.imul(T,Pt)|0;var ir=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(ir>>>26)|0,ir&=67108863,l=Math.imul(ut,dt),o=Math.imul(ut,pt),o=o+Math.imul(ht,dt)|0,d=Math.imul(ht,pt),l=l+Math.imul(at,gt)|0,o=o+Math.imul(at,mt)|0,o=o+Math.imul(ct,gt)|0,d=d+Math.imul(ct,mt)|0,l=l+Math.imul(st,yt)|0,o=o+Math.imul(st,wt)|0,o=o+Math.imul(ot,yt)|0,d=d+Math.imul(ot,wt)|0,l=l+Math.imul(nt,vt)|0,o=o+Math.imul(nt,bt)|0,o=o+Math.imul(it,vt)|0,d=d+Math.imul(it,bt)|0,l=l+Math.imul(et,kt)|0,o=o+Math.imul(et,St)|0,o=o+Math.imul(rt,kt)|0,d=d+Math.imul(rt,St)|0,l=l+Math.imul(Q,Mt)|0,o=o+Math.imul(Q,_t)|0,o=o+Math.imul(tt,Mt)|0,d=d+Math.imul(tt,_t)|0,l=l+Math.imul(Y,xt)|0,o=o+Math.imul(Y,It)|0,o=o+Math.imul(X,xt)|0,d=d+Math.imul(X,It)|0,l=l+Math.imul(J,At)|0,o=o+Math.imul(J,Et)|0,o=o+Math.imul(Z,At)|0,d=d+Math.imul(Z,Et)|0,l=l+Math.imul(V,Rt)|0,o=o+Math.imul(V,Pt)|0,o=o+Math.imul(H,Rt)|0,d=d+Math.imul(H,Pt)|0;var sr=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(sr>>>26)|0,sr&=67108863,l=Math.imul(ut,gt),o=Math.imul(ut,mt),o=o+Math.imul(ht,gt)|0,d=Math.imul(ht,mt),l=l+Math.imul(at,yt)|0,o=o+Math.imul(at,wt)|0,o=o+Math.imul(ct,yt)|0,d=d+Math.imul(ct,wt)|0,l=l+Math.imul(st,vt)|0,o=o+Math.imul(st,bt)|0,o=o+Math.imul(ot,vt)|0,d=d+Math.imul(ot,bt)|0,l=l+Math.imul(nt,kt)|0,o=o+Math.imul(nt,St)|0,o=o+Math.imul(it,kt)|0,d=d+Math.imul(it,St)|0,l=l+Math.imul(et,Mt)|0,o=o+Math.imul(et,_t)|0,o=o+Math.imul(rt,Mt)|0,d=d+Math.imul(rt,_t)|0,l=l+Math.imul(Q,xt)|0,o=o+Math.imul(Q,It)|0,o=o+Math.imul(tt,xt)|0,d=d+Math.imul(tt,It)|0,l=l+Math.imul(Y,At)|0,o=o+Math.imul(Y,Et)|0,o=o+Math.imul(X,At)|0,d=d+Math.imul(X,Et)|0,l=l+Math.imul(J,Rt)|0,o=o+Math.imul(J,Pt)|0,o=o+Math.imul(Z,Rt)|0,d=d+Math.imul(Z,Pt)|0;var or=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(or>>>26)|0,or&=67108863,l=Math.imul(ut,yt),o=Math.imul(ut,wt),o=o+Math.imul(ht,yt)|0,d=Math.imul(ht,wt),l=l+Math.imul(at,vt)|0,o=o+Math.imul(at,bt)|0,o=o+Math.imul(ct,vt)|0,d=d+Math.imul(ct,bt)|0,l=l+Math.imul(st,kt)|0,o=o+Math.imul(st,St)|0,o=o+Math.imul(ot,kt)|0,d=d+Math.imul(ot,St)|0,l=l+Math.imul(nt,Mt)|0,o=o+Math.imul(nt,_t)|0,o=o+Math.imul(it,Mt)|0,d=d+Math.imul(it,_t)|0,l=l+Math.imul(et,xt)|0,o=o+Math.imul(et,It)|0,o=o+Math.imul(rt,xt)|0,d=d+Math.imul(rt,It)|0,l=l+Math.imul(Q,At)|0,o=o+Math.imul(Q,Et)|0,o=o+Math.imul(tt,At)|0,d=d+Math.imul(tt,Et)|0,l=l+Math.imul(Y,Rt)|0,o=o+Math.imul(Y,Pt)|0,o=o+Math.imul(X,Rt)|0,d=d+Math.imul(X,Pt)|0;var ar=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(ar>>>26)|0,ar&=67108863,l=Math.imul(ut,vt),o=Math.imul(ut,bt),o=o+Math.imul(ht,vt)|0,d=Math.imul(ht,bt),l=l+Math.imul(at,kt)|0,o=o+Math.imul(at,St)|0,o=o+Math.imul(ct,kt)|0,d=d+Math.imul(ct,St)|0,l=l+Math.imul(st,Mt)|0,o=o+Math.imul(st,_t)|0,o=o+Math.imul(ot,Mt)|0,d=d+Math.imul(ot,_t)|0,l=l+Math.imul(nt,xt)|0,o=o+Math.imul(nt,It)|0,o=o+Math.imul(it,xt)|0,d=d+Math.imul(it,It)|0,l=l+Math.imul(et,At)|0,o=o+Math.imul(et,Et)|0,o=o+Math.imul(rt,At)|0,d=d+Math.imul(rt,Et)|0,l=l+Math.imul(Q,Rt)|0,o=o+Math.imul(Q,Pt)|0,o=o+Math.imul(tt,Rt)|0,d=d+Math.imul(tt,Pt)|0;var cr=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(cr>>>26)|0,cr&=67108863,l=Math.imul(ut,kt),o=Math.imul(ut,St),o=o+Math.imul(ht,kt)|0,d=Math.imul(ht,St),l=l+Math.imul(at,Mt)|0,o=o+Math.imul(at,_t)|0,o=o+Math.imul(ct,Mt)|0,d=d+Math.imul(ct,_t)|0,l=l+Math.imul(st,xt)|0,o=o+Math.imul(st,It)|0,o=o+Math.imul(ot,xt)|0,d=d+Math.imul(ot,It)|0,l=l+Math.imul(nt,At)|0,o=o+Math.imul(nt,Et)|0,o=o+Math.imul(it,At)|0,d=d+Math.imul(it,Et)|0,l=l+Math.imul(et,Rt)|0,o=o+Math.imul(et,Pt)|0,o=o+Math.imul(rt,Rt)|0,d=d+Math.imul(rt,Pt)|0;var ur=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(ur>>>26)|0,ur&=67108863,l=Math.imul(ut,Mt),o=Math.imul(ut,_t),o=o+Math.imul(ht,Mt)|0,d=Math.imul(ht,_t),l=l+Math.imul(at,xt)|0,o=o+Math.imul(at,It)|0,o=o+Math.imul(ct,xt)|0,d=d+Math.imul(ct,It)|0,l=l+Math.imul(st,At)|0,o=o+Math.imul(st,Et)|0,o=o+Math.imul(ot,At)|0,d=d+Math.imul(ot,Et)|0,l=l+Math.imul(nt,Rt)|0,o=o+Math.imul(nt,Pt)|0,o=o+Math.imul(it,Rt)|0,d=d+Math.imul(it,Pt)|0;var hr=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(hr>>>26)|0,hr&=67108863,l=Math.imul(ut,xt),o=Math.imul(ut,It),o=o+Math.imul(ht,xt)|0,d=Math.imul(ht,It),l=l+Math.imul(at,At)|0,o=o+Math.imul(at,Et)|0,o=o+Math.imul(ct,At)|0,d=d+Math.imul(ct,Et)|0,l=l+Math.imul(st,Rt)|0,o=o+Math.imul(st,Pt)|0,o=o+Math.imul(ot,Rt)|0,d=d+Math.imul(ot,Pt)|0;var lr=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(lr>>>26)|0,lr&=67108863,l=Math.imul(ut,At),o=Math.imul(ut,Et),o=o+Math.imul(ht,At)|0,d=Math.imul(ht,Et),l=l+Math.imul(at,Rt)|0,o=o+Math.imul(at,Pt)|0,o=o+Math.imul(ct,Rt)|0,d=d+Math.imul(ct,Pt)|0;var fr=(v+l|0)+((o&8191)<<13)|0;v=(d+(o>>>13)|0)+(fr>>>26)|0,fr&=67108863,l=Math.imul(ut,Rt),o=Math.imul(ut,Pt),o=o+Math.imul(ht,Rt)|0,d=Math.imul(ht,Pt);var dr=(v+l|0)+((o&8191)<<13)|0;return v=(d+(o>>>13)|0)+(dr>>>26)|0,dr&=67108863,y[0]=Je,y[1]=Ze,y[2]=Ye,y[3]=Xe,y[4]=Qe,y[5]=tr,y[6]=er,y[7]=rr,y[8]=nr,y[9]=ir,y[10]=sr,y[11]=or,y[12]=ar,y[13]=cr,y[14]=ur,y[15]=hr,y[16]=lr,y[17]=fr,y[18]=dr,v!==0&&(y[19]=v,h.length++),h};Math.imul||(G=U);function qt(g,n,c){c.negative=n.negative^g.negative,c.length=g.length+n.length;for(var h=0,f=0,p=0;p<c.length-1;p++){var y=f;f=0;for(var v=h&67108863,l=Math.min(p,n.length-1),o=Math.max(0,p-g.length+1);o<=l;o++){var d=p-o,P=g.words[d]|0,R=n.words[o]|0,T=P*R,zt=T&67108863;y=y+(T/67108864|0)|0,zt=zt+v|0,v=zt&67108863,y=y+(zt>>>26)|0,f+=y>>>26,y&=67108863}c.words[p]=v,h=y,y=f}return h!==0?c.words[p]=h:c.length--,c._strip()}function Ft(g,n,c){return qt(g,n,c)}i.prototype.mulTo=function(n,c){var h,f=this.length+n.length;return this.length===10&&n.length===10?h=G(this,n,c):f<63?h=U(this,n,c):f<1024?h=qt(this,n,c):h=Ft(this,n,c),h},i.prototype.mul=function(n){var c=new i(null);return c.words=new Array(this.length+n.length),this.mulTo(n,c)},i.prototype.mulf=function(n){var c=new i(null);return c.words=new Array(this.length+n.length),Ft(this,n,c)},i.prototype.imul=function(n){return this.clone().mulTo(n,this)},i.prototype.imuln=function(n){var c=n<0;c&&(n=-n),r(typeof n=="number"),r(n<67108864);for(var h=0,f=0;f<this.length;f++){var p=(this.words[f]|0)*n,y=(p&67108863)+(h&67108863);h>>=26,h+=p/67108864|0,h+=y>>>26,this.words[f]=y&67108863}return h!==0&&(this.words[f]=h,this.length++),c?this.ineg():this},i.prototype.muln=function(n){return this.clone().imuln(n)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(n){var c=N(n);if(c.length===0)return new i(1);for(var h=this,f=0;f<c.length&&c[f]===0;f++,h=h.sqr());if(++f<c.length)for(var p=h.sqr();f<c.length;f++,p=p.sqr())c[f]!==0&&(h=h.mul(p));return h},i.prototype.iushln=function(n){r(typeof n=="number"&&n>=0);var c=n%26,h=(n-c)/26,f=67108863>>>26-c<<26-c,p;if(c!==0){var y=0;for(p=0;p<this.length;p++){var v=this.words[p]&f,l=(this.words[p]|0)-v<<c;this.words[p]=l|y,y=v>>>26-c}y&&(this.words[p]=y,this.length++)}if(h!==0){for(p=this.length-1;p>=0;p--)this.words[p+h]=this.words[p];for(p=0;p<h;p++)this.words[p]=0;this.length+=h}return this._strip()},i.prototype.ishln=function(n){return r(this.negative===0),this.iushln(n)},i.prototype.iushrn=function(n,c,h){r(typeof n=="number"&&n>=0);var f;c?f=(c-c%26)/26:f=0;var p=n%26,y=Math.min((n-p)/26,this.length),v=67108863^67108863>>>p<<p,l=h;if(f-=y,f=Math.max(0,f),l){for(var o=0;o<y;o++)l.words[o]=this.words[o];l.length=y}if(y!==0)if(this.length>y)for(this.length-=y,o=0;o<this.length;o++)this.words[o]=this.words[o+y];else this.words[0]=0,this.length=1;var d=0;for(o=this.length-1;o>=0&&(d!==0||o>=f);o--){var P=this.words[o]|0;this.words[o]=d<<26-p|P>>>p,d=P&v}return l&&d!==0&&(l.words[l.length++]=d),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},i.prototype.ishrn=function(n,c,h){return r(this.negative===0),this.iushrn(n,c,h)},i.prototype.shln=function(n){return this.clone().ishln(n)},i.prototype.ushln=function(n){return this.clone().iushln(n)},i.prototype.shrn=function(n){return this.clone().ishrn(n)},i.prototype.ushrn=function(n){return this.clone().iushrn(n)},i.prototype.testn=function(n){r(typeof n=="number"&&n>=0);var c=n%26,h=(n-c)/26,f=1<<c;if(this.length<=h)return!1;var p=this.words[h];return!!(p&f)},i.prototype.imaskn=function(n){r(typeof n=="number"&&n>=0);var c=n%26,h=(n-c)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=h)return this;if(c!==0&&h++,this.length=Math.min(h,this.length),c!==0){var f=67108863^67108863>>>c<<c;this.words[this.length-1]&=f}return this._strip()},i.prototype.maskn=function(n){return this.clone().imaskn(n)},i.prototype.iaddn=function(n){return r(typeof n=="number"),r(n<67108864),n<0?this.isubn(-n):this.negative!==0?this.length===1&&(this.words[0]|0)<=n?(this.words[0]=n-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(n),this.negative=1,this):this._iaddn(n)},i.prototype._iaddn=function(n){this.words[0]+=n;for(var c=0;c<this.length&&this.words[c]>=67108864;c++)this.words[c]-=67108864,c===this.length-1?this.words[c+1]=1:this.words[c+1]++;return this.length=Math.max(this.length,c+1),this},i.prototype.isubn=function(n){if(r(typeof n=="number"),r(n<67108864),n<0)return this.iaddn(-n);if(this.negative!==0)return this.negative=0,this.iaddn(n),this.negative=1,this;if(this.words[0]-=n,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var c=0;c<this.length&&this.words[c]<0;c++)this.words[c]+=67108864,this.words[c+1]-=1;return this._strip()},i.prototype.addn=function(n){return this.clone().iaddn(n)},i.prototype.subn=function(n){return this.clone().isubn(n)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(n,c,h){var f=n.length+h,p;this._expand(f);var y,v=0;for(p=0;p<n.length;p++){y=(this.words[p+h]|0)+v;var l=(n.words[p]|0)*c;y-=l&67108863,v=(y>>26)-(l/67108864|0),this.words[p+h]=y&67108863}for(;p<this.length-h;p++)y=(this.words[p+h]|0)+v,v=y>>26,this.words[p+h]=y&67108863;if(v===0)return this._strip();for(r(v===-1),v=0,p=0;p<this.length;p++)y=-(this.words[p]|0)+v,v=y>>26,this.words[p]=y&67108863;return this.negative=1,this._strip()},i.prototype._wordDiv=function(n,c){var h=this.length-n.length,f=this.clone(),p=n,y=p.words[p.length-1]|0,v=this._countBits(y);h=26-v,h!==0&&(p=p.ushln(h),f.iushln(h),y=p.words[p.length-1]|0);var l=f.length-p.length,o;if(c!=="mod"){o=new i(null),o.length=l+1,o.words=new Array(o.length);for(var d=0;d<o.length;d++)o.words[d]=0}var P=f.clone()._ishlnsubmul(p,1,l);P.negative===0&&(f=P,o&&(o.words[l]=1));for(var R=l-1;R>=0;R--){var T=(f.words[p.length+R]|0)*67108864+(f.words[p.length+R-1]|0);for(T=Math.min(T/y|0,67108863),f._ishlnsubmul(p,T,R);f.negative!==0;)T--,f.negative=0,f._ishlnsubmul(p,1,R),f.isZero()||(f.negative^=1);o&&(o.words[R]=T)}return o&&o._strip(),f._strip(),c!=="div"&&h!==0&&f.iushrn(h),{div:o||null,mod:f}},i.prototype.divmod=function(n,c,h){if(r(!n.isZero()),this.isZero())return{div:new i(0),mod:new i(0)};var f,p,y;return this.negative!==0&&n.negative===0?(y=this.neg().divmod(n,c),c!=="mod"&&(f=y.div.neg()),c!=="div"&&(p=y.mod.neg(),h&&p.negative!==0&&p.iadd(n)),{div:f,mod:p}):this.negative===0&&n.negative!==0?(y=this.divmod(n.neg(),c),c!=="mod"&&(f=y.div.neg()),{div:f,mod:y.mod}):this.negative&n.negative?(y=this.neg().divmod(n.neg(),c),c!=="div"&&(p=y.mod.neg(),h&&p.negative!==0&&p.isub(n)),{div:y.div,mod:p}):n.length>this.length||this.cmp(n)<0?{div:new i(0),mod:this}:n.length===1?c==="div"?{div:this.divn(n.words[0]),mod:null}:c==="mod"?{div:null,mod:new i(this.modrn(n.words[0]))}:{div:this.divn(n.words[0]),mod:new i(this.modrn(n.words[0]))}:this._wordDiv(n,c)},i.prototype.div=function(n){return this.divmod(n,"div",!1).div},i.prototype.mod=function(n){return this.divmod(n,"mod",!1).mod},i.prototype.umod=function(n){return this.divmod(n,"mod",!0).mod},i.prototype.divRound=function(n){var c=this.divmod(n);if(c.mod.isZero())return c.div;var h=c.div.negative!==0?c.mod.isub(n):c.mod,f=n.ushrn(1),p=n.andln(1),y=h.cmp(f);return y<0||p===1&&y===0?c.div:c.div.negative!==0?c.div.isubn(1):c.div.iaddn(1)},i.prototype.modrn=function(n){var c=n<0;c&&(n=-n),r(n<=67108863);for(var h=(1<<26)%n,f=0,p=this.length-1;p>=0;p--)f=(h*f+(this.words[p]|0))%n;return c?-f:f},i.prototype.modn=function(n){return this.modrn(n)},i.prototype.idivn=function(n){var c=n<0;c&&(n=-n),r(n<=67108863);for(var h=0,f=this.length-1;f>=0;f--){var p=(this.words[f]|0)+h*67108864;this.words[f]=p/n|0,h=p%n}return this._strip(),c?this.ineg():this},i.prototype.divn=function(n){return this.clone().idivn(n)},i.prototype.egcd=function(n){r(n.negative===0),r(!n.isZero());var c=this,h=n.clone();c.negative!==0?c=c.umod(n):c=c.clone();for(var f=new i(1),p=new i(0),y=new i(0),v=new i(1),l=0;c.isEven()&&h.isEven();)c.iushrn(1),h.iushrn(1),++l;for(var o=h.clone(),d=c.clone();!c.isZero();){for(var P=0,R=1;!(c.words[0]&R)&&P<26;++P,R<<=1);if(P>0)for(c.iushrn(P);P-- >0;)(f.isOdd()||p.isOdd())&&(f.iadd(o),p.isub(d)),f.iushrn(1),p.iushrn(1);for(var T=0,zt=1;!(h.words[0]&zt)&&T<26;++T,zt<<=1);if(T>0)for(h.iushrn(T);T-- >0;)(y.isOdd()||v.isOdd())&&(y.iadd(o),v.isub(d)),y.iushrn(1),v.iushrn(1);c.cmp(h)>=0?(c.isub(h),f.isub(y),p.isub(v)):(h.isub(c),y.isub(f),v.isub(p))}return{a:y,b:v,gcd:h.iushln(l)}},i.prototype._invmp=function(n){r(n.negative===0),r(!n.isZero());var c=this,h=n.clone();c.negative!==0?c=c.umod(n):c=c.clone();for(var f=new i(1),p=new i(0),y=h.clone();c.cmpn(1)>0&&h.cmpn(1)>0;){for(var v=0,l=1;!(c.words[0]&l)&&v<26;++v,l<<=1);if(v>0)for(c.iushrn(v);v-- >0;)f.isOdd()&&f.iadd(y),f.iushrn(1);for(var o=0,d=1;!(h.words[0]&d)&&o<26;++o,d<<=1);if(o>0)for(h.iushrn(o);o-- >0;)p.isOdd()&&p.iadd(y),p.iushrn(1);c.cmp(h)>=0?(c.isub(h),f.isub(p)):(h.isub(c),p.isub(f))}var P;return c.cmpn(1)===0?P=f:P=p,P.cmpn(0)<0&&P.iadd(n),P},i.prototype.gcd=function(n){if(this.isZero())return n.abs();if(n.isZero())return this.abs();var c=this.clone(),h=n.clone();c.negative=0,h.negative=0;for(var f=0;c.isEven()&&h.isEven();f++)c.iushrn(1),h.iushrn(1);do{for(;c.isEven();)c.iushrn(1);for(;h.isEven();)h.iushrn(1);var p=c.cmp(h);if(p<0){var y=c;c=h,h=y}else if(p===0||h.cmpn(1)===0)break;c.isub(h)}while(!0);return h.iushln(f)},i.prototype.invm=function(n){return this.egcd(n).a.umod(n)},i.prototype.isEven=function(){return(this.words[0]&1)===0},i.prototype.isOdd=function(){return(this.words[0]&1)===1},i.prototype.andln=function(n){return this.words[0]&n},i.prototype.bincn=function(n){r(typeof n=="number");var c=n%26,h=(n-c)/26,f=1<<c;if(this.length<=h)return this._expand(h+1),this.words[h]|=f,this;for(var p=f,y=h;p!==0&&y<this.length;y++){var v=this.words[y]|0;v+=p,p=v>>>26,v&=67108863,this.words[y]=v}return p!==0&&(this.words[y]=p,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(n){var c=n<0;if(this.negative!==0&&!c)return-1;if(this.negative===0&&c)return 1;this._strip();var h;if(this.length>1)h=1;else{c&&(n=-n),r(n<=67108863,"Number is too big");var f=this.words[0]|0;h=f===n?0:f<n?-1:1}return this.negative!==0?-h|0:h},i.prototype.cmp=function(n){if(this.negative!==0&&n.negative===0)return-1;if(this.negative===0&&n.negative!==0)return 1;var c=this.ucmp(n);return this.negative!==0?-c|0:c},i.prototype.ucmp=function(n){if(this.length>n.length)return 1;if(this.length<n.length)return-1;for(var c=0,h=this.length-1;h>=0;h--){var f=this.words[h]|0,p=n.words[h]|0;if(f!==p){f<p?c=-1:f>p&&(c=1);break}}return c},i.prototype.gtn=function(n){return this.cmpn(n)===1},i.prototype.gt=function(n){return this.cmp(n)===1},i.prototype.gten=function(n){return this.cmpn(n)>=0},i.prototype.gte=function(n){return this.cmp(n)>=0},i.prototype.ltn=function(n){return this.cmpn(n)===-1},i.prototype.lt=function(n){return this.cmp(n)===-1},i.prototype.lten=function(n){return this.cmpn(n)<=0},i.prototype.lte=function(n){return this.cmp(n)<=0},i.prototype.eqn=function(n){return this.cmpn(n)===0},i.prototype.eq=function(n){return this.cmp(n)===0},i.red=function(n){return new j(n)},i.prototype.toRed=function(n){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),n.convertTo(this)._forceRed(n)},i.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(n){return this.red=n,this},i.prototype.forceRed=function(n){return r(!this.red,"Already a number in reduction context"),this._forceRed(n)},i.prototype.redAdd=function(n){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,n)},i.prototype.redIAdd=function(n){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,n)},i.prototype.redSub=function(n){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,n)},i.prototype.redISub=function(n){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,n)},i.prototype.redShl=function(n){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,n)},i.prototype.redMul=function(n){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,n),this.red.mul(this,n)},i.prototype.redIMul=function(n){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,n),this.red.imul(this,n)},i.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(n){return r(this.red&&!n.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,n)};var Qt={k256:null,p224:null,p192:null,p25519:null};function Lt(g,n){this.name=g,this.p=new i(n,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}Lt.prototype._tmp=function(){var n=new i(null);return n.words=new Array(Math.ceil(this.n/13)),n},Lt.prototype.ireduce=function(n){var c=n,h;do this.split(c,this.tmp),c=this.imulK(c),c=c.iadd(this.tmp),h=c.bitLength();while(h>this.n);var f=h<this.n?-1:c.ucmp(this.p);return f===0?(c.words[0]=0,c.length=1):f>0?c.isub(this.p):c.strip!==void 0?c.strip():c._strip(),c},Lt.prototype.split=function(n,c){n.iushrn(this.n,0,c)},Lt.prototype.imulK=function(n){return n.imul(this.k)};function te(){Lt.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}s(te,Lt),te.prototype.split=function(n,c){for(var h=4194303,f=Math.min(n.length,9),p=0;p<f;p++)c.words[p]=n.words[p];if(c.length=f,n.length<=9){n.words[0]=0,n.length=1;return}var y=n.words[9];for(c.words[c.length++]=y&h,p=10;p<n.length;p++){var v=n.words[p]|0;n.words[p-10]=(v&h)<<4|y>>>22,y=v}y>>>=22,n.words[p-10]=y,y===0&&n.length>10?n.length-=10:n.length-=9},te.prototype.imulK=function(n){n.words[n.length]=0,n.words[n.length+1]=0,n.length+=2;for(var c=0,h=0;h<n.length;h++){var f=n.words[h]|0;c+=f*977,n.words[h]=c&67108863,c=f*64+(c/67108864|0)}return n.words[n.length-1]===0&&(n.length--,n.words[n.length-1]===0&&n.length--),n};function Ee(){Lt.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}s(Ee,Lt);function Fr(){Lt.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}s(Fr,Lt);function je(){Lt.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}s(je,Lt),je.prototype.imulK=function(n){for(var c=0,h=0;h<n.length;h++){var f=(n.words[h]|0)*19+c,p=f&67108863;f>>>=26,n.words[h]=p,c=f}return c!==0&&(n.words[n.length++]=c),n},i._prime=function(n){if(Qt[n])return Qt[n];var c;if(n==="k256")c=new te;else if(n==="p224")c=new Ee;else if(n==="p192")c=new Fr;else if(n==="p25519")c=new je;else throw new Error("Unknown prime "+n);return Qt[n]=c,c};function j(g){if(typeof g=="string"){var n=i._prime(g);this.m=n.p,this.prime=n}else r(g.gtn(1),"modulus must be greater than 1"),this.m=g,this.prime=null}j.prototype._verify1=function(n){r(n.negative===0,"red works only with positives"),r(n.red,"red works only with red numbers")},j.prototype._verify2=function(n,c){r((n.negative|c.negative)===0,"red works only with positives"),r(n.red&&n.red===c.red,"red works only with red numbers")},j.prototype.imod=function(n){return this.prime?this.prime.ireduce(n)._forceRed(this):(M(n,n.umod(this.m)._forceRed(this)),n)},j.prototype.neg=function(n){return n.isZero()?n.clone():this.m.sub(n)._forceRed(this)},j.prototype.add=function(n,c){this._verify2(n,c);var h=n.add(c);return h.cmp(this.m)>=0&&h.isub(this.m),h._forceRed(this)},j.prototype.iadd=function(n,c){this._verify2(n,c);var h=n.iadd(c);return h.cmp(this.m)>=0&&h.isub(this.m),h},j.prototype.sub=function(n,c){this._verify2(n,c);var h=n.sub(c);return h.cmpn(0)<0&&h.iadd(this.m),h._forceRed(this)},j.prototype.isub=function(n,c){this._verify2(n,c);var h=n.isub(c);return h.cmpn(0)<0&&h.iadd(this.m),h},j.prototype.shl=function(n,c){return this._verify1(n),this.imod(n.ushln(c))},j.prototype.imul=function(n,c){return this._verify2(n,c),this.imod(n.imul(c))},j.prototype.mul=function(n,c){return this._verify2(n,c),this.imod(n.mul(c))},j.prototype.isqr=function(n){return this.imul(n,n.clone())},j.prototype.sqr=function(n){return this.mul(n,n)},j.prototype.sqrt=function(n){if(n.isZero())return n.clone();var c=this.m.andln(3);if(r(c%2===1),c===3){var h=this.m.add(new i(1)).iushrn(2);return this.pow(n,h)}for(var f=this.m.subn(1),p=0;!f.isZero()&&f.andln(1)===0;)p++,f.iushrn(1);r(!f.isZero());var y=new i(1).toRed(this),v=y.redNeg(),l=this.m.subn(1).iushrn(1),o=this.m.bitLength();for(o=new i(2*o*o).toRed(this);this.pow(o,l).cmp(v)!==0;)o.redIAdd(v);for(var d=this.pow(o,f),P=this.pow(n,f.addn(1).iushrn(1)),R=this.pow(n,f),T=p;R.cmp(y)!==0;){for(var zt=R,V=0;zt.cmp(y)!==0;V++)zt=zt.redSqr();r(V<T);var H=this.pow(d,new i(1).iushln(T-V-1));P=P.redMul(H),d=H.redSqr(),R=R.redMul(d),T=V}return P},j.prototype.invm=function(n){var c=n._invmp(this.m);return c.negative!==0?(c.negative=0,this.imod(c).redNeg()):this.imod(c)},j.prototype.pow=function(n,c){if(c.isZero())return new i(1).toRed(this);if(c.cmpn(1)===0)return n.clone();var h=4,f=new Array(1<<h);f[0]=new i(1).toRed(this),f[1]=n;for(var p=2;p<f.length;p++)f[p]=this.mul(f[p-1],n);var y=f[0],v=0,l=0,o=c.bitLength()%26;for(o===0&&(o=26),p=c.length-1;p>=0;p--){for(var d=c.words[p],P=o-1;P>=0;P--){var R=d>>P&1;if(y!==f[0]&&(y=this.sqr(y)),R===0&&v===0){l=0;continue}v<<=1,v|=R,l++,!(l!==h&&(p!==0||P!==0))&&(y=this.mul(y,f[v]),l=0,v=0)}o=26}return y},j.prototype.convertTo=function(n){var c=n.umod(this.m);return c===n?c.clone():c},j.prototype.convertFrom=function(n){var c=n.clone();return c.red=null,c},i.mont=function(n){return new pe(n)};function pe(g){j.call(this,g),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}s(pe,j),pe.prototype.convertTo=function(n){return this.imod(n.ushln(this.shift))},pe.prototype.convertFrom=function(n){var c=this.imod(n.mul(this.rinv));return c.red=null,c},pe.prototype.imul=function(n,c){if(n.isZero()||c.isZero())return n.words[0]=0,n.length=1,n;var h=n.imul(c),f=h.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),p=h.isub(f).iushrn(this.shift),y=p;return p.cmp(this.m)>=0?y=p.isub(this.m):p.cmpn(0)<0&&(y=p.iadd(this.m)),y._forceRed(this)},pe.prototype.mul=function(n,c){if(n.isZero()||c.isZero())return new i(0)._forceRed(this);var h=n.mul(c),f=h.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),p=h.isub(f).iushrn(this.shift),y=p;return p.cmp(this.m)>=0?y=p.isub(this.m):p.cmpn(0)<0&&(y=p.iadd(this.m)),y._forceRed(this)},pe.prototype.invm=function(n){var c=this.imod(n._invmp(this.m).mul(this.r2));return c._forceRed(this)}})(a,de)})(bi);var Ko=bi.exports;function Fe(a,t,e){return t<=a&&a<=e}function Cn(a){if(a===void 0)return{};if(a===Object(a))return a;throw TypeError("Could not convert argument to dictionary")}function Uo(a){for(var t=String(a),e=t.length,r=0,s=[];r<e;){var i=t.charCodeAt(r);if(i<55296||i>57343)s.push(i);else if(56320<=i&&i<=57343)s.push(65533);else if(55296<=i&&i<=56319)if(r===e-1)s.push(65533);else{var u=a.charCodeAt(r+1);if(56320<=u&&u<=57343){var m=i&1023,w=u&1023;s.push(65536+(m<<10)+w),r+=1}else s.push(65533)}r+=1}return s}function Wo(a){for(var t="",e=0;e<a.length;++e){var r=a[e];r<=65535?t+=String.fromCharCode(r):(r-=65536,t+=String.fromCharCode((r>>10)+55296,(r&1023)+56320))}return t}var In=-1;function ki(a){this.tokens=[].slice.call(a)}ki.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.shift():In},prepend:function(a){if(Array.isArray(a))for(var t=a;t.length;)this.tokens.unshift(t.pop());else this.tokens.unshift(a)},push:function(a){if(Array.isArray(a))for(var t=a;t.length;)this.tokens.push(t.shift());else this.tokens.push(a)}};var Lr=-1;function Zn(a,t){if(a)throw TypeError("Decoder error");return t||65533}var An="utf-8";function En(a,t){if(!(this instanceof En))return new En(a,t);if(a=a!==void 0?String(a).toLowerCase():An,a!==An)throw new Error("Encoding not supported. Only utf-8 is supported");t=Cn(t),this._streaming=!1,this._BOMseen=!1,this._decoder=null,this._fatal=!!t.fatal,this._ignoreBOM=!!t.ignoreBOM,Object.defineProperty(this,"encoding",{value:"utf-8"}),Object.defineProperty(this,"fatal",{value:this._fatal}),Object.defineProperty(this,"ignoreBOM",{value:this._ignoreBOM})}En.prototype={decode:function(t,e){var r;typeof t=="object"&&t instanceof ArrayBuffer?r=new Uint8Array(t):typeof t=="object"&&"buffer"in t&&t.buffer instanceof ArrayBuffer?r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):r=new Uint8Array(0),e=Cn(e),this._streaming||(this._decoder=new qo({fatal:this._fatal}),this._BOMseen=!1),this._streaming=!!e.stream;for(var s=new ki(r),i=[],u;!s.endOfStream()&&(u=this._decoder.handler(s,s.read()),u!==Lr);)u!==null&&(Array.isArray(u)?i.push.apply(i,u):i.push(u));if(!this._streaming){do{if(u=this._decoder.handler(s,s.read()),u===Lr)break;u!==null&&(Array.isArray(u)?i.push.apply(i,u):i.push(u))}while(!s.endOfStream());this._decoder=null}return i.length&&["utf-8"].indexOf(this.encoding)!==-1&&!this._ignoreBOM&&!this._BOMseen&&(i[0]===65279?(this._BOMseen=!0,i.shift()):this._BOMseen=!0),Wo(i)}};function Rn(a,t){if(!(this instanceof Rn))return new Rn(a,t);if(a=a!==void 0?String(a).toLowerCase():An,a!==An)throw new Error("Encoding not supported. Only utf-8 is supported");t=Cn(t),this._streaming=!1,this._encoder=null,this._options={fatal:!!t.fatal},Object.defineProperty(this,"encoding",{value:"utf-8"})}Rn.prototype={encode:function(t,e){t=t?String(t):"",e=Cn(e),this._streaming||(this._encoder=new Fo(this._options)),this._streaming=!!e.stream;for(var r=[],s=new ki(Uo(t)),i;!s.endOfStream()&&(i=this._encoder.handler(s,s.read()),i!==Lr);)Array.isArray(i)?r.push.apply(r,i):r.push(i);if(!this._streaming){for(;i=this._encoder.handler(s,s.read()),i!==Lr;)Array.isArray(i)?r.push.apply(r,i):r.push(i);this._encoder=null}return new Uint8Array(r)}};function qo(a){var t=a.fatal,e=0,r=0,s=0,i=128,u=191;this.handler=function(m,w){if(w===In&&s!==0)return s=0,Zn(t);if(w===In)return Lr;if(s===0){if(Fe(w,0,127))return w;if(Fe(w,194,223))s=1,e=w-192;else if(Fe(w,224,239))w===224&&(i=160),w===237&&(u=159),s=2,e=w-224;else if(Fe(w,240,244))w===240&&(i=144),w===244&&(u=143),s=3,e=w-240;else return Zn(t);return e=e<<6*s,null}if(!Fe(w,i,u))return e=s=r=0,i=128,u=191,m.prepend(w),Zn(t);if(i=128,u=191,r+=1,e+=w-128<<6*(s-r),r!==s)return null;var b=e;return e=s=r=0,b}}function Fo(a){a.fatal,this.handler=function(t,e){if(e===In)return Lr;if(Fe(e,0,127))return e;var r,s;Fe(e,128,2047)?(r=1,s=192):Fe(e,2048,65535)?(r=2,s=224):Fe(e,65536,1114111)&&(r=3,s=240);for(var i=[(e>>6*r)+s];r>0;){var u=e>>6*(r-1);i.push(128|u&63),r-=1}return i}}const Do=Object.freeze(Object.defineProperty({__proto__:null,TextDecoder:En,TextEncoder:Rn},Symbol.toStringTag,{value:"Module"})),Vo=yi(Do);var $o=de&&de.__createBinding||(Object.create?function(a,t,e,r){r===void 0&&(r=e),Object.defineProperty(a,r,{enumerable:!0,get:function(){return t[e]}})}:function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]}),Ho=de&&de.__setModuleDefault||(Object.create?function(a,t){Object.defineProperty(a,"default",{enumerable:!0,value:t})}:function(a,t){a.default=t}),Oe=de&&de.__decorate||function(a,t,e,r){var s=arguments.length,i=s<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,e):r,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(a,t,e,r);else for(var m=a.length-1;m>=0;m--)(u=a[m])&&(i=(s<3?u(i):s>3?u(t,e,i):u(t,e))||i);return s>3&&i&&Object.defineProperty(t,e,i),i},Go=de&&de.__importStar||function(a){if(a&&a.__esModule)return a;var t={};if(a!=null)for(var e in a)e!=="default"&&Object.hasOwnProperty.call(a,e)&&$o(t,a,e);return Ho(t,a),t},bs=de&&de.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(oe,"__esModule",{value:!0});var ks=oe.deserializeUnchecked=As=oe.deserialize=Is=oe.serialize=oe.BinaryReader=oe.BinaryWriter=oe.BorshError=oe.baseDecode=oe.baseEncode=void 0;const Ve=bs(Ko),Ss=bs(Oo),jo=Go(Vo),Jo=typeof TextDecoder!="function"?jo.TextDecoder:TextDecoder,Zo=new Jo("utf-8",{fatal:!0});function Yo(a){return typeof a=="string"&&(a=re.from(a,"utf8")),Ss.default.encode(re.from(a))}oe.baseEncode=Yo;function Xo(a){return re.from(Ss.default.decode(a))}oe.baseDecode=Xo;const Yn=1024;class ge extends Error{constructor(t){super(t),this.fieldPath=[],this.originalMessage=t}addToFieldPath(t){this.fieldPath.splice(0,0,t),this.message=this.originalMessage+": "+this.fieldPath.join(".")}}oe.BorshError=ge;class Ms{constructor(){this.buf=re.alloc(Yn),this.length=0}maybeResize(){this.buf.length<16+this.length&&(this.buf=re.concat([this.buf,re.alloc(Yn)]))}writeU8(t){this.maybeResize(),this.buf.writeUInt8(t,this.length),this.length+=1}writeU16(t){this.maybeResize(),this.buf.writeUInt16LE(t,this.length),this.length+=2}writeU32(t){this.maybeResize(),this.buf.writeUInt32LE(t,this.length),this.length+=4}writeU64(t){this.maybeResize(),this.writeBuffer(re.from(new Ve.default(t).toArray("le",8)))}writeU128(t){this.maybeResize(),this.writeBuffer(re.from(new Ve.default(t).toArray("le",16)))}writeU256(t){this.maybeResize(),this.writeBuffer(re.from(new Ve.default(t).toArray("le",32)))}writeU512(t){this.maybeResize(),this.writeBuffer(re.from(new Ve.default(t).toArray("le",64)))}writeBuffer(t){this.buf=re.concat([re.from(this.buf.subarray(0,this.length)),t,re.alloc(Yn)]),this.length+=t.length}writeString(t){this.maybeResize();const e=re.from(t,"utf8");this.writeU32(e.length),this.writeBuffer(e)}writeFixedArray(t){this.writeBuffer(re.from(t))}writeArray(t,e){this.maybeResize(),this.writeU32(t.length);for(const r of t)this.maybeResize(),e(r)}toArray(){return this.buf.subarray(0,this.length)}}oe.BinaryWriter=Ms;function ze(a,t,e){const r=e.value;e.value=function(...s){try{return r.apply(this,s)}catch(i){if(i instanceof RangeError){const u=i.code;if(["ERR_BUFFER_OUT_OF_BOUNDS","ERR_OUT_OF_RANGE"].indexOf(u)>=0)throw new ge("Reached the end of buffer when deserializing")}throw i}}}class Se{constructor(t){this.buf=t,this.offset=0}readU8(){const t=this.buf.readUInt8(this.offset);return this.offset+=1,t}readU16(){const t=this.buf.readUInt16LE(this.offset);return this.offset+=2,t}readU32(){const t=this.buf.readUInt32LE(this.offset);return this.offset+=4,t}readU64(){const t=this.readBuffer(8);return new Ve.default(t,"le")}readU128(){const t=this.readBuffer(16);return new Ve.default(t,"le")}readU256(){const t=this.readBuffer(32);return new Ve.default(t,"le")}readU512(){const t=this.readBuffer(64);return new Ve.default(t,"le")}readBuffer(t){if(this.offset+t>this.buf.length)throw new ge(`Expected buffer length ${t} isn't within bounds`);const e=this.buf.slice(this.offset,this.offset+t);return this.offset+=t,e}readString(){const t=this.readU32(),e=this.readBuffer(t);try{return Zo.decode(e)}catch(r){throw new ge(`Error decoding UTF-8 string: ${r}`)}}readFixedArray(t){return new Uint8Array(this.readBuffer(t))}readArray(t){const e=this.readU32(),r=Array();for(let s=0;s<e;++s)r.push(t());return r}}Oe([ze],Se.prototype,"readU8",null);Oe([ze],Se.prototype,"readU16",null);Oe([ze],Se.prototype,"readU32",null);Oe([ze],Se.prototype,"readU64",null);Oe([ze],Se.prototype,"readU128",null);Oe([ze],Se.prototype,"readU256",null);Oe([ze],Se.prototype,"readU512",null);Oe([ze],Se.prototype,"readString",null);Oe([ze],Se.prototype,"readFixedArray",null);Oe([ze],Se.prototype,"readArray",null);oe.BinaryReader=Se;function _s(a){return a.charAt(0).toUpperCase()+a.slice(1)}function mr(a,t,e,r,s){try{if(typeof r=="string")s[`write${_s(r)}`](e);else if(r instanceof Array)if(typeof r[0]=="number"){if(e.length!==r[0])throw new ge(`Expecting byte array of length ${r[0]}, but got ${e.length} bytes`);s.writeFixedArray(e)}else if(r.length===2&&typeof r[1]=="number"){if(e.length!==r[1])throw new ge(`Expecting byte array of length ${r[1]}, but got ${e.length} bytes`);for(let i=0;i<r[1];i++)mr(a,null,e[i],r[0],s)}else s.writeArray(e,i=>{mr(a,t,i,r[0],s)});else if(r.kind!==void 0)switch(r.kind){case"option":{e==null?s.writeU8(0):(s.writeU8(1),mr(a,t,e,r.type,s));break}case"map":{s.writeU32(e.size),e.forEach((i,u)=>{mr(a,t,u,r.key,s),mr(a,t,i,r.value,s)});break}default:throw new ge(`FieldType ${r} unrecognized`)}else xs(a,e,s)}catch(i){throw i instanceof ge&&i.addToFieldPath(t),i}}function xs(a,t,e){if(typeof t.borshSerialize=="function"){t.borshSerialize(e);return}const r=a.get(t.constructor);if(!r)throw new ge(`Class ${t.constructor.name} is missing in schema`);if(r.kind==="struct")r.fields.map(([s,i])=>{mr(a,s,t[s],i,e)});else if(r.kind==="enum"){const s=t[r.field];for(let i=0;i<r.values.length;++i){const[u,m]=r.values[i];if(u===s){e.writeU8(i),mr(a,u,t[u],m,e);break}}}else throw new ge(`Unexpected schema kind: ${r.kind} for ${t.constructor.name}`)}function Qo(a,t,e=Ms){const r=new e;return xs(a,t,r),r.toArray()}var Is=oe.serialize=Qo;function yr(a,t,e,r){try{if(typeof e=="string")return r[`read${_s(e)}`]();if(e instanceof Array){if(typeof e[0]=="number")return r.readFixedArray(e[0]);if(typeof e[1]=="number"){const s=[];for(let i=0;i<e[1];i++)s.push(yr(a,null,e[0],r));return s}else return r.readArray(()=>yr(a,t,e[0],r))}if(e.kind==="option")return r.readU8()?yr(a,t,e.type,r):void 0;if(e.kind==="map"){let s=new Map;const i=r.readU32();for(let u=0;u<i;u++){const m=yr(a,t,e.key,r),w=yr(a,t,e.value,r);s.set(m,w)}return s}return Si(a,e,r)}catch(s){throw s instanceof ge&&s.addToFieldPath(t),s}}function Si(a,t,e){if(typeof t.borshDeserialize=="function")return t.borshDeserialize(e);const r=a.get(t);if(!r)throw new ge(`Class ${t.name} is missing in schema`);if(r.kind==="struct"){const s={};for(const[i,u]of a.get(t).fields)s[i]=yr(a,i,u,e);return new t(s)}if(r.kind==="enum"){const s=e.readU8();if(s>=r.values.length)throw new ge(`Enum index: ${s} is out of range`);const[i,u]=r.values[s],m=yr(a,i,u,e);return new t({[i]:m})}throw new ge(`Unexpected schema kind: ${r.kind} for ${t.constructor.name}`)}function ta(a,t,e,r=Se){const s=new r(e),i=Si(a,t,s);if(s.offset<e.length)throw new ge(`Unexpected ${e.length-s.offset} bytes after deserialized data`);return i}var As=oe.deserialize=ta;function ea(a,t,e,r=Se){const s=new r(e);return Si(a,t,s)}ks=oe.deserializeUnchecked=ea;var S={};Object.defineProperty(S,"__esModule",{value:!0});S.s16=S.s8=S.nu64be=S.u48be=S.u40be=S.u32be=S.u24be=S.u16be=se=S.nu64=S.u48=S.u40=W=S.u32=S.u24=Me=S.u16=Kt=S.u8=He=S.offset=S.greedy=S.Constant=S.UTF8=S.CString=S.Blob=S.Boolean=S.BitField=S.BitStructure=S.VariantLayout=S.Union=S.UnionLayoutDiscriminator=S.UnionDiscriminator=S.Structure=S.Sequence=S.DoubleBE=S.Double=S.FloatBE=S.Float=S.NearInt64BE=S.NearInt64=S.NearUInt64BE=S.NearUInt64=S.IntBE=S.Int=S.UIntBE=S.UInt=S.OffsetLayout=S.GreedyCount=S.ExternalLayout=S.bindConstructorLayout=S.nameWithProperty=S.Layout=S.uint8ArrayToBuffer=S.checkUint8Array=void 0;S.constant=S.utf8=S.cstr=jt=S.blob=S.unionLayoutDiscriminator=S.union=ce=S.seq=S.bits=q=S.struct=S.f64be=S.f64=S.f32be=S.f32=S.ns64be=S.s48be=S.s40be=S.s32be=S.s24be=S.s16be=be=S.ns64=S.s48=S.s40=S.s32=S.s24=void 0;const Mi=mi;function zr(a){if(!(a instanceof Uint8Array))throw new TypeError("b must be a Uint8Array")}S.checkUint8Array=zr;function Wt(a){return zr(a),Mi.Buffer.from(a.buffer,a.byteOffset,a.length)}S.uint8ArrayToBuffer=Wt;class Vt{constructor(t,e){if(!Number.isInteger(t))throw new TypeError("span must be an integer");this.span=t,this.property=e}makeDestinationObject(){return{}}getSpan(t,e){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(t){const e=Object.create(this.constructor.prototype);return Object.assign(e,this),e.property=t,e}fromArray(t){}}S.Layout=Vt;function _i(a,t){return t.property?a+"["+t.property+"]":a}S.nameWithProperty=_i;function ra(a,t){if(typeof a!="function")throw new TypeError("Class must be constructor");if(Object.prototype.hasOwnProperty.call(a,"layout_"))throw new Error("Class is already bound to a layout");if(!(t&&t instanceof Vt))throw new TypeError("layout must be a Layout");if(Object.prototype.hasOwnProperty.call(t,"boundConstructor_"))throw new Error("layout is already bound to a constructor");a.layout_=t,t.boundConstructor_=a,t.makeDestinationObject=()=>new a,Object.defineProperty(a.prototype,"encode",{value(e,r){return t.encode(this,e,r)},writable:!0}),Object.defineProperty(a,"decode",{value(e,r){return t.decode(e,r)},writable:!0})}S.bindConstructorLayout=ra;class ve extends Vt{isCount(){throw new Error("ExternalLayout is abstract")}}S.ExternalLayout=ve;class Es extends ve{constructor(t=1,e){if(!Number.isInteger(t)||0>=t)throw new TypeError("elementSpan must be a (positive) integer");super(-1,e),this.elementSpan=t}isCount(){return!0}decode(t,e=0){zr(t);const r=t.length-e;return Math.floor(r/this.elementSpan)}encode(t,e,r){return 0}}S.GreedyCount=Es;class xi extends ve{constructor(t,e=0,r){if(!(t instanceof Vt))throw new TypeError("layout must be a Layout");if(!Number.isInteger(e))throw new TypeError("offset must be integer or undefined");super(t.span,r||t.property),this.layout=t,this.offset=e}isCount(){return this.layout instanceof _e||this.layout instanceof xe}decode(t,e=0){return this.layout.decode(t,e+this.offset)}encode(t,e,r=0){return this.layout.encode(t,e,r+this.offset)}}S.OffsetLayout=xi;class _e extends Vt{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return Wt(t).readUIntLE(e,this.span)}encode(t,e,r=0){return Wt(e).writeUIntLE(t,r,this.span),this.span}}S.UInt=_e;class xe extends Vt{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return Wt(t).readUIntBE(e,this.span)}encode(t,e,r=0){return Wt(e).writeUIntBE(t,r,this.span),this.span}}S.UIntBE=xe;class Sr extends Vt{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return Wt(t).readIntLE(e,this.span)}encode(t,e,r=0){return Wt(e).writeIntLE(t,r,this.span),this.span}}S.Int=Sr;class Kr extends Vt{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return Wt(t).readIntBE(e,this.span)}encode(t,e,r=0){return Wt(e).writeIntBE(t,r,this.span),this.span}}S.IntBE=Kr;const ui=Math.pow(2,32);function Nn(a){const t=Math.floor(a/ui),e=a-t*ui;return{hi32:t,lo32:e}}function On(a,t){return a*ui+t}class Rs extends Vt{constructor(t){super(8,t)}decode(t,e=0){const r=Wt(t),s=r.readUInt32LE(e),i=r.readUInt32LE(e+4);return On(i,s)}encode(t,e,r=0){const s=Nn(t),i=Wt(e);return i.writeUInt32LE(s.lo32,r),i.writeUInt32LE(s.hi32,r+4),8}}S.NearUInt64=Rs;class Ps extends Vt{constructor(t){super(8,t)}decode(t,e=0){const r=Wt(t),s=r.readUInt32BE(e),i=r.readUInt32BE(e+4);return On(s,i)}encode(t,e,r=0){const s=Nn(t),i=Wt(e);return i.writeUInt32BE(s.hi32,r),i.writeUInt32BE(s.lo32,r+4),8}}S.NearUInt64BE=Ps;class Ts extends Vt{constructor(t){super(8,t)}decode(t,e=0){const r=Wt(t),s=r.readUInt32LE(e),i=r.readInt32LE(e+4);return On(i,s)}encode(t,e,r=0){const s=Nn(t),i=Wt(e);return i.writeUInt32LE(s.lo32,r),i.writeInt32LE(s.hi32,r+4),8}}S.NearInt64=Ts;class Bs extends Vt{constructor(t){super(8,t)}decode(t,e=0){const r=Wt(t),s=r.readInt32BE(e),i=r.readUInt32BE(e+4);return On(s,i)}encode(t,e,r=0){const s=Nn(t),i=Wt(e);return i.writeInt32BE(s.hi32,r),i.writeUInt32BE(s.lo32,r+4),8}}S.NearInt64BE=Bs;class Ls extends Vt{constructor(t){super(4,t)}decode(t,e=0){return Wt(t).readFloatLE(e)}encode(t,e,r=0){return Wt(e).writeFloatLE(t,r),4}}S.Float=Ls;class Cs extends Vt{constructor(t){super(4,t)}decode(t,e=0){return Wt(t).readFloatBE(e)}encode(t,e,r=0){return Wt(e).writeFloatBE(t,r),4}}S.FloatBE=Cs;class Ns extends Vt{constructor(t){super(8,t)}decode(t,e=0){return Wt(t).readDoubleLE(e)}encode(t,e,r=0){return Wt(e).writeDoubleLE(t,r),8}}S.Double=Ns;class Os extends Vt{constructor(t){super(8,t)}decode(t,e=0){return Wt(t).readDoubleBE(e)}encode(t,e,r=0){return Wt(e).writeDoubleBE(t,r),8}}S.DoubleBE=Os;class zs extends Vt{constructor(t,e,r){if(!(t instanceof Vt))throw new TypeError("elementLayout must be a Layout");if(!(e instanceof ve&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");let s=-1;!(e instanceof ve)&&0<t.span&&(s=e*t.span),super(s,r),this.elementLayout=t,this.count=e}getSpan(t,e=0){if(0<=this.span)return this.span;let r=0,s=this.count;if(s instanceof ve&&(s=s.decode(t,e)),0<this.elementLayout.span)r=s*this.elementLayout.span;else{let i=0;for(;i<s;)r+=this.elementLayout.getSpan(t,e+r),++i}return r}decode(t,e=0){const r=[];let s=0,i=this.count;for(i instanceof ve&&(i=i.decode(t,e));s<i;)r.push(this.elementLayout.decode(t,e)),e+=this.elementLayout.getSpan(t,e),s+=1;return r}encode(t,e,r=0){const s=this.elementLayout,i=t.reduce((u,m)=>u+s.encode(m,e,r+u),0);return this.count instanceof ve&&this.count.encode(t.length,e,r),i}}S.Sequence=zs;class Ks extends Vt{constructor(t,e,r){if(!(Array.isArray(t)&&t.reduce((i,u)=>i&&u instanceof Vt,!0)))throw new TypeError("fields must be array of Layout instances");typeof e=="boolean"&&r===void 0&&(r=e,e=void 0);for(const i of t)if(0>i.span&&i.property===void 0)throw new Error("fields cannot contain unnamed variable-length layout");let s=-1;try{s=t.reduce((i,u)=>i+u.getSpan(),0)}catch{}super(s,e),this.fields=t,this.decodePrefixes=!!r}getSpan(t,e=0){if(0<=this.span)return this.span;let r=0;try{r=this.fields.reduce((s,i)=>{const u=i.getSpan(t,e);return e+=u,s+u},0)}catch{throw new RangeError("indeterminate span")}return r}decode(t,e=0){zr(t);const r=this.makeDestinationObject();for(const s of this.fields)if(s.property!==void 0&&(r[s.property]=s.decode(t,e)),e+=s.getSpan(t,e),this.decodePrefixes&&t.length===e)break;return r}encode(t,e,r=0){const s=r;let i=0,u=0;for(const m of this.fields){let w=m.span;if(u=0<w?w:0,m.property!==void 0){const b=t[m.property];b!==void 0&&(u=m.encode(b,e,r),0>w&&(w=m.getSpan(e,r)))}i=r,r+=w}return i+u-s}fromArray(t){const e=this.makeDestinationObject();for(const r of this.fields)r.property!==void 0&&0<t.length&&(e[r.property]=t.shift());return e}layoutFor(t){if(typeof t!="string")throw new TypeError("property must be string");for(const e of this.fields)if(e.property===t)return e}offsetOf(t){if(typeof t!="string")throw new TypeError("property must be string");let e=0;for(const r of this.fields){if(r.property===t)return e;0>r.span?e=-1:0<=e&&(e+=r.span)}}}S.Structure=Ks;class Ii{constructor(t){this.property=t}decode(t,e){throw new Error("UnionDiscriminator is abstract")}encode(t,e,r){throw new Error("UnionDiscriminator is abstract")}}S.UnionDiscriminator=Ii;class Pn extends Ii{constructor(t,e){if(!(t instanceof ve&&t.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(e||t.property||"variant"),this.layout=t}decode(t,e){return this.layout.decode(t,e)}encode(t,e,r){return this.layout.encode(t,e,r)}}S.UnionLayoutDiscriminator=Pn;class Ai extends Vt{constructor(t,e,r){let s;if(t instanceof _e||t instanceof xe)s=new Pn(new xi(t));else if(t instanceof ve&&t.isCount())s=new Pn(t);else if(t instanceof Ii)s=t;else throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");if(e===void 0&&(e=null),!(e===null||e instanceof Vt))throw new TypeError("defaultLayout must be null or a Layout");if(e!==null){if(0>e.span)throw new Error("defaultLayout must have constant span");e.property===void 0&&(e=e.replicate("content"))}let i=-1;e&&(i=e.span,0<=i&&(t instanceof _e||t instanceof xe)&&(i+=s.layout.span)),super(i,r),this.discriminator=s,this.usesPrefixDiscriminator=t instanceof _e||t instanceof xe,this.defaultLayout=e,this.registry={};let u=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(m){return u(m)},this.configGetSourceVariant=function(m){u=m.bind(this)}}getSpan(t,e=0){if(0<=this.span)return this.span;const r=this.getVariant(t,e);if(!r)throw new Error("unable to determine span for unrecognized variant");return r.getSpan(t,e)}defaultGetSourceVariant(t){if(Object.prototype.hasOwnProperty.call(t,this.discriminator.property)){if(this.defaultLayout&&this.defaultLayout.property&&Object.prototype.hasOwnProperty.call(t,this.defaultLayout.property))return;const e=this.registry[t[this.discriminator.property]];if(e&&(!e.layout||e.property&&Object.prototype.hasOwnProperty.call(t,e.property)))return e}else for(const e in this.registry){const r=this.registry[e];if(r.property&&Object.prototype.hasOwnProperty.call(t,r.property))return r}throw new Error("unable to infer src variant")}decode(t,e=0){let r;const s=this.discriminator,i=s.decode(t,e),u=this.registry[i];if(u===void 0){const m=this.defaultLayout;let w=0;this.usesPrefixDiscriminator&&(w=s.layout.span),r=this.makeDestinationObject(),r[s.property]=i,r[m.property]=m.decode(t,e+w)}else r=u.decode(t,e);return r}encode(t,e,r=0){const s=this.getSourceVariant(t);if(s===void 0){const i=this.discriminator,u=this.defaultLayout;let m=0;return this.usesPrefixDiscriminator&&(m=i.layout.span),i.encode(t[i.property],e,r),m+u.encode(t[u.property],e,r+m)}return s.encode(t,e,r)}addVariant(t,e,r){const s=new Us(this,t,e,r);return this.registry[t]=s,s}getVariant(t,e=0){let r;return t instanceof Uint8Array?r=this.discriminator.decode(t,e):r=t,this.registry[r]}}S.Union=Ai;class Us extends Vt{constructor(t,e,r,s){if(!(t instanceof Ai))throw new TypeError("union must be a Union");if(!Number.isInteger(e)||0>e)throw new TypeError("variant must be a (non-negative) integer");if(typeof r=="string"&&s===void 0&&(s=r,r=null),r){if(!(r instanceof Vt))throw new TypeError("layout must be a Layout");if(t.defaultLayout!==null&&0<=r.span&&r.span>t.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if(typeof s!="string")throw new TypeError("variant must have a String property")}let i=t.span;0>t.span&&(i=r?r.span:0,0<=i&&t.usesPrefixDiscriminator&&(i+=t.discriminator.layout.span)),super(i,s),this.union=t,this.variant=e,this.layout=r||null}getSpan(t,e=0){if(0<=this.span)return this.span;let r=0;this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span);let s=0;return this.layout&&(s=this.layout.getSpan(t,e+r)),r+s}decode(t,e=0){const r=this.makeDestinationObject();if(this!==this.union.getVariant(t,e))throw new Error("variant mismatch");let s=0;return this.union.usesPrefixDiscriminator&&(s=this.union.discriminator.layout.span),this.layout?r[this.property]=this.layout.decode(t,e+s):this.property?r[this.property]=!0:this.union.usesPrefixDiscriminator&&(r[this.union.discriminator.property]=this.variant),r}encode(t,e,r=0){let s=0;if(this.union.usesPrefixDiscriminator&&(s=this.union.discriminator.layout.span),this.layout&&!Object.prototype.hasOwnProperty.call(t,this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,e,r);let i=s;if(this.layout&&(this.layout.encode(t[this.property],e,r+s),i+=this.layout.getSpan(e,r+s),0<=this.union.span&&i>this.union.span))throw new Error("encoded variant overruns containing union");return i}fromArray(t){if(this.layout)return this.layout.fromArray(t)}}S.VariantLayout=Us;function Ar(a){return 0>a&&(a+=4294967296),a}class Ei extends Vt{constructor(t,e,r){if(!(t instanceof _e||t instanceof xe))throw new TypeError("word must be a UInt or UIntBE layout");if(typeof e=="string"&&r===void 0&&(r=e,e=!1),4<t.span)throw new RangeError("word cannot exceed 32 bits");super(t.span,r),this.word=t,this.msb=!!e,this.fields=[];let s=0;this._packedSetValue=function(i){return s=Ar(i),this},this._packedGetValue=function(){return s}}decode(t,e=0){const r=this.makeDestinationObject(),s=this.word.decode(t,e);this._packedSetValue(s);for(const i of this.fields)i.property!==void 0&&(r[i.property]=i.decode(t));return r}encode(t,e,r=0){const s=this.word.decode(e,r);this._packedSetValue(s);for(const i of this.fields)if(i.property!==void 0){const u=t[i.property];u!==void 0&&i.encode(u)}return this.word.encode(this._packedGetValue(),e,r)}addField(t,e){const r=new Ri(this,t,e);return this.fields.push(r),r}addBoolean(t){const e=new Ws(this,t);return this.fields.push(e),e}fieldFor(t){if(typeof t!="string")throw new TypeError("property must be string");for(const e of this.fields)if(e.property===t)return e}}S.BitStructure=Ei;class Ri{constructor(t,e,r){if(!(t instanceof Ei))throw new TypeError("container must be a BitStructure");if(!Number.isInteger(e)||0>=e)throw new TypeError("bits must be positive integer");const s=8*t.span,i=t.fields.reduce((u,m)=>u+m.bits,0);if(e+i>s)throw new Error("bits too long for span remainder ("+(s-i)+" of "+s+" remain)");this.container=t,this.bits=e,this.valueMask=(1<<e)-1,e===32&&(this.valueMask=4294967295),this.start=i,this.container.msb&&(this.start=s-i-e),this.wordMask=Ar(this.valueMask<<this.start),this.property=r}decode(t,e){const r=this.container._packedGetValue();return Ar(r&this.wordMask)>>>this.start}encode(t){if(typeof t!="number"||!Number.isInteger(t)||t!==Ar(t&this.valueMask))throw new TypeError(_i("BitField.encode",this)+" value must be integer not exceeding "+this.valueMask);const e=this.container._packedGetValue(),r=Ar(t<<this.start);this.container._packedSetValue(Ar(e&~this.wordMask)|r)}}S.BitField=Ri;let Ws=class extends Ri{constructor(t,e){super(t,1,e)}decode(t,e){return!!super.decode(t,e)}encode(t){typeof t=="boolean"&&(t=+t),super.encode(t)}};S.Boolean=Ws;class qs extends Vt{constructor(t,e){if(!(t instanceof ve&&t.isCount()||Number.isInteger(t)&&0<=t))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let r=-1;t instanceof ve||(r=t),super(r,e),this.length=t}getSpan(t,e){let r=this.span;return 0>r&&(r=this.length.decode(t,e)),r}decode(t,e=0){let r=this.span;return 0>r&&(r=this.length.decode(t,e)),Wt(t).slice(e,e+r)}encode(t,e,r){let s=this.length;if(this.length instanceof ve&&(s=t.length),!(t instanceof Uint8Array&&s===t.length))throw new TypeError(_i("Blob.encode",this)+" requires (length "+s+") Uint8Array as src");if(r+s>e.length)throw new RangeError("encoding overruns Uint8Array");const i=Wt(t);return Wt(e).write(i.toString("hex"),r,s,"hex"),this.length instanceof ve&&this.length.encode(s,e,r),s}}S.Blob=qs;class Fs extends Vt{constructor(t){super(-1,t)}getSpan(t,e=0){zr(t);let r=e;for(;r<t.length&&t[r]!==0;)r+=1;return 1+r-e}decode(t,e=0){const r=this.getSpan(t,e);return Wt(t).slice(e,e+r-1).toString("utf-8")}encode(t,e,r=0){typeof t!="string"&&(t=String(t));const s=Mi.Buffer.from(t,"utf8"),i=s.length;if(r+i>e.length)throw new RangeError("encoding overruns Buffer");const u=Wt(e);return s.copy(u,r),u[r+i]=0,i+1}}S.CString=Fs;class Ds extends Vt{constructor(t,e){if(typeof t=="string"&&e===void 0&&(e=t,t=void 0),t===void 0)t=-1;else if(!Number.isInteger(t))throw new TypeError("maxSpan must be an integer");super(-1,e),this.maxSpan=t}getSpan(t,e=0){return zr(t),t.length-e}decode(t,e=0){const r=this.getSpan(t,e);if(0<=this.maxSpan&&this.maxSpan<r)throw new RangeError("text length exceeds maxSpan");return Wt(t).slice(e,e+r).toString("utf-8")}encode(t,e,r=0){typeof t!="string"&&(t=String(t));const s=Mi.Buffer.from(t,"utf8"),i=s.length;if(0<=this.maxSpan&&this.maxSpan<i)throw new RangeError("text length exceeds maxSpan");if(r+i>e.length)throw new RangeError("encoding overruns Buffer");return s.copy(Wt(e),r),i}}S.UTF8=Ds;class Vs extends Vt{constructor(t,e){super(0,e),this.value=t}decode(t,e){return this.value}encode(t,e,r){return 0}}S.Constant=Vs;S.greedy=(a,t)=>new Es(a,t);var He=S.offset=(a,t,e)=>new xi(a,t,e),Kt=S.u8=a=>new _e(1,a),Me=S.u16=a=>new _e(2,a);S.u24=a=>new _e(3,a);var W=S.u32=a=>new _e(4,a);S.u40=a=>new _e(5,a);S.u48=a=>new _e(6,a);var se=S.nu64=a=>new Rs(a);S.u16be=a=>new xe(2,a);S.u24be=a=>new xe(3,a);S.u32be=a=>new xe(4,a);S.u40be=a=>new xe(5,a);S.u48be=a=>new xe(6,a);S.nu64be=a=>new Ps(a);S.s8=a=>new Sr(1,a);S.s16=a=>new Sr(2,a);S.s24=a=>new Sr(3,a);S.s32=a=>new Sr(4,a);S.s40=a=>new Sr(5,a);S.s48=a=>new Sr(6,a);var be=S.ns64=a=>new Ts(a);S.s16be=a=>new Kr(2,a);S.s24be=a=>new Kr(3,a);S.s32be=a=>new Kr(4,a);S.s40be=a=>new Kr(5,a);S.s48be=a=>new Kr(6,a);S.ns64be=a=>new Bs(a);S.f32=a=>new Ls(a);S.f32be=a=>new Cs(a);S.f64=a=>new Ns(a);S.f64be=a=>new Os(a);var q=S.struct=(a,t,e)=>new Ks(a,t,e);S.bits=(a,t,e)=>new Ei(a,t,e);var ce=S.seq=(a,t,e)=>new zs(a,t,e);S.union=(a,t,e)=>new Ai(a,t,e);S.unionLayoutDiscriminator=(a,t)=>new Pn(a,t);var jt=S.blob=(a,t)=>new qs(a,t);S.cstr=a=>new Fs(a);S.utf8=(a,t)=>new Ds(a,t);S.constant=(a,t)=>new Vs(a,t);var mn={};Object.defineProperty(mn,"__esModule",{value:!0});function na(a){{const t=re.from(a);t.reverse();const e=t.toString("hex");return e.length===0?BigInt(0):BigInt(`0x${e}`)}}var ia=mn.toBigIntLE=na;function sa(a){{const t=a.toString("hex");return t.length===0?BigInt(0):BigInt(`0x${t}`)}}mn.toBigIntBE=sa;function oa(a,t){{const e=a.toString(16),r=re.from(e.padStart(t*2,"0").slice(0,t*2),"hex");return r.reverse(),r}}var $s=mn.toBufferLE=oa;function aa(a,t){{const e=a.toString(16);return re.from(e.padStart(t*2,"0").slice(0,t*2),"hex")}}mn.toBufferBE=aa;class ca extends TypeError{constructor(t,e){let r;const{message:s,explanation:i,...u}=t,{path:m}=t,w=m.length===0?s:`At path: ${m.join(".")} -- ${s}`;super(i??w),i!=null&&(this.cause=w),Object.assign(this,u),this.name=this.constructor.name,this.failures=()=>r??(r=[t,...e()])}}function ua(a){return yn(a)&&typeof a[Symbol.iterator]=="function"}function yn(a){return typeof a=="object"&&a!=null}function Tn(a){return yn(a)&&!Array.isArray(a)}function Ie(a){return typeof a=="symbol"?a.toString():typeof a=="string"?JSON.stringify(a):`${a}`}function ha(a){const{done:t,value:e}=a.next();return t?void 0:e}function la(a,t,e,r){if(a===!0)return;a===!1?a={}:typeof a=="string"&&(a={message:a});const{path:s,branch:i}=t,{type:u}=e,{refinement:m,message:w=`Expected a value of type \`${u}\`${m?` with refinement \`${m}\``:""}, but received: \`${Ie(r)}\``}=a;return{value:r,type:u,refinement:m,key:s[s.length-1],path:s,branch:i,...a,message:w}}function*Yi(a,t,e,r){ua(a)||(a=[a]);for(const s of a){const i=la(s,t,e,r);i&&(yield i)}}function*Pi(a,t,e={}){const{path:r=[],branch:s=[a],coerce:i=!1,mask:u=!1}=e,m={path:r,branch:s,mask:u};i&&(a=t.coercer(a,m));let w="valid";for(const b of t.validator(a,m))b.explanation=e.message,w="not_valid",yield[b,void 0];for(let[b,M,x]of t.entries(a,m)){const L=Pi(M,x,{path:b===void 0?r:[...r,b],branch:b===void 0?s:[...s,M],coerce:i,mask:u,message:e.message});for(const _ of L)_[0]?(w=_[0].refinement!=null?"not_refined":"not_valid",yield[_[0],void 0]):i&&(M=_[1],b===void 0?a=M:a instanceof Map?a.set(b,M):a instanceof Set?a.add(M):yn(a)&&(M!==void 0||b in a)&&(a[b]=M))}if(w!=="not_valid")for(const b of t.refiner(a,m))b.explanation=e.message,w="not_refined",yield[b,void 0];w==="valid"&&(yield[void 0,a])}let Ke=class{constructor(t){const{type:e,schema:r,validator:s,refiner:i,coercer:u=w=>w,entries:m=function*(){}}=t;this.type=e,this.schema=r,this.entries=m,this.coercer=u,s?this.validator=(w,b)=>{const M=s(w,b);return Yi(M,b,this,w)}:this.validator=()=>[],i?this.refiner=(w,b)=>{const M=i(w,b);return Yi(M,b,this,w)}:this.refiner=()=>[]}assert(t,e){return Hs(t,this,e)}create(t,e){return O(t,this,e)}is(t){return Gs(t,this)}mask(t,e){return fa(t,this,e)}validate(t,e={}){return wn(t,this,e)}};function Hs(a,t,e){const r=wn(a,t,{message:e});if(r[0])throw r[0]}function O(a,t,e){const r=wn(a,t,{coerce:!0,message:e});if(r[0])throw r[0];return r[1]}function fa(a,t,e){const r=wn(a,t,{coerce:!0,mask:!0,message:e});if(r[0])throw r[0];return r[1]}function Gs(a,t){return!wn(a,t)[0]}function wn(a,t,e={}){const r=Pi(a,t,e),s=ha(r);return s[0]?[new ca(s[0],function*(){for(const u of r)u[0]&&(yield u[0])}),void 0]:[void 0,s[1]]}function Mr(a,t){return new Ke({type:a,schema:null,validator:t})}function da(){return Mr("any",()=>!0)}function z(a){return new Ke({type:"array",schema:a,*entries(t){if(a&&Array.isArray(t))for(const[e,r]of t.entries())yield[e,r,a]},coercer(t){return Array.isArray(t)?t.slice():t},validator(t){return Array.isArray(t)||`Expected an array value, but received: ${Ie(t)}`}})}function Ne(){return Mr("boolean",a=>typeof a=="boolean")}function Ti(a){return Mr("instance",t=>t instanceof a||`Expected a \`${a.name}\` instance, but received: ${Ie(t)}`)}function Zt(a){const t=Ie(a),e=typeof a;return new Ke({type:"literal",schema:e==="string"||e==="number"||e==="boolean"?a:null,validator(r){return r===a||`Expected the literal \`${t}\`, but received: ${Ie(r)}`}})}function pa(){return Mr("never",()=>!1)}function K(a){return new Ke({...a,validator:(t,e)=>t===null||a.validator(t,e),refiner:(t,e)=>t===null||a.refiner(t,e)})}function k(){return Mr("number",a=>typeof a=="number"&&!isNaN(a)||`Expected a number, but received: ${Ie(a)}`)}function D(a){return new Ke({...a,validator:(t,e)=>t===void 0||a.validator(t,e),refiner:(t,e)=>t===void 0||a.refiner(t,e)})}function js(a,t){return new Ke({type:"record",schema:null,*entries(e){if(yn(e))for(const r in e){const s=e[r];yield[r,r,a],yield[r,s,t]}},validator(e){return Tn(e)||`Expected an object, but received: ${Ie(e)}`},coercer(e){return Tn(e)?{...e}:e}})}function B(){return Mr("string",a=>typeof a=="string"||`Expected a string, but received: ${Ie(a)}`)}function Bi(a){const t=pa();return new Ke({type:"tuple",schema:null,*entries(e){if(Array.isArray(e)){const r=Math.max(a.length,e.length);for(let s=0;s<r;s++)yield[s,e[s],a[s]||t]}},validator(e){return Array.isArray(e)||`Expected an array, but received: ${Ie(e)}`},coercer(e){return Array.isArray(e)?e.slice():e}})}function I(a){const t=Object.keys(a);return new Ke({type:"type",schema:a,*entries(e){if(yn(e))for(const r of t)yield[r,e[r],a[r]]},validator(e){return Tn(e)||`Expected an object, but received: ${Ie(e)}`},coercer(e){return Tn(e)?{...e}:e}})}function me(a){const t=a.map(e=>e.type).join(" | ");return new Ke({type:"union",schema:null,coercer(e,r){for(const s of a){const[i,u]=s.validate(e,{coerce:!0,mask:r.mask});if(!i)return u}return e},validator(e,r){const s=[];for(const i of a){const[...u]=Pi(e,i,r),[m]=u;if(m[0])for(const[w]of u)w&&s.push(w);else return[]}return[`Expected the value to satisfy a union of \`${t}\`, but received: ${Ie(e)}`,...s]}})}function Ur(){return Mr("unknown",()=>!0)}function vn(a,t,e){return new Ke({...a,coercer:(r,s)=>Gs(r,t)?a.coercer(e(r,s),s):a.coercer(r,s)})}var kn,ga=new Uint8Array(16);function Js(){if(!kn&&(kn=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!kn))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return kn(ga)}const ma=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function zn(a){return typeof a=="string"&&ma.test(a)}var ie=[];for(var Xn=0;Xn<256;++Xn)ie.push((Xn+256).toString(16).substr(1));function Kn(a){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=(ie[a[t+0]]+ie[a[t+1]]+ie[a[t+2]]+ie[a[t+3]]+"-"+ie[a[t+4]]+ie[a[t+5]]+"-"+ie[a[t+6]]+ie[a[t+7]]+"-"+ie[a[t+8]]+ie[a[t+9]]+"-"+ie[a[t+10]]+ie[a[t+11]]+ie[a[t+12]]+ie[a[t+13]]+ie[a[t+14]]+ie[a[t+15]]).toLowerCase();if(!zn(e))throw TypeError("Stringified UUID is invalid");return e}var Xi,Qn,ti=0,ei=0;function ya(a,t,e){var r=t&&e||0,s=t||new Array(16);a=a||{};var i=a.node||Xi,u=a.clockseq!==void 0?a.clockseq:Qn;if(i==null||u==null){var m=a.random||(a.rng||Js)();i==null&&(i=Xi=[m[0]|1,m[1],m[2],m[3],m[4],m[5]]),u==null&&(u=Qn=(m[6]<<8|m[7])&16383)}var w=a.msecs!==void 0?a.msecs:Date.now(),b=a.nsecs!==void 0?a.nsecs:ei+1,M=w-ti+(b-ei)/1e4;if(M<0&&a.clockseq===void 0&&(u=u+1&16383),(M<0||w>ti)&&a.nsecs===void 0&&(b=0),b>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");ti=w,ei=b,Qn=u,w+=122192928e5;var x=((w&268435455)*1e4+b)%4294967296;s[r++]=x>>>24&255,s[r++]=x>>>16&255,s[r++]=x>>>8&255,s[r++]=x&255;var L=w/4294967296*1e4&268435455;s[r++]=L>>>8&255,s[r++]=L&255,s[r++]=L>>>24&15|16,s[r++]=L>>>16&255,s[r++]=u>>>8|128,s[r++]=u&255;for(var _=0;_<6;++_)s[r+_]=i[_];return t||Kn(s)}function Zs(a){if(!zn(a))throw TypeError("Invalid UUID");var t,e=new Uint8Array(16);return e[0]=(t=parseInt(a.slice(0,8),16))>>>24,e[1]=t>>>16&255,e[2]=t>>>8&255,e[3]=t&255,e[4]=(t=parseInt(a.slice(9,13),16))>>>8,e[5]=t&255,e[6]=(t=parseInt(a.slice(14,18),16))>>>8,e[7]=t&255,e[8]=(t=parseInt(a.slice(19,23),16))>>>8,e[9]=t&255,e[10]=(t=parseInt(a.slice(24,36),16))/1099511627776&255,e[11]=t/4294967296&255,e[12]=t>>>24&255,e[13]=t>>>16&255,e[14]=t>>>8&255,e[15]=t&255,e}function wa(a){a=unescape(encodeURIComponent(a));for(var t=[],e=0;e<a.length;++e)t.push(a.charCodeAt(e));return t}var va="6ba7b810-9dad-11d1-80b4-00c04fd430c8",ba="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function Ys(a,t,e){function r(s,i,u,m){if(typeof s=="string"&&(s=wa(s)),typeof i=="string"&&(i=Zs(i)),i.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var w=new Uint8Array(16+s.length);if(w.set(i),w.set(s,i.length),w=e(w),w[6]=w[6]&15|t,w[8]=w[8]&63|128,u){m=m||0;for(var b=0;b<16;++b)u[m+b]=w[b];return u}return Kn(w)}try{r.name=a}catch{}return r.DNS=va,r.URL=ba,r}function ka(a){if(typeof a=="string"){var t=unescape(encodeURIComponent(a));a=new Uint8Array(t.length);for(var e=0;e<t.length;++e)a[e]=t.charCodeAt(e)}return Sa(Ma(_a(a),a.length*8))}function Sa(a){for(var t=[],e=a.length*32,r="0123456789abcdef",s=0;s<e;s+=8){var i=a[s>>5]>>>s%32&255,u=parseInt(r.charAt(i>>>4&15)+r.charAt(i&15),16);t.push(u)}return t}function Xs(a){return(a+64>>>9<<4)+14+1}function Ma(a,t){a[t>>5]|=128<<t%32,a[Xs(t)-1]=t;for(var e=1732584193,r=-271733879,s=-1732584194,i=271733878,u=0;u<a.length;u+=16){var m=e,w=r,b=s,M=i;e=ue(e,r,s,i,a[u],7,-680876936),i=ue(i,e,r,s,a[u+1],12,-389564586),s=ue(s,i,e,r,a[u+2],17,606105819),r=ue(r,s,i,e,a[u+3],22,-1044525330),e=ue(e,r,s,i,a[u+4],7,-176418897),i=ue(i,e,r,s,a[u+5],12,1200080426),s=ue(s,i,e,r,a[u+6],17,-1473231341),r=ue(r,s,i,e,a[u+7],22,-45705983),e=ue(e,r,s,i,a[u+8],7,1770035416),i=ue(i,e,r,s,a[u+9],12,-1958414417),s=ue(s,i,e,r,a[u+10],17,-42063),r=ue(r,s,i,e,a[u+11],22,-1990404162),e=ue(e,r,s,i,a[u+12],7,1804603682),i=ue(i,e,r,s,a[u+13],12,-40341101),s=ue(s,i,e,r,a[u+14],17,-1502002290),r=ue(r,s,i,e,a[u+15],22,1236535329),e=he(e,r,s,i,a[u+1],5,-165796510),i=he(i,e,r,s,a[u+6],9,-1069501632),s=he(s,i,e,r,a[u+11],14,643717713),r=he(r,s,i,e,a[u],20,-373897302),e=he(e,r,s,i,a[u+5],5,-701558691),i=he(i,e,r,s,a[u+10],9,38016083),s=he(s,i,e,r,a[u+15],14,-660478335),r=he(r,s,i,e,a[u+4],20,-405537848),e=he(e,r,s,i,a[u+9],5,568446438),i=he(i,e,r,s,a[u+14],9,-1019803690),s=he(s,i,e,r,a[u+3],14,-187363961),r=he(r,s,i,e,a[u+8],20,1163531501),e=he(e,r,s,i,a[u+13],5,-1444681467),i=he(i,e,r,s,a[u+2],9,-51403784),s=he(s,i,e,r,a[u+7],14,1735328473),r=he(r,s,i,e,a[u+12],20,-1926607734),e=le(e,r,s,i,a[u+5],4,-378558),i=le(i,e,r,s,a[u+8],11,-2022574463),s=le(s,i,e,r,a[u+11],16,1839030562),r=le(r,s,i,e,a[u+14],23,-35309556),e=le(e,r,s,i,a[u+1],4,-1530992060),i=le(i,e,r,s,a[u+4],11,1272893353),s=le(s,i,e,r,a[u+7],16,-155497632),r=le(r,s,i,e,a[u+10],23,-1094730640),e=le(e,r,s,i,a[u+13],4,681279174),i=le(i,e,r,s,a[u],11,-358537222),s=le(s,i,e,r,a[u+3],16,-722521979),r=le(r,s,i,e,a[u+6],23,76029189),e=le(e,r,s,i,a[u+9],4,-640364487),i=le(i,e,r,s,a[u+12],11,-421815835),s=le(s,i,e,r,a[u+15],16,530742520),r=le(r,s,i,e,a[u+2],23,-995338651),e=fe(e,r,s,i,a[u],6,-198630844),i=fe(i,e,r,s,a[u+7],10,1126891415),s=fe(s,i,e,r,a[u+14],15,-1416354905),r=fe(r,s,i,e,a[u+5],21,-57434055),e=fe(e,r,s,i,a[u+12],6,1700485571),i=fe(i,e,r,s,a[u+3],10,-1894986606),s=fe(s,i,e,r,a[u+10],15,-1051523),r=fe(r,s,i,e,a[u+1],21,-2054922799),e=fe(e,r,s,i,a[u+8],6,1873313359),i=fe(i,e,r,s,a[u+15],10,-30611744),s=fe(s,i,e,r,a[u+6],15,-1560198380),r=fe(r,s,i,e,a[u+13],21,1309151649),e=fe(e,r,s,i,a[u+4],6,-145523070),i=fe(i,e,r,s,a[u+11],10,-1120210379),s=fe(s,i,e,r,a[u+2],15,718787259),r=fe(r,s,i,e,a[u+9],21,-343485551),e=$e(e,m),r=$e(r,w),s=$e(s,b),i=$e(i,M)}return[e,r,s,i]}function _a(a){if(a.length===0)return[];for(var t=a.length*8,e=new Uint32Array(Xs(t)),r=0;r<t;r+=8)e[r>>5]|=(a[r/8]&255)<<r%32;return e}function $e(a,t){var e=(a&65535)+(t&65535),r=(a>>16)+(t>>16)+(e>>16);return r<<16|e&65535}function xa(a,t){return a<<t|a>>>32-t}function Un(a,t,e,r,s,i){return $e(xa($e($e(t,a),$e(r,i)),s),e)}function ue(a,t,e,r,s,i,u){return Un(t&e|~t&r,a,t,s,i,u)}function he(a,t,e,r,s,i,u){return Un(t&r|e&~r,a,t,s,i,u)}function le(a,t,e,r,s,i,u){return Un(t^e^r,a,t,s,i,u)}function fe(a,t,e,r,s,i,u){return Un(e^(t|~r),a,t,s,i,u)}var Ia=Ys("v3",48,ka);function Aa(a,t,e){a=a||{};var r=a.random||(a.rng||Js)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){e=e||0;for(var s=0;s<16;++s)t[e+s]=r[s];return t}return Kn(r)}function Ea(a,t,e,r){switch(a){case 0:return t&e^~t&r;case 1:return t^e^r;case 2:return t&e^t&r^e&r;case 3:return t^e^r}}function ri(a,t){return a<<t|a>>>32-t}function Ra(a){var t=[1518500249,1859775393,2400959708,3395469782],e=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof a=="string"){var r=unescape(encodeURIComponent(a));a=[];for(var s=0;s<r.length;++s)a.push(r.charCodeAt(s))}else Array.isArray(a)||(a=Array.prototype.slice.call(a));a.push(128);for(var i=a.length/4+2,u=Math.ceil(i/16),m=new Array(u),w=0;w<u;++w){for(var b=new Uint32Array(16),M=0;M<16;++M)b[M]=a[w*64+M*4]<<24|a[w*64+M*4+1]<<16|a[w*64+M*4+2]<<8|a[w*64+M*4+3];m[w]=b}m[u-1][14]=(a.length-1)*8/Math.pow(2,32),m[u-1][14]=Math.floor(m[u-1][14]),m[u-1][15]=(a.length-1)*8&4294967295;for(var x=0;x<u;++x){for(var L=new Uint32Array(80),_=0;_<16;++_)L[_]=m[x][_];for(var E=16;E<80;++E)L[E]=ri(L[E-3]^L[E-8]^L[E-14]^L[E-16],1);for(var A=e[0],N=e[1],U=e[2],G=e[3],qt=e[4],Ft=0;Ft<80;++Ft){var Qt=Math.floor(Ft/20),Lt=ri(A,5)+Ea(Qt,N,U,G)+qt+t[Qt]+L[Ft]>>>0;qt=G,G=U,U=ri(N,30)>>>0,N=A,A=Lt}e[0]=e[0]+A>>>0,e[1]=e[1]+N>>>0,e[2]=e[2]+U>>>0,e[3]=e[3]+G>>>0,e[4]=e[4]+qt>>>0}return[e[0]>>24&255,e[0]>>16&255,e[0]>>8&255,e[0]&255,e[1]>>24&255,e[1]>>16&255,e[1]>>8&255,e[1]&255,e[2]>>24&255,e[2]>>16&255,e[2]>>8&255,e[2]&255,e[3]>>24&255,e[3]>>16&255,e[3]>>8&255,e[3]&255,e[4]>>24&255,e[4]>>16&255,e[4]>>8&255,e[4]&255]}var Pa=Ys("v5",80,Ra);const Ta="00000000-0000-0000-0000-000000000000";function Ba(a){if(!zn(a))throw TypeError("Invalid UUID");return parseInt(a.substr(14,1),16)}const La=Object.freeze(Object.defineProperty({__proto__:null,NIL:Ta,parse:Zs,stringify:Kn,v1:ya,v3:Ia,v4:Aa,v5:Pa,validate:zn,version:Ba},Symbol.toStringTag,{value:"Module"})),Qs=yi(La),Ca=Qs.v4,Na=function(a,t,e,r){if(typeof a!="string")throw new TypeError(a+" must be a string");r=r||{};const s=typeof r.version=="number"?r.version:2;if(s!==1&&s!==2)throw new TypeError(s+" must be 1 or 2");const i={method:a};if(s===2&&(i.jsonrpc="2.0"),t){if(typeof t!="object"&&!Array.isArray(t))throw new TypeError(t+" must be an object, array or omitted");i.params=t}if(typeof e>"u"){const u=typeof r.generator=="function"?r.generator:function(){return Ca()};i.id=u(i,r)}else s===2&&e===null?r.notificationIdNull&&(i.id=null):i.id=e;return i};var Oa=Na;const za=Qs.v4,Ka=Oa,hn=function(a,t){if(!(this instanceof hn))return new hn(a,t);t||(t={}),this.options={reviver:typeof t.reviver<"u"?t.reviver:null,replacer:typeof t.replacer<"u"?t.replacer:null,generator:typeof t.generator<"u"?t.generator:function(){return za()},version:typeof t.version<"u"?t.version:2,notificationIdNull:typeof t.notificationIdNull=="boolean"?t.notificationIdNull:!1},this.callServer=a};var Ua=hn;hn.prototype.request=function(a,t,e,r){const s=this;let i=null;const u=Array.isArray(a)&&typeof t=="function";if(this.options.version===1&&u)throw new TypeError("JSON-RPC 1.0 does not support batching");if(u||!u&&a&&typeof a=="object"&&typeof t=="function")r=t,i=a;else{typeof e=="function"&&(r=e,e=void 0);const b=typeof r=="function";try{i=Ka(a,t,e,{generator:this.options.generator,version:this.options.version,notificationIdNull:this.options.notificationIdNull})}catch(M){if(b)return r(M);throw M}if(!b)return i}let w;try{w=JSON.stringify(i,this.options.replacer)}catch(b){return r(b)}return this.callServer(w,function(b,M){s._parseResponse(b,M,r)}),i};hn.prototype._parseResponse=function(a,t,e){if(a){e(a);return}if(!t)return e();let r;try{r=JSON.parse(t,this.options.reviver)}catch(s){return e(s)}if(e.length===3)if(Array.isArray(r)){const s=function(u){return typeof u.error<"u"},i=function(u){return!s(u)};return e(null,r.filter(s),r.filter(i))}else return e(null,r.error,r.result);e(null,r)};const Wa=ws(Ua);var qa=class extends ys.EventEmitter{constructor(t,e,r){super();ee(this,"socket");this.socket=new window.WebSocket(t,r),this.socket.onopen=()=>this.emit("open"),this.socket.onmessage=s=>this.emit("message",s.data),this.socket.onerror=s=>this.emit("error",s),this.socket.onclose=s=>{this.emit("close",s.code,s.reason)}}send(t,e,r){const s=r||e;try{this.socket.send(t),s()}catch(i){s(i)}}close(t,e){this.socket.close(t,e)}addEventListener(t,e,r){this.socket.addEventListener(t,e,r)}};function Fa(a,t){return new qa(a,t)}var Da=class{encode(a){return JSON.stringify(a)}decode(a){return JSON.parse(a)}},Va=class extends ys.EventEmitter{constructor(t,e="ws://localhost:8080",{autoconnect:r=!0,reconnect:s=!0,reconnect_interval:i=1e3,max_reconnects:u=5,...m}={},w,b){super();ee(this,"address");ee(this,"rpc_id");ee(this,"queue");ee(this,"options");ee(this,"autoconnect");ee(this,"ready");ee(this,"reconnect");ee(this,"reconnect_timer_id");ee(this,"reconnect_interval");ee(this,"max_reconnects");ee(this,"rest_options");ee(this,"current_reconnects");ee(this,"generate_request_id");ee(this,"socket");ee(this,"webSocketFactory");ee(this,"dataPack");this.webSocketFactory=t,this.queue={},this.rpc_id=0,this.address=e,this.autoconnect=r,this.ready=!1,this.reconnect=s,this.reconnect_timer_id=void 0,this.reconnect_interval=i,this.max_reconnects=u,this.rest_options=m,this.current_reconnects=0,this.generate_request_id=w||(()=>++this.rpc_id),b?this.dataPack=b:this.dataPack=new Da,this.autoconnect&&this._connect(this.address,{autoconnect:this.autoconnect,reconnect:this.reconnect,reconnect_interval:this.reconnect_interval,max_reconnects:this.max_reconnects,...this.rest_options})}connect(){this.socket||this._connect(this.address,{autoconnect:this.autoconnect,reconnect:this.reconnect,reconnect_interval:this.reconnect_interval,max_reconnects:this.max_reconnects,...this.rest_options})}call(t,e,r,s){return!s&&typeof r=="object"&&(s=r,r=null),new Promise((i,u)=>{if(!this.ready)return u(new Error("socket not ready"));const m=this.generate_request_id(t,e),w={jsonrpc:"2.0",method:t,params:e||void 0,id:m};this.socket.send(this.dataPack.encode(w),s,b=>{if(b)return u(b);this.queue[m]={promise:[i,u]},r&&(this.queue[m].timeout=setTimeout(()=>{delete this.queue[m],u(new Error("reply timeout"))},r))})})}async login(t){const e=await this.call("rpc.login",t);if(!e)throw new Error("authentication failed");return e}async listMethods(){return await this.call("__listMethods")}notify(t,e){return new Promise((r,s)=>{if(!this.ready)return s(new Error("socket not ready"));const i={jsonrpc:"2.0",method:t,params:e};this.socket.send(this.dataPack.encode(i),u=>{if(u)return s(u);r()})})}async subscribe(t){typeof t=="string"&&(t=[t]);const e=await this.call("rpc.on",t);if(typeof t=="string"&&e[t]!=="ok")throw new Error("Failed subscribing to an event '"+t+"' with: "+e[t]);return e}async unsubscribe(t){typeof t=="string"&&(t=[t]);const e=await this.call("rpc.off",t);if(typeof t=="string"&&e[t]!=="ok")throw new Error("Failed unsubscribing from an event with: "+e);return e}close(t,e){this.socket.close(t||1e3,e)}setAutoReconnect(t){this.reconnect=t}setReconnectInterval(t){this.reconnect_interval=t}setMaxReconnects(t){this.max_reconnects=t}_connect(t,e){clearTimeout(this.reconnect_timer_id),this.socket=this.webSocketFactory(t,e),this.socket.addEventListener("open",()=>{this.ready=!0,this.emit("open"),this.current_reconnects=0}),this.socket.addEventListener("message",({data:r})=>{r instanceof ArrayBuffer&&(r=$.from(r).toString());try{r=this.dataPack.decode(r)}catch{return}if(r.notification&&this.listeners(r.notification).length){if(!Object.keys(r.params).length)return this.emit(r.notification);const s=[r.notification];if(r.params.constructor===Object)s.push(r.params);else for(let i=0;i<r.params.length;i++)s.push(r.params[i]);return Promise.resolve().then(()=>{this.emit.apply(this,s)})}if(!this.queue[r.id])return r.method?Promise.resolve().then(()=>{this.emit(r.method,r==null?void 0:r.params)}):void 0;"error"in r=="result"in r&&this.queue[r.id].promise[1](new Error('Server response malformed. Response must include either "result" or "error", but not both.')),this.queue[r.id].timeout&&clearTimeout(this.queue[r.id].timeout),r.error?this.queue[r.id].promise[1](r.error):this.queue[r.id].promise[0](r.result),delete this.queue[r.id]}),this.socket.addEventListener("error",r=>this.emit("error",r)),this.socket.addEventListener("close",({code:r,reason:s})=>{this.ready&&setTimeout(()=>this.emit("close",r,s),0),this.ready=!1,this.socket=void 0,r!==1e3&&(this.current_reconnects++,this.reconnect&&(this.max_reconnects>this.current_reconnects||this.max_reconnects===0)&&(this.reconnect_timer_id=setTimeout(()=>this._connect(t,e),this.reconnect_interval)))})}};const $a=Or.utils.randomPrivateKey,Qi=()=>{const a=Or.utils.randomPrivateKey(),t=Bn(a),e=new Uint8Array(64);return e.set(a),e.set(t,32),{publicKey:t,secretKey:e}},Bn=Or.getPublicKey;function ts(a){try{return Or.ExtendedPoint.fromHex(a),!0}catch{return!1}}const Li=(a,t)=>Or.sign(a,t.slice(0,32)),Ha=Or.verify,Bt=a=>$.isBuffer(a)?a:a instanceof Uint8Array?$.from(a.buffer,a.byteOffset,a.byteLength):$.from(a);class Ci{constructor(t){Object.assign(this,t)}encode(){return $.from(Is(un,this))}static decode(t){return As(un,this,t)}static decodeUnchecked(t){return ks(un,this,t)}}class Ga extends Ci{constructor(t){if(super(t),this.enum="",Object.keys(t).length!==1)throw new Error("Enum can only take single value");Object.keys(t).map(e=>{this.enum=e})}}const un=new Map;var to;const eo=32,Ce=32;function ja(a){return a._bn!==void 0}let es=1;class C extends Ci{constructor(t){if(super({}),this._bn=void 0,ja(t))this._bn=t._bn;else{if(typeof t=="string"){const e=ae.decode(t);if(e.length!=Ce)throw new Error("Invalid public key input");this._bn=new Zi(e)}else this._bn=new Zi(t);if(this._bn.byteLength()>Ce)throw new Error("Invalid public key input")}}static unique(){const t=new C(es);return es+=1,new C(t.toBuffer())}equals(t){return this._bn.eq(t._bn)}toBase58(){return ae.encode(this.toBytes())}toJSON(){return this.toBase58()}toBytes(){const t=this.toBuffer();return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}toBuffer(){const t=this._bn.toArrayLike($);if(t.length===Ce)return t;const e=$.alloc(32);return t.copy(e,32-t.length),e}get[Symbol.toStringTag](){return`PublicKey(${this.toString()})`}toString(){return this.toBase58()}static async createWithSeed(t,e,r){const s=$.concat([t.toBuffer(),$.from(e),r.toBuffer()]),i=ji(s);return new C(i)}static createProgramAddressSync(t,e){let r=$.alloc(0);t.forEach(function(i){if(i.length>eo)throw new TypeError("Max seed length exceeded");r=$.concat([r,Bt(i)])}),r=$.concat([r,e.toBuffer(),$.from("ProgramDerivedAddress")]);const s=ji(r);if(ts(s))throw new Error("Invalid seeds, address must fall off the curve");return new C(s)}static async createProgramAddress(t,e){return this.createProgramAddressSync(t,e)}static findProgramAddressSync(t,e){let r=255,s;for(;r!=0;){try{const i=t.concat($.from([r]));s=this.createProgramAddressSync(i,e)}catch(i){if(i instanceof TypeError)throw i;r--;continue}return[s,r]}throw new Error("Unable to find a viable program address nonce")}static async findProgramAddress(t,e){return this.findProgramAddressSync(t,e)}static isOnCurve(t){const e=new C(t);return ts(e.toBytes())}}to=C;C.default=new to("11111111111111111111111111111111");un.set(C,{kind:"struct",fields:[["_bn","u256"]]});class Ja{constructor(t){if(this._publicKey=void 0,this._secretKey=void 0,t){const e=Bt(t);if(t.length!==64)throw new Error("bad secret key size");this._publicKey=e.slice(32,64),this._secretKey=e.slice(0,32)}else this._secretKey=Bt($a()),this._publicKey=Bt(Bn(this._secretKey))}get publicKey(){return new C(this._publicKey)}get secretKey(){return $.concat([this._secretKey,this._publicKey],64)}}const Za=new C("BPFLoader1111111111111111111111111111111111"),Ge=1232,Wn=127,ln=64;class Ni extends Error{constructor(t){super(`Signature ${t} has expired: block height exceeded.`),this.signature=void 0,this.signature=t}}Object.defineProperty(Ni.prototype,"name",{value:"TransactionExpiredBlockheightExceededError"});class Oi extends Error{constructor(t,e){super(`Transaction was not confirmed in ${e.toFixed(2)} seconds. It is unknown if it succeeded or failed. Check signature ${t} using the Solana Explorer or CLI tools.`),this.signature=void 0,this.signature=t}}Object.defineProperty(Oi.prototype,"name",{value:"TransactionExpiredTimeoutError"});class Er extends Error{constructor(t){super(`Signature ${t} has expired: the nonce is no longer valid.`),this.signature=void 0,this.signature=t}}Object.defineProperty(Er.prototype,"name",{value:"TransactionExpiredNonceInvalidError"});class fn{constructor(t,e){this.staticAccountKeys=void 0,this.accountKeysFromLookups=void 0,this.staticAccountKeys=t,this.accountKeysFromLookups=e}keySegments(){const t=[this.staticAccountKeys];return this.accountKeysFromLookups&&(t.push(this.accountKeysFromLookups.writable),t.push(this.accountKeysFromLookups.readonly)),t}get(t){for(const e of this.keySegments()){if(t<e.length)return e[t];t-=e.length}}get length(){return this.keySegments().flat().length}compileInstructions(t){if(this.length>256)throw new Error("Account index overflow encountered during compilation");const r=new Map;this.keySegments().flat().forEach((i,u)=>{r.set(i.toBase58(),u)});const s=i=>{const u=r.get(i.toBase58());if(u===void 0)throw new Error("Encountered an unknown instruction account key during compilation");return u};return t.map(i=>({programIdIndex:s(i.programId),accountKeyIndexes:i.keys.map(u=>s(u.pubkey)),data:i.data}))}}const Ct=(a="publicKey")=>jt(32,a),Ya=(a="signature")=>jt(64,a),vr=(a="string")=>{const t=q([W("length"),W("lengthPadding"),jt(He(W(),-8),"chars")],a),e=t.decode.bind(t),r=t.encode.bind(t),s=t;return s.decode=(i,u)=>e(i,u).chars.toString(),s.encode=(i,u,m)=>{const w={chars:$.from(i,"utf8")};return r(w,u,m)},s.alloc=i=>W().span+W().span+$.from(i,"utf8").length,s},Xa=(a="authorized")=>q([Ct("staker"),Ct("withdrawer")],a),Qa=(a="lockup")=>q([be("unixTimestamp"),be("epoch"),Ct("custodian")],a),tc=(a="voteInit")=>q([Ct("nodePubkey"),Ct("authorizedVoter"),Ct("authorizedWithdrawer"),Kt("commission")],a),ec=(a="voteAuthorizeWithSeedArgs")=>q([W("voteAuthorizationType"),Ct("currentAuthorityDerivedKeyOwnerPubkey"),vr("currentAuthorityDerivedKeySeed"),Ct("newAuthorized")],a);function ro(a,t){const e=s=>{if(s.span>=0)return s.span;if(typeof s.alloc=="function")return s.alloc(t[s.property]);if("count"in s&&"elementLayout"in s){const i=t[s.property];if(Array.isArray(i))return i.length*e(s.elementLayout)}else if("fields"in s)return ro({layout:s},t[s.property]);return 0};let r=0;return a.layout.fields.forEach(s=>{r+=e(s)}),r}function ye(a){let t=0,e=0;for(;;){let r=a.shift();if(t|=(r&127)<<e*7,e+=1,!(r&128))break}return t}function ke(a,t){let e=t;for(;;){let r=e&127;if(e>>=7,e==0){a.push(r);break}else r|=128,a.push(r)}}function Ut(a,t){if(!a)throw new Error(t||"Assertion failed")}class qn{constructor(t,e){this.payer=void 0,this.keyMetaMap=void 0,this.payer=t,this.keyMetaMap=e}static compile(t,e){const r=new Map,s=u=>{const m=u.toBase58();let w=r.get(m);return w===void 0&&(w={isSigner:!1,isWritable:!1,isInvoked:!1},r.set(m,w)),w},i=s(e);i.isSigner=!0,i.isWritable=!0;for(const u of t){s(u.programId).isInvoked=!0;for(const m of u.keys){const w=s(m.pubkey);w.isSigner||(w.isSigner=m.isSigner),w.isWritable||(w.isWritable=m.isWritable)}}return new qn(e,r)}getMessageComponents(){const t=[...this.keyMetaMap.entries()];Ut(t.length<=256,"Max static account keys length exceeded");const e=t.filter(([,w])=>w.isSigner&&w.isWritable),r=t.filter(([,w])=>w.isSigner&&!w.isWritable),s=t.filter(([,w])=>!w.isSigner&&w.isWritable),i=t.filter(([,w])=>!w.isSigner&&!w.isWritable),u={numRequiredSignatures:e.length+r.length,numReadonlySignedAccounts:r.length,numReadonlyUnsignedAccounts:i.length};{Ut(e.length>0,"Expected at least one writable signer key");const[w]=e[0];Ut(w===this.payer.toBase58(),"Expected first writable signer key to be the fee payer")}const m=[...e.map(([w])=>new C(w)),...r.map(([w])=>new C(w)),...s.map(([w])=>new C(w)),...i.map(([w])=>new C(w))];return[u,m]}extractTableLookup(t){const[e,r]=this.drainKeysFoundInLookupTable(t.state.addresses,u=>!u.isSigner&&!u.isInvoked&&u.isWritable),[s,i]=this.drainKeysFoundInLookupTable(t.state.addresses,u=>!u.isSigner&&!u.isInvoked&&!u.isWritable);if(!(e.length===0&&s.length===0))return[{accountKey:t.key,writableIndexes:e,readonlyIndexes:s},{writable:r,readonly:i}]}drainKeysFoundInLookupTable(t,e){const r=new Array,s=new Array;for(const[i,u]of this.keyMetaMap.entries())if(e(u)){const m=new C(i),w=t.findIndex(b=>b.equals(m));w>=0&&(Ut(w<256,"Max lookup table index exceeded"),r.push(w),s.push(m),this.keyMetaMap.delete(i))}return[r,s]}}const no="Reached end of buffer unexpectedly";function Te(a){if(a.length===0)throw new Error(no);return a.shift()}function we(a,...t){const[e]=t;if(t.length===2?e+(t[1]??0)>a.length:e>=a.length)throw new Error(no);return a.splice(...t)}class Ae{constructor(t){this.header=void 0,this.accountKeys=void 0,this.recentBlockhash=void 0,this.instructions=void 0,this.indexToProgramIds=new Map,this.header=t.header,this.accountKeys=t.accountKeys.map(e=>new C(e)),this.recentBlockhash=t.recentBlockhash,this.instructions=t.instructions,this.instructions.forEach(e=>this.indexToProgramIds.set(e.programIdIndex,this.accountKeys[e.programIdIndex]))}get version(){return"legacy"}get staticAccountKeys(){return this.accountKeys}get compiledInstructions(){return this.instructions.map(t=>({programIdIndex:t.programIdIndex,accountKeyIndexes:t.accounts,data:ae.decode(t.data)}))}get addressTableLookups(){return[]}getAccountKeys(){return new fn(this.staticAccountKeys)}static compile(t){const e=qn.compile(t.instructions,t.payerKey),[r,s]=e.getMessageComponents(),u=new fn(s).compileInstructions(t.instructions).map(m=>({programIdIndex:m.programIdIndex,accounts:m.accountKeyIndexes,data:ae.encode(m.data)}));return new Ae({header:r,accountKeys:s,recentBlockhash:t.recentBlockhash,instructions:u})}isAccountSigner(t){return t<this.header.numRequiredSignatures}isAccountWritable(t){const e=this.header.numRequiredSignatures;if(t>=this.header.numRequiredSignatures){const r=t-e,i=this.accountKeys.length-e-this.header.numReadonlyUnsignedAccounts;return r<i}else{const r=e-this.header.numReadonlySignedAccounts;return t<r}}isProgramId(t){return this.indexToProgramIds.has(t)}programIds(){return[...this.indexToProgramIds.values()]}nonProgramIds(){return this.accountKeys.filter((t,e)=>!this.isProgramId(e))}serialize(){const t=this.accountKeys.length;let e=[];ke(e,t);const r=this.instructions.map(x=>{const{accounts:L,programIdIndex:_}=x,E=Array.from(ae.decode(x.data));let A=[];ke(A,L.length);let N=[];return ke(N,E.length),{programIdIndex:_,keyIndicesCount:$.from(A),keyIndices:L,dataLength:$.from(N),data:E}});let s=[];ke(s,r.length);let i=$.alloc(Ge);$.from(s).copy(i);let u=s.length;r.forEach(x=>{const _=q([Kt("programIdIndex"),jt(x.keyIndicesCount.length,"keyIndicesCount"),ce(Kt("keyIndex"),x.keyIndices.length,"keyIndices"),jt(x.dataLength.length,"dataLength"),ce(Kt("userdatum"),x.data.length,"data")]).encode(x,i,u);u+=_}),i=i.slice(0,u);const m=q([jt(1,"numRequiredSignatures"),jt(1,"numReadonlySignedAccounts"),jt(1,"numReadonlyUnsignedAccounts"),jt(e.length,"keyCount"),ce(Ct("key"),t,"keys"),Ct("recentBlockhash")]),w={numRequiredSignatures:$.from([this.header.numRequiredSignatures]),numReadonlySignedAccounts:$.from([this.header.numReadonlySignedAccounts]),numReadonlyUnsignedAccounts:$.from([this.header.numReadonlyUnsignedAccounts]),keyCount:$.from(e),keys:this.accountKeys.map(x=>Bt(x.toBytes())),recentBlockhash:ae.decode(this.recentBlockhash)};let b=$.alloc(2048);const M=m.encode(w,b);return i.copy(b,M),b.slice(0,M+i.length)}static from(t){let e=[...t];const r=Te(e);if(r!==(r&Wn))throw new Error("Versioned messages must be deserialized with VersionedMessage.deserialize()");const s=Te(e),i=Te(e),u=ye(e);let m=[];for(let L=0;L<u;L++){const _=we(e,0,Ce);m.push(new C($.from(_)))}const w=we(e,0,Ce),b=ye(e);let M=[];for(let L=0;L<b;L++){const _=Te(e),E=ye(e),A=we(e,0,E),N=ye(e),U=we(e,0,N),G=ae.encode($.from(U));M.push({programIdIndex:_,accounts:A,data:G})}const x={header:{numRequiredSignatures:r,numReadonlySignedAccounts:s,numReadonlyUnsignedAccounts:i},recentBlockhash:ae.encode($.from(w)),accountKeys:m,instructions:M};return new Ae(x)}}class br{constructor(t){this.header=void 0,this.staticAccountKeys=void 0,this.recentBlockhash=void 0,this.compiledInstructions=void 0,this.addressTableLookups=void 0,this.header=t.header,this.staticAccountKeys=t.staticAccountKeys,this.recentBlockhash=t.recentBlockhash,this.compiledInstructions=t.compiledInstructions,this.addressTableLookups=t.addressTableLookups}get version(){return 0}get numAccountKeysFromLookups(){let t=0;for(const e of this.addressTableLookups)t+=e.readonlyIndexes.length+e.writableIndexes.length;return t}getAccountKeys(t){let e;if(t&&"accountKeysFromLookups"in t&&t.accountKeysFromLookups){if(this.numAccountKeysFromLookups!=t.accountKeysFromLookups.writable.length+t.accountKeysFromLookups.readonly.length)throw new Error("Failed to get account keys because of a mismatch in the number of account keys from lookups");e=t.accountKeysFromLookups}else if(t&&"addressLookupTableAccounts"in t&&t.addressLookupTableAccounts)e=this.resolveAddressTableLookups(t.addressLookupTableAccounts);else if(this.addressTableLookups.length>0)throw new Error("Failed to get account keys because address table lookups were not resolved");return new fn(this.staticAccountKeys,e)}isAccountSigner(t){return t<this.header.numRequiredSignatures}isAccountWritable(t){const e=this.header.numRequiredSignatures,r=this.staticAccountKeys.length;if(t>=r){const s=t-r,i=this.addressTableLookups.reduce((u,m)=>u+m.writableIndexes.length,0);return s<i}else if(t>=this.header.numRequiredSignatures){const s=t-e,u=r-e-this.header.numReadonlyUnsignedAccounts;return s<u}else{const s=e-this.header.numReadonlySignedAccounts;return t<s}}resolveAddressTableLookups(t){const e={writable:[],readonly:[]};for(const r of this.addressTableLookups){const s=t.find(i=>i.key.equals(r.accountKey));if(!s)throw new Error(`Failed to find address lookup table account for table key ${r.accountKey.toBase58()}`);for(const i of r.writableIndexes)if(i<s.state.addresses.length)e.writable.push(s.state.addresses[i]);else throw new Error(`Failed to find address for index ${i} in address lookup table ${r.accountKey.toBase58()}`);for(const i of r.readonlyIndexes)if(i<s.state.addresses.length)e.readonly.push(s.state.addresses[i]);else throw new Error(`Failed to find address for index ${i} in address lookup table ${r.accountKey.toBase58()}`)}return e}static compile(t){const e=qn.compile(t.instructions,t.payerKey),r=new Array,s={writable:new Array,readonly:new Array},i=t.addressLookupTableAccounts||[];for(const M of i){const x=e.extractTableLookup(M);if(x!==void 0){const[L,{writable:_,readonly:E}]=x;r.push(L),s.writable.push(..._),s.readonly.push(...E)}}const[u,m]=e.getMessageComponents(),b=new fn(m,s).compileInstructions(t.instructions);return new br({header:u,staticAccountKeys:m,recentBlockhash:t.recentBlockhash,compiledInstructions:b,addressTableLookups:r})}serialize(){const t=Array();ke(t,this.staticAccountKeys.length);const e=this.serializeInstructions(),r=Array();ke(r,this.compiledInstructions.length);const s=this.serializeAddressTableLookups(),i=Array();ke(i,this.addressTableLookups.length);const u=q([Kt("prefix"),q([Kt("numRequiredSignatures"),Kt("numReadonlySignedAccounts"),Kt("numReadonlyUnsignedAccounts")],"header"),jt(t.length,"staticAccountKeysLength"),ce(Ct(),this.staticAccountKeys.length,"staticAccountKeys"),Ct("recentBlockhash"),jt(r.length,"instructionsLength"),jt(e.length,"serializedInstructions"),jt(i.length,"addressTableLookupsLength"),jt(s.length,"serializedAddressTableLookups")]),m=new Uint8Array(Ge),b=u.encode({prefix:128,header:this.header,staticAccountKeysLength:new Uint8Array(t),staticAccountKeys:this.staticAccountKeys.map(M=>M.toBytes()),recentBlockhash:ae.decode(this.recentBlockhash),instructionsLength:new Uint8Array(r),serializedInstructions:e,addressTableLookupsLength:new Uint8Array(i),serializedAddressTableLookups:s},m);return m.slice(0,b)}serializeInstructions(){let t=0;const e=new Uint8Array(Ge);for(const r of this.compiledInstructions){const s=Array();ke(s,r.accountKeyIndexes.length);const i=Array();ke(i,r.data.length);const u=q([Kt("programIdIndex"),jt(s.length,"encodedAccountKeyIndexesLength"),ce(Kt(),r.accountKeyIndexes.length,"accountKeyIndexes"),jt(i.length,"encodedDataLength"),jt(r.data.length,"data")]);t+=u.encode({programIdIndex:r.programIdIndex,encodedAccountKeyIndexesLength:new Uint8Array(s),accountKeyIndexes:r.accountKeyIndexes,encodedDataLength:new Uint8Array(i),data:r.data},e,t)}return e.slice(0,t)}serializeAddressTableLookups(){let t=0;const e=new Uint8Array(Ge);for(const r of this.addressTableLookups){const s=Array();ke(s,r.writableIndexes.length);const i=Array();ke(i,r.readonlyIndexes.length);const u=q([Ct("accountKey"),jt(s.length,"encodedWritableIndexesLength"),ce(Kt(),r.writableIndexes.length,"writableIndexes"),jt(i.length,"encodedReadonlyIndexesLength"),ce(Kt(),r.readonlyIndexes.length,"readonlyIndexes")]);t+=u.encode({accountKey:r.accountKey.toBytes(),encodedWritableIndexesLength:new Uint8Array(s),writableIndexes:r.writableIndexes,encodedReadonlyIndexesLength:new Uint8Array(i),readonlyIndexes:r.readonlyIndexes},e,t)}return e.slice(0,t)}static deserialize(t){let e=[...t];const r=Te(e),s=r&Wn;Ut(r!==s,"Expected versioned message but received legacy message");const i=s;Ut(i===0,`Expected versioned message with version 0 but found version ${i}`);const u={numRequiredSignatures:Te(e),numReadonlySignedAccounts:Te(e),numReadonlyUnsignedAccounts:Te(e)},m=[],w=ye(e);for(let E=0;E<w;E++)m.push(new C(we(e,0,Ce)));const b=ae.encode(we(e,0,Ce)),M=ye(e),x=[];for(let E=0;E<M;E++){const A=Te(e),N=ye(e),U=we(e,0,N),G=ye(e),qt=new Uint8Array(we(e,0,G));x.push({programIdIndex:A,accountKeyIndexes:U,data:qt})}const L=ye(e),_=[];for(let E=0;E<L;E++){const A=new C(we(e,0,Ce)),N=ye(e),U=we(e,0,N),G=ye(e),qt=we(e,0,G);_.push({accountKey:A,writableIndexes:U,readonlyIndexes:qt})}return new br({header:u,staticAccountKeys:m,recentBlockhash:b,compiledInstructions:x,addressTableLookups:_})}}const zi={deserializeMessageVersion(a){const t=a[0],e=t&Wn;return e===t?"legacy":e},deserialize:a=>{const t=zi.deserializeMessageVersion(a);if(t==="legacy")return Ae.from(a);if(t===0)return br.deserialize(a);throw new Error(`Transaction message version ${t} deserialization is not supported`)}};let qe=function(a){return a[a.BLOCKHEIGHT_EXCEEDED=0]="BLOCKHEIGHT_EXCEEDED",a[a.PROCESSED=1]="PROCESSED",a[a.TIMED_OUT=2]="TIMED_OUT",a[a.NONCE_INVALID=3]="NONCE_INVALID",a}({});const rc=$.alloc(ln).fill(0);class $t{constructor(t){this.keys=void 0,this.programId=void 0,this.data=$.alloc(0),this.programId=t.programId,this.keys=t.keys,t.data&&(this.data=t.data)}toJSON(){return{keys:this.keys.map(({pubkey:t,isSigner:e,isWritable:r})=>({pubkey:t.toJSON(),isSigner:e,isWritable:r})),programId:this.programId.toJSON(),data:[...this.data]}}}class Ot{get signature(){return this.signatures.length>0?this.signatures[0].signature:null}constructor(t){if(this.signatures=[],this.feePayer=void 0,this.instructions=[],this.recentBlockhash=void 0,this.lastValidBlockHeight=void 0,this.nonceInfo=void 0,this.minNonceContextSlot=void 0,this._message=void 0,this._json=void 0,!!t)if(t.feePayer&&(this.feePayer=t.feePayer),t.signatures&&(this.signatures=t.signatures),Object.prototype.hasOwnProperty.call(t,"nonceInfo")){const{minContextSlot:e,nonceInfo:r}=t;this.minNonceContextSlot=e,this.nonceInfo=r}else if(Object.prototype.hasOwnProperty.call(t,"lastValidBlockHeight")){const{blockhash:e,lastValidBlockHeight:r}=t;this.recentBlockhash=e,this.lastValidBlockHeight=r}else{const{recentBlockhash:e,nonceInfo:r}=t;r&&(this.nonceInfo=r),this.recentBlockhash=e}}toJSON(){return{recentBlockhash:this.recentBlockhash||null,feePayer:this.feePayer?this.feePayer.toJSON():null,nonceInfo:this.nonceInfo?{nonce:this.nonceInfo.nonce,nonceInstruction:this.nonceInfo.nonceInstruction.toJSON()}:null,instructions:this.instructions.map(t=>t.toJSON()),signers:this.signatures.map(({publicKey:t})=>t.toJSON())}}add(...t){if(t.length===0)throw new Error("No instructions");return t.forEach(e=>{"instructions"in e?this.instructions=this.instructions.concat(e.instructions):"data"in e&&"programId"in e&&"keys"in e?this.instructions.push(e):this.instructions.push(new $t(e))}),this}compileMessage(){if(this._message&&JSON.stringify(this.toJSON())===JSON.stringify(this._json))return this._message;let t,e;if(this.nonceInfo?(t=this.nonceInfo.nonce,this.instructions[0]!=this.nonceInfo.nonceInstruction?e=[this.nonceInfo.nonceInstruction,...this.instructions]:e=this.instructions):(t=this.recentBlockhash,e=this.instructions),!t)throw new Error("Transaction recentBlockhash required");e.length<1&&console.warn("No instructions provided");let r;if(this.feePayer)r=this.feePayer;else if(this.signatures.length>0&&this.signatures[0].publicKey)r=this.signatures[0].publicKey;else throw new Error("Transaction fee payer required");for(let A=0;A<e.length;A++)if(e[A].programId===void 0)throw new Error(`Transaction instruction index ${A} has undefined program id`);const s=[],i=[];e.forEach(A=>{A.keys.forEach(U=>{i.push({...U})});const N=A.programId.toString();s.includes(N)||s.push(N)}),s.forEach(A=>{i.push({pubkey:new C(A),isSigner:!1,isWritable:!1})});const u=[];i.forEach(A=>{const N=A.pubkey.toString(),U=u.findIndex(G=>G.pubkey.toString()===N);U>-1?(u[U].isWritable=u[U].isWritable||A.isWritable,u[U].isSigner=u[U].isSigner||A.isSigner):u.push(A)}),u.sort(function(A,N){if(A.isSigner!==N.isSigner)return A.isSigner?-1:1;if(A.isWritable!==N.isWritable)return A.isWritable?-1:1;const U={localeMatcher:"best fit",usage:"sort",sensitivity:"variant",ignorePunctuation:!1,numeric:!1,caseFirst:"lower"};return A.pubkey.toBase58().localeCompare(N.pubkey.toBase58(),"en",U)});const m=u.findIndex(A=>A.pubkey.equals(r));if(m>-1){const[A]=u.splice(m,1);A.isSigner=!0,A.isWritable=!0,u.unshift(A)}else u.unshift({pubkey:r,isSigner:!0,isWritable:!0});for(const A of this.signatures){const N=u.findIndex(U=>U.pubkey.equals(A.publicKey));if(N>-1)u[N].isSigner||(u[N].isSigner=!0,console.warn("Transaction references a signature that is unnecessary, only the fee payer and instruction signer accounts should sign a transaction. This behavior is deprecated and will throw an error in the next major version release."));else throw new Error(`unknown signer: ${A.publicKey.toString()}`)}let w=0,b=0,M=0;const x=[],L=[];u.forEach(({pubkey:A,isSigner:N,isWritable:U})=>{N?(x.push(A.toString()),w+=1,U||(b+=1)):(L.push(A.toString()),U||(M+=1))});const _=x.concat(L),E=e.map(A=>{const{data:N,programId:U}=A;return{programIdIndex:_.indexOf(U.toString()),accounts:A.keys.map(G=>_.indexOf(G.pubkey.toString())),data:ae.encode(N)}});return E.forEach(A=>{Ut(A.programIdIndex>=0),A.accounts.forEach(N=>Ut(N>=0))}),new Ae({header:{numRequiredSignatures:w,numReadonlySignedAccounts:b,numReadonlyUnsignedAccounts:M},accountKeys:_,recentBlockhash:t,instructions:E})}_compile(){const t=this.compileMessage(),e=t.accountKeys.slice(0,t.header.numRequiredSignatures);return this.signatures.length===e.length&&this.signatures.every((s,i)=>e[i].equals(s.publicKey))||(this.signatures=e.map(r=>({signature:null,publicKey:r}))),t}serializeMessage(){return this._compile().serialize()}async getEstimatedFee(t){return(await t.getFeeForMessage(this.compileMessage())).value}setSigners(...t){if(t.length===0)throw new Error("No signers");const e=new Set;this.signatures=t.filter(r=>{const s=r.toString();return e.has(s)?!1:(e.add(s),!0)}).map(r=>({signature:null,publicKey:r}))}sign(...t){if(t.length===0)throw new Error("No signers");const e=new Set,r=[];for(const i of t){const u=i.publicKey.toString();e.has(u)||(e.add(u),r.push(i))}this.signatures=r.map(i=>({signature:null,publicKey:i.publicKey}));const s=this._compile();this._partialSign(s,...r)}partialSign(...t){if(t.length===0)throw new Error("No signers");const e=new Set,r=[];for(const i of t){const u=i.publicKey.toString();e.has(u)||(e.add(u),r.push(i))}const s=this._compile();this._partialSign(s,...r)}_partialSign(t,...e){const r=t.serialize();e.forEach(s=>{const i=Li(r,s.secretKey);this._addSignature(s.publicKey,Bt(i))})}addSignature(t,e){this._compile(),this._addSignature(t,e)}_addSignature(t,e){Ut(e.length===64);const r=this.signatures.findIndex(s=>t.equals(s.publicKey));if(r<0)throw new Error(`unknown signer: ${t.toString()}`);this.signatures[r].signature=$.from(e)}verifySignatures(t=!0){return!this._getMessageSignednessErrors(this.serializeMessage(),t)}_getMessageSignednessErrors(t,e){const r={};for(const{signature:s,publicKey:i}of this.signatures)s===null?e&&(r.missing||(r.missing=[])).push(i):Ha(s,t,i.toBytes())||(r.invalid||(r.invalid=[])).push(i);return r.invalid||r.missing?r:void 0}serialize(t){const{requireAllSignatures:e,verifySignatures:r}=Object.assign({requireAllSignatures:!0,verifySignatures:!0},t),s=this.serializeMessage();if(r){const i=this._getMessageSignednessErrors(s,e);if(i){let u="Signature verification failed.";throw i.invalid&&(u+=`
Invalid signature for public key${i.invalid.length===1?"":"(s)"} [\`${i.invalid.map(m=>m.toBase58()).join("`, `")}\`].`),i.missing&&(u+=`
Missing signature for public key${i.missing.length===1?"":"(s)"} [\`${i.missing.map(m=>m.toBase58()).join("`, `")}\`].`),new Error(u)}}return this._serialize(s)}_serialize(t){const{signatures:e}=this,r=[];ke(r,e.length);const s=r.length+e.length*64+t.length,i=$.alloc(s);return Ut(e.length<256),$.from(r).copy(i,0),e.forEach(({signature:u},m)=>{u!==null&&(Ut(u.length===64,"signature has invalid length"),$.from(u).copy(i,r.length+m*64))}),t.copy(i,r.length+e.length*64),Ut(i.length<=Ge,`Transaction too large: ${i.length} > ${Ge}`),i}get keys(){return Ut(this.instructions.length===1),this.instructions[0].keys.map(t=>t.pubkey)}get programId(){return Ut(this.instructions.length===1),this.instructions[0].programId}get data(){return Ut(this.instructions.length===1),this.instructions[0].data}static from(t){let e=[...t];const r=ye(e);let s=[];for(let i=0;i<r;i++){const u=we(e,0,ln);s.push(ae.encode($.from(u)))}return Ot.populate(Ae.from(e),s)}static populate(t,e=[]){const r=new Ot;return r.recentBlockhash=t.recentBlockhash,t.header.numRequiredSignatures>0&&(r.feePayer=t.accountKeys[0]),e.forEach((s,i)=>{const u={signature:s==ae.encode(rc)?null:ae.decode(s),publicKey:t.accountKeys[i]};r.signatures.push(u)}),t.instructions.forEach(s=>{const i=s.accounts.map(u=>{const m=t.accountKeys[u];return{pubkey:m,isSigner:r.signatures.some(w=>w.publicKey.toString()===m.toString())||t.isAccountSigner(u),isWritable:t.isAccountWritable(u)}});r.instructions.push(new $t({keys:i,programId:t.accountKeys[s.programIdIndex],data:ae.decode(s.data)}))}),r._message=t,r._json=r.toJSON(),r}}class Rr{constructor(t){this.payerKey=void 0,this.instructions=void 0,this.recentBlockhash=void 0,this.payerKey=t.payerKey,this.instructions=t.instructions,this.recentBlockhash=t.recentBlockhash}static decompile(t,e){const{header:r,compiledInstructions:s,recentBlockhash:i}=t,{numRequiredSignatures:u,numReadonlySignedAccounts:m,numReadonlyUnsignedAccounts:w}=r,b=u-m;Ut(b>0,"Message header is invalid");const M=t.staticAccountKeys.length-u-w;Ut(M>=0,"Message header is invalid");const x=t.getAccountKeys(e),L=x.get(0);if(L===void 0)throw new Error("Failed to decompile message because no account keys were found");const _=[];for(const E of s){const A=[];for(const U of E.accountKeyIndexes){const G=x.get(U);if(G===void 0)throw new Error(`Failed to find key for account key index ${U}`);const qt=U<u;let Ft;qt?Ft=U<b:U<x.staticAccountKeys.length?Ft=U-u<M:Ft=U-x.staticAccountKeys.length<x.accountKeysFromLookups.writable.length,A.push({pubkey:G,isSigner:U<r.numRequiredSignatures,isWritable:Ft})}const N=x.get(E.programIdIndex);if(N===void 0)throw new Error(`Failed to find program id for program id index ${E.programIdIndex}`);_.push(new $t({programId:N,data:Bt(E.data),keys:A}))}return new Rr({payerKey:L,instructions:_,recentBlockhash:i})}compileToLegacyMessage(){return Ae.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions})}compileToV0Message(t){return br.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions,addressLookupTableAccounts:t})}}class Pr{get version(){return this.message.version}constructor(t,e){if(this.signatures=void 0,this.message=void 0,e!==void 0)Ut(e.length===t.header.numRequiredSignatures,"Expected signatures length to be equal to the number of required signatures"),this.signatures=e;else{const r=[];for(let s=0;s<t.header.numRequiredSignatures;s++)r.push(new Uint8Array(ln));this.signatures=r}this.message=t}serialize(){const t=this.message.serialize(),e=Array();ke(e,this.signatures.length);const r=q([jt(e.length,"encodedSignaturesLength"),ce(Ya(),this.signatures.length,"signatures"),jt(t.length,"serializedMessage")]),s=new Uint8Array(2048),i=r.encode({encodedSignaturesLength:new Uint8Array(e),signatures:this.signatures,serializedMessage:t},s);return s.slice(0,i)}static deserialize(t){let e=[...t];const r=[],s=ye(e);for(let u=0;u<s;u++)r.push(new Uint8Array(we(e,0,ln)));const i=zi.deserialize(new Uint8Array(e));return new Pr(i,r)}sign(t){const e=this.message.serialize(),r=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures);for(const s of t){const i=r.findIndex(u=>u.equals(s.publicKey));Ut(i>=0,`Cannot sign with non signer key ${s.publicKey.toBase58()}`),this.signatures[i]=Li(e,s.secretKey)}}addSignature(t,e){Ut(e.byteLength===64,"Signature must be 64 bytes long");const s=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures).findIndex(i=>i.equals(t));Ut(s>=0,`Can not add signature; \`${t.toBase58()}\` is not required to sign this transaction`),this.signatures[s]=e}}const nc=160,ic=64,sc=nc/ic,io=1e3/sc,Pe=new C("SysvarC1ock11111111111111111111111111111111"),oc=new C("SysvarEpochSchedu1e111111111111111111111111"),ac=new C("Sysvar1nstructions1111111111111111111111111"),_n=new C("SysvarRecentB1ockHashes11111111111111111111"),Cr=new C("SysvarRent111111111111111111111111111111111"),cc=new C("SysvarRewards111111111111111111111111111111"),uc=new C("SysvarS1otHashes111111111111111111111111111"),hc=new C("SysvarS1otHistory11111111111111111111111111"),xn=new C("SysvarStakeHistory1111111111111111111111111");class dn extends Error{constructor({action:t,signature:e,transactionMessage:r,logs:s}){const i=s?`Logs: 
${JSON.stringify(s.slice(-10),null,2)}. `:"",u="\nCatch the `SendTransactionError` and call `getLogs()` on it for full details.";let m;switch(t){case"send":m=`Transaction ${e} resulted in an error. 
${r}. `+i+u;break;case"simulate":m=`Simulation failed. 
Message: ${r}. 
`+i+u;break;default:m=`Unknown action '${(w=>w)(t)}'`}super(m),this.signature=void 0,this.transactionMessage=void 0,this.transactionLogs=void 0,this.signature=e,this.transactionMessage=r,this.transactionLogs=s||void 0}get transactionError(){return{message:this.transactionMessage,logs:Array.isArray(this.transactionLogs)?this.transactionLogs:void 0}}get logs(){const t=this.transactionLogs;if(!(t!=null&&typeof t=="object"&&"then"in t))return t}async getLogs(t){return Array.isArray(this.transactionLogs)||(this.transactionLogs=new Promise((e,r)=>{t.getTransaction(this.signature).then(s=>{if(s&&s.meta&&s.meta.logMessages){const i=s.meta.logMessages;this.transactionLogs=i,e(i)}else r(new Error("Log messages not found"))}).catch(r)})),await this.transactionLogs}}const lc={JSON_RPC_SERVER_ERROR_BLOCK_CLEANED_UP:-32001,JSON_RPC_SERVER_ERROR_SEND_TRANSACTION_PREFLIGHT_FAILURE:-32002,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_VERIFICATION_FAILURE:-32003,JSON_RPC_SERVER_ERROR_BLOCK_NOT_AVAILABLE:-32004,JSON_RPC_SERVER_ERROR_NODE_UNHEALTHY:-32005,JSON_RPC_SERVER_ERROR_TRANSACTION_PRECOMPILE_VERIFICATION_FAILURE:-32006,JSON_RPC_SERVER_ERROR_SLOT_SKIPPED:-32007,JSON_RPC_SERVER_ERROR_NO_SNAPSHOT:-32008,JSON_RPC_SERVER_ERROR_LONG_TERM_STORAGE_SLOT_SKIPPED:-32009,JSON_RPC_SERVER_ERROR_KEY_EXCLUDED_FROM_SECONDARY_INDEX:-32010,JSON_RPC_SERVER_ERROR_TRANSACTION_HISTORY_NOT_AVAILABLE:-32011,JSON_RPC_SCAN_ERROR:-32012,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_LEN_MISMATCH:-32013,JSON_RPC_SERVER_ERROR_BLOCK_STATUS_NOT_AVAILABLE_YET:-32014,JSON_RPC_SERVER_ERROR_UNSUPPORTED_TRANSACTION_VERSION:-32015,JSON_RPC_SERVER_ERROR_MIN_CONTEXT_SLOT_NOT_REACHED:-32016};class F extends Error{constructor({code:t,message:e,data:r},s){super(s!=null?`${s}: ${e}`:e),this.code=void 0,this.data=void 0,this.code=t,this.data=r,this.name="SolanaJSONRPCError"}}async function hi(a,t,e,r){const s=r&&{skipPreflight:r.skipPreflight,preflightCommitment:r.preflightCommitment||r.commitment,maxRetries:r.maxRetries,minContextSlot:r.minContextSlot},i=await a.sendTransaction(t,e,s);let u;if(t.recentBlockhash!=null&&t.lastValidBlockHeight!=null)u=(await a.confirmTransaction({abortSignal:r==null?void 0:r.abortSignal,signature:i,blockhash:t.recentBlockhash,lastValidBlockHeight:t.lastValidBlockHeight},r&&r.commitment)).value;else if(t.minNonceContextSlot!=null&&t.nonceInfo!=null){const{nonceInstruction:m}=t.nonceInfo,w=m.keys[0].pubkey;u=(await a.confirmTransaction({abortSignal:r==null?void 0:r.abortSignal,minContextSlot:t.minNonceContextSlot,nonceAccountPubkey:w,nonceValue:t.nonceInfo.nonce,signature:i},r&&r.commitment)).value}else(r==null?void 0:r.abortSignal)!=null&&console.warn("sendAndConfirmTransaction(): A transaction with a deprecated confirmation strategy was supplied along with an `abortSignal`. Only transactions having `lastValidBlockHeight` or a combination of `nonceInfo` and `minNonceContextSlot` are abortable."),u=(await a.confirmTransaction(i,r&&r.commitment)).value;if(u.err)throw i!=null?new dn({action:"send",signature:i,transactionMessage:`Status: (${JSON.stringify(u)})`}):new Error(`Transaction ${i} failed (${JSON.stringify(u)})`);return i}function wr(a){return new Promise(t=>setTimeout(t,a))}function Nt(a,t){const e=a.layout.span>=0?a.layout.span:ro(a,t),r=$.alloc(e),s=Object.assign({instruction:a.index},t);return a.layout.encode(s,r),r}function Dt(a,t){let e;try{e=a.layout.decode(t)}catch(r){throw new Error("invalid instruction; "+r)}if(e.instruction!==a.index)throw new Error(`invalid instruction; instruction index mismatch ${e.instruction} != ${a.index}`);return e}const so=se("lamportsPerSignature"),oo=q([W("version"),W("state"),Ct("authorizedPubkey"),Ct("nonce"),q([so],"feeCalculator")]),li=oo.span;class Fn{constructor(t){this.authorizedPubkey=void 0,this.nonce=void 0,this.feeCalculator=void 0,this.authorizedPubkey=t.authorizedPubkey,this.nonce=t.nonce,this.feeCalculator=t.feeCalculator}static fromAccountData(t){const e=oo.decode(Bt(t),0);return new Fn({authorizedPubkey:new C(e.authorizedPubkey),nonce:new C(e.nonce).toString(),feeCalculator:e.feeCalculator})}}const fc=a=>{const t=a.decode.bind(a),e=a.encode.bind(a);return{decode:t,encode:e}},dc=a=>t=>{const e=jt(a,t),{encode:r,decode:s}=fc(e),i=e;return i.decode=(u,m)=>{const w=s(u,m);return ia($.from(w))},i.encode=(u,m,w)=>{const b=$s(u,a);return r(b,m,w)},i},Nr=dc(8);class pc{constructor(){}static decodeInstructionType(t){this.checkProgramId(t.programId);const r=W("instruction").decode(t.data);let s;for(const[i,u]of Object.entries(Gt))if(u.index==r){s=i;break}if(!s)throw new Error("Instruction type incorrect; not a SystemInstruction");return s}static decodeCreateAccount(t){this.checkProgramId(t.programId),this.checkKeyLength(t.keys,2);const{lamports:e,space:r,programId:s}=Dt(Gt.Create,t.data);return{fromPubkey:t.keys[0].pubkey,newAccountPubkey:t.keys[1].pubkey,lamports:e,space:r,programId:new C(s)}}static decodeTransfer(t){this.checkProgramId(t.programId),this.checkKeyLength(t.keys,2);const{lamports:e}=Dt(Gt.Transfer,t.data);return{fromPubkey:t.keys[0].pubkey,toPubkey:t.keys[1].pubkey,lamports:e}}static decodeTransferWithSeed(t){this.checkProgramId(t.programId),this.checkKeyLength(t.keys,3);const{lamports:e,seed:r,programId:s}=Dt(Gt.TransferWithSeed,t.data);return{fromPubkey:t.keys[0].pubkey,basePubkey:t.keys[1].pubkey,toPubkey:t.keys[2].pubkey,lamports:e,seed:r,programId:new C(s)}}static decodeAllocate(t){this.checkProgramId(t.programId),this.checkKeyLength(t.keys,1);const{space:e}=Dt(Gt.Allocate,t.data);return{accountPubkey:t.keys[0].pubkey,space:e}}static decodeAllocateWithSeed(t){this.checkProgramId(t.programId),this.checkKeyLength(t.keys,1);const{base:e,seed:r,space:s,programId:i}=Dt(Gt.AllocateWithSeed,t.data);return{accountPubkey:t.keys[0].pubkey,basePubkey:new C(e),seed:r,space:s,programId:new C(i)}}static decodeAssign(t){this.checkProgramId(t.programId),this.checkKeyLength(t.keys,1);const{programId:e}=Dt(Gt.Assign,t.data);return{accountPubkey:t.keys[0].pubkey,programId:new C(e)}}static decodeAssignWithSeed(t){this.checkProgramId(t.programId),this.checkKeyLength(t.keys,1);const{base:e,seed:r,programId:s}=Dt(Gt.AssignWithSeed,t.data);return{accountPubkey:t.keys[0].pubkey,basePubkey:new C(e),seed:r,programId:new C(s)}}static decodeCreateWithSeed(t){this.checkProgramId(t.programId),this.checkKeyLength(t.keys,2);const{base:e,seed:r,lamports:s,space:i,programId:u}=Dt(Gt.CreateWithSeed,t.data);return{fromPubkey:t.keys[0].pubkey,newAccountPubkey:t.keys[1].pubkey,basePubkey:new C(e),seed:r,lamports:s,space:i,programId:new C(u)}}static decodeNonceInitialize(t){this.checkProgramId(t.programId),this.checkKeyLength(t.keys,3);const{authorized:e}=Dt(Gt.InitializeNonceAccount,t.data);return{noncePubkey:t.keys[0].pubkey,authorizedPubkey:new C(e)}}static decodeNonceAdvance(t){return this.checkProgramId(t.programId),this.checkKeyLength(t.keys,3),Dt(Gt.AdvanceNonceAccount,t.data),{noncePubkey:t.keys[0].pubkey,authorizedPubkey:t.keys[2].pubkey}}static decodeNonceWithdraw(t){this.checkProgramId(t.programId),this.checkKeyLength(t.keys,5);const{lamports:e}=Dt(Gt.WithdrawNonceAccount,t.data);return{noncePubkey:t.keys[0].pubkey,toPubkey:t.keys[1].pubkey,authorizedPubkey:t.keys[4].pubkey,lamports:e}}static decodeNonceAuthorize(t){this.checkProgramId(t.programId),this.checkKeyLength(t.keys,2);const{authorized:e}=Dt(Gt.AuthorizeNonceAccount,t.data);return{noncePubkey:t.keys[0].pubkey,authorizedPubkey:t.keys[1].pubkey,newAuthorizedPubkey:new C(e)}}static checkProgramId(t){if(!t.equals(Jt.programId))throw new Error("invalid instruction; programId is not SystemProgram")}static checkKeyLength(t,e){if(t.length<e)throw new Error(`invalid instruction; found ${t.length} keys, expected at least ${e}`)}}const Gt=Object.freeze({Create:{index:0,layout:q([W("instruction"),be("lamports"),be("space"),Ct("programId")])},Assign:{index:1,layout:q([W("instruction"),Ct("programId")])},Transfer:{index:2,layout:q([W("instruction"),Nr("lamports")])},CreateWithSeed:{index:3,layout:q([W("instruction"),Ct("base"),vr("seed"),be("lamports"),be("space"),Ct("programId")])},AdvanceNonceAccount:{index:4,layout:q([W("instruction")])},WithdrawNonceAccount:{index:5,layout:q([W("instruction"),be("lamports")])},InitializeNonceAccount:{index:6,layout:q([W("instruction"),Ct("authorized")])},AuthorizeNonceAccount:{index:7,layout:q([W("instruction"),Ct("authorized")])},Allocate:{index:8,layout:q([W("instruction"),be("space")])},AllocateWithSeed:{index:9,layout:q([W("instruction"),Ct("base"),vr("seed"),be("space"),Ct("programId")])},AssignWithSeed:{index:10,layout:q([W("instruction"),Ct("base"),vr("seed"),Ct("programId")])},TransferWithSeed:{index:11,layout:q([W("instruction"),Nr("lamports"),vr("seed"),Ct("programId")])},UpgradeNonceAccount:{index:12,layout:q([W("instruction")])}});class Jt{constructor(){}static createAccount(t){const e=Gt.Create,r=Nt(e,{lamports:t.lamports,space:t.space,programId:Bt(t.programId.toBuffer())});return new $t({keys:[{pubkey:t.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:t.newAccountPubkey,isSigner:!0,isWritable:!0}],programId:this.programId,data:r})}static transfer(t){let e,r;if("basePubkey"in t){const s=Gt.TransferWithSeed;e=Nt(s,{lamports:BigInt(t.lamports),seed:t.seed,programId:Bt(t.programId.toBuffer())}),r=[{pubkey:t.fromPubkey,isSigner:!1,isWritable:!0},{pubkey:t.basePubkey,isSigner:!0,isWritable:!1},{pubkey:t.toPubkey,isSigner:!1,isWritable:!0}]}else{const s=Gt.Transfer;e=Nt(s,{lamports:BigInt(t.lamports)}),r=[{pubkey:t.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:t.toPubkey,isSigner:!1,isWritable:!0}]}return new $t({keys:r,programId:this.programId,data:e})}static assign(t){let e,r;if("basePubkey"in t){const s=Gt.AssignWithSeed;e=Nt(s,{base:Bt(t.basePubkey.toBuffer()),seed:t.seed,programId:Bt(t.programId.toBuffer())}),r=[{pubkey:t.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:t.basePubkey,isSigner:!0,isWritable:!1}]}else{const s=Gt.Assign;e=Nt(s,{programId:Bt(t.programId.toBuffer())}),r=[{pubkey:t.accountPubkey,isSigner:!0,isWritable:!0}]}return new $t({keys:r,programId:this.programId,data:e})}static createAccountWithSeed(t){const e=Gt.CreateWithSeed,r=Nt(e,{base:Bt(t.basePubkey.toBuffer()),seed:t.seed,lamports:t.lamports,space:t.space,programId:Bt(t.programId.toBuffer())});let s=[{pubkey:t.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:t.newAccountPubkey,isSigner:!1,isWritable:!0}];return t.basePubkey.equals(t.fromPubkey)||s.push({pubkey:t.basePubkey,isSigner:!0,isWritable:!1}),new $t({keys:s,programId:this.programId,data:r})}static createNonceAccount(t){const e=new Ot;"basePubkey"in t&&"seed"in t?e.add(Jt.createAccountWithSeed({fromPubkey:t.fromPubkey,newAccountPubkey:t.noncePubkey,basePubkey:t.basePubkey,seed:t.seed,lamports:t.lamports,space:li,programId:this.programId})):e.add(Jt.createAccount({fromPubkey:t.fromPubkey,newAccountPubkey:t.noncePubkey,lamports:t.lamports,space:li,programId:this.programId}));const r={noncePubkey:t.noncePubkey,authorizedPubkey:t.authorizedPubkey};return e.add(this.nonceInitialize(r)),e}static nonceInitialize(t){const e=Gt.InitializeNonceAccount,r=Nt(e,{authorized:Bt(t.authorizedPubkey.toBuffer())}),s={keys:[{pubkey:t.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:_n,isSigner:!1,isWritable:!1},{pubkey:Cr,isSigner:!1,isWritable:!1}],programId:this.programId,data:r};return new $t(s)}static nonceAdvance(t){const e=Gt.AdvanceNonceAccount,r=Nt(e),s={keys:[{pubkey:t.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:_n,isSigner:!1,isWritable:!1},{pubkey:t.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:r};return new $t(s)}static nonceWithdraw(t){const e=Gt.WithdrawNonceAccount,r=Nt(e,{lamports:t.lamports});return new $t({keys:[{pubkey:t.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:t.toPubkey,isSigner:!1,isWritable:!0},{pubkey:_n,isSigner:!1,isWritable:!1},{pubkey:Cr,isSigner:!1,isWritable:!1},{pubkey:t.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:r})}static nonceAuthorize(t){const e=Gt.AuthorizeNonceAccount,r=Nt(e,{authorized:Bt(t.newAuthorizedPubkey.toBuffer())});return new $t({keys:[{pubkey:t.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:t.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:r})}static allocate(t){let e,r;if("basePubkey"in t){const s=Gt.AllocateWithSeed;e=Nt(s,{base:Bt(t.basePubkey.toBuffer()),seed:t.seed,space:t.space,programId:Bt(t.programId.toBuffer())}),r=[{pubkey:t.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:t.basePubkey,isSigner:!0,isWritable:!1}]}else{const s=Gt.Allocate;e=Nt(s,{space:t.space}),r=[{pubkey:t.accountPubkey,isSigner:!0,isWritable:!0}]}return new $t({keys:r,programId:this.programId,data:e})}}Jt.programId=new C("11111111111111111111111111111111");const gc=Ge-300;class kr{constructor(){}static getMinNumSignatures(t){return 2*(Math.ceil(t/kr.chunkSize)+1+1)}static async load(t,e,r,s,i){{const x=await t.getMinimumBalanceForRentExemption(i.length),L=await t.getAccountInfo(r.publicKey,"confirmed");let _=null;if(L!==null){if(L.executable)return console.error("Program load failed, account is already executable"),!1;L.data.length!==i.length&&(_=_||new Ot,_.add(Jt.allocate({accountPubkey:r.publicKey,space:i.length}))),L.owner.equals(s)||(_=_||new Ot,_.add(Jt.assign({accountPubkey:r.publicKey,programId:s}))),L.lamports<x&&(_=_||new Ot,_.add(Jt.transfer({fromPubkey:e.publicKey,toPubkey:r.publicKey,lamports:x-L.lamports})))}else _=new Ot().add(Jt.createAccount({fromPubkey:e.publicKey,newAccountPubkey:r.publicKey,lamports:x>0?x:1,space:i.length,programId:s}));_!==null&&await hi(t,_,[e,r],{commitment:"confirmed"})}const u=q([W("instruction"),W("offset"),W("bytesLength"),W("bytesLengthPadding"),ce(Kt("byte"),He(W(),-8),"bytes")]),m=kr.chunkSize;let w=0,b=i,M=[];for(;b.length>0;){const x=b.slice(0,m),L=$.alloc(m+16);u.encode({instruction:0,offset:w,bytes:x,bytesLength:0,bytesLengthPadding:0},L);const _=new Ot().add({keys:[{pubkey:r.publicKey,isSigner:!0,isWritable:!0}],programId:s,data:L});M.push(hi(t,_,[e,r],{commitment:"confirmed"})),t._rpcEndpoint.includes("solana.com")&&await wr(1e3/4),w+=m,b=b.slice(m)}await Promise.all(M);{const x=q([W("instruction")]),L=$.alloc(x.span);x.encode({instruction:1},L);const _=new Ot().add({keys:[{pubkey:r.publicKey,isSigner:!0,isWritable:!0},{pubkey:Cr,isSigner:!1,isWritable:!1}],programId:s,data:L}),E="processed",A=await t.sendTransaction(_,[e,r],{preflightCommitment:E}),{context:N,value:U}=await t.confirmTransaction({signature:A,lastValidBlockHeight:_.lastValidBlockHeight,blockhash:_.recentBlockhash},E);if(U.err)throw new Error(`Transaction ${A} failed (${JSON.stringify(U)})`);for(;;){try{if(await t.getSlot({commitment:E})>N.slot)break}catch{}await new Promise(G=>setTimeout(G,Math.round(io/2)))}}return!0}}kr.chunkSize=gc;const mc=new C("BPFLoader2111111111111111111111111111111111");class yc{static getMinNumSignatures(t){return kr.getMinNumSignatures(t)}static load(t,e,r,s,i){return kr.load(t,e,r,i,s)}}function wc(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var ni,rs;function vc(){if(rs)return ni;rs=1;var a=Object.prototype.toString,t=Object.keys||function(r){var s=[];for(var i in r)s.push(i);return s};function e(r,s){var i,u,m,w,b,M,x;if(r===!0)return"true";if(r===!1)return"false";switch(typeof r){case"object":if(r===null)return null;if(r.toJSON&&typeof r.toJSON=="function")return e(r.toJSON(),s);if(x=a.call(r),x==="[object Array]"){for(m="[",u=r.length-1,i=0;i<u;i++)m+=e(r[i],!0)+",";return u>-1&&(m+=e(r[i],!0)),m+"]"}else if(x==="[object Object]"){for(w=t(r).sort(),u=w.length,m="",i=0;i<u;)b=w[i],M=e(r[b],!1),M!==void 0&&(m&&(m+=","),m+=JSON.stringify(b)+":"+M),i++;return"{"+m+"}"}else return JSON.stringify(r);case"function":case"undefined":return s?null:void 0;case"string":return JSON.stringify(r);default:return isFinite(r)?r:null}}return ni=function(r){var s=e(r,!1);if(s!==void 0)return""+s},ni}var bc=vc(),ns=wc(bc);const cn=32;function ii(a){let t=0;for(;a>1;)a/=2,t++;return t}function kc(a){return a===0?1:(a--,a|=a>>1,a|=a>>2,a|=a>>4,a|=a>>8,a|=a>>16,a|=a>>32,a+1)}class ao{constructor(t,e,r,s,i){this.slotsPerEpoch=void 0,this.leaderScheduleSlotOffset=void 0,this.warmup=void 0,this.firstNormalEpoch=void 0,this.firstNormalSlot=void 0,this.slotsPerEpoch=t,this.leaderScheduleSlotOffset=e,this.warmup=r,this.firstNormalEpoch=s,this.firstNormalSlot=i}getEpoch(t){return this.getEpochAndSlotIndex(t)[0]}getEpochAndSlotIndex(t){if(t<this.firstNormalSlot){const e=ii(kc(t+cn+1))-ii(cn)-1,r=this.getSlotsInEpoch(e),s=t-(r-cn);return[e,s]}else{const e=t-this.firstNormalSlot,r=Math.floor(e/this.slotsPerEpoch),s=this.firstNormalEpoch+r,i=e%this.slotsPerEpoch;return[s,i]}}getFirstSlotInEpoch(t){return t<=this.firstNormalEpoch?(Math.pow(2,t)-1)*cn:(t-this.firstNormalEpoch)*this.slotsPerEpoch+this.firstNormalSlot}getLastSlotInEpoch(t){return this.getFirstSlotInEpoch(t)+this.getSlotsInEpoch(t)-1}getSlotsInEpoch(t){return t<this.firstNormalEpoch?Math.pow(2,t+ii(cn)):this.slotsPerEpoch}}var Sc=globalThis.fetch;class Mc extends Va{constructor(t,e,r){const s=i=>{const u=Fa(i,{autoconnect:!0,max_reconnects:5,reconnect:!0,reconnect_interval:1e3,...e});return"socket"in u?this.underlyingSocket=u.socket:this.underlyingSocket=u,u};super(s,t,e,r),this.underlyingSocket=void 0}call(...t){var r;const e=(r=this.underlyingSocket)==null?void 0:r.readyState;return e===1?super.call(...t):Promise.reject(new Error("Tried to call a JSON-RPC method `"+t[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+e+")"))}notify(...t){var r;const e=(r=this.underlyingSocket)==null?void 0:r.readyState;return e===1?super.notify(...t):Promise.reject(new Error("Tried to send a JSON-RPC notification `"+t[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+e+")"))}}function _c(a,t){let e;try{e=a.layout.decode(t)}catch(r){throw new Error("invalid instruction; "+r)}if(e.typeIndex!==a.index)throw new Error(`invalid account data; account type mismatch ${e.typeIndex} != ${a.index}`);return e}const is=56;class fi{constructor(t){this.key=void 0,this.state=void 0,this.key=t.key,this.state=t.state}isActive(){const t=BigInt("0xffffffffffffffff");return this.state.deactivationSlot===t}static deserialize(t){const e=_c(xc,t),r=t.length-is;Ut(r>=0,"lookup table is invalid"),Ut(r%32===0,"lookup table is invalid");const s=r/32,{addresses:i}=q([ce(Ct(),s,"addresses")]).decode(t.slice(is));return{deactivationSlot:e.deactivationSlot,lastExtendedSlot:e.lastExtendedSlot,lastExtendedSlotStartIndex:e.lastExtendedStartIndex,authority:e.authority.length!==0?new C(e.authority[0]):void 0,addresses:i.map(u=>new C(u))}}}const xc={index:1,layout:q([W("typeIndex"),Nr("deactivationSlot"),se("lastExtendedSlot"),Kt("lastExtendedStartIndex"),Kt(),ce(Ct(),He(Kt(),-1),"authority")])},Ic=/^[^:]+:\/\/([^:[]+|\[[^\]]+\])(:\d+)?(.*)/i;function Ac(a){const t=a.match(Ic);if(t==null)throw TypeError(`Failed to validate endpoint URL \`${a}\``);const[e,r,s,i]=t,u=a.startsWith("https:")?"wss:":"ws:",m=s==null?null:parseInt(s.slice(1),10),w=m==null?"":`:${m+1}`;return`${u}//${r}${w}${i}`}const Yt=vn(Ti(C),B(),a=>new C(a)),co=Bi([B(),Zt("base64")]),Ki=vn(Ti($),co,a=>$.from(a[0],"base64")),uo=30*1e3;function Ec(a){if(/^https?:/.test(a)===!1)throw new TypeError("Endpoint URL must start with `http:` or `https:`.");return a}function Ht(a){let t,e;if(typeof a=="string")t=a;else if(a){const{commitment:r,...s}=a;t=r,e=s}return{commitment:t,config:e}}function ss(a){return a.map(t=>"memcmp"in t?{...t,memcmp:{...t.memcmp,encoding:t.memcmp.encoding??"base58"}}:t)}function ho(a){return me([I({jsonrpc:Zt("2.0"),id:B(),result:a}),I({jsonrpc:Zt("2.0"),id:B(),error:I({code:Ur(),message:B(),data:D(da())})})])}const Rc=ho(Ur());function Tt(a){return vn(ho(a),Rc,t=>"error"in t?t:{...t,result:O(t.result,a)})}function Xt(a){return Tt(I({context:I({slot:k()}),value:a}))}function Dn(a){return I({context:I({slot:k()}),value:a})}function si(a,t){return a===0?new br({header:t.header,staticAccountKeys:t.accountKeys.map(e=>new C(e)),recentBlockhash:t.recentBlockhash,compiledInstructions:t.instructions.map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:ae.decode(e.data)})),addressTableLookups:t.addressTableLookups}):new Ae(t)}const Pc=I({foundation:k(),foundationTerm:k(),initial:k(),taper:k(),terminal:k()}),Tc=Tt(z(K(I({epoch:k(),effectiveSlot:k(),amount:k(),postBalance:k(),commission:D(K(k()))})))),Bc=z(I({slot:k(),prioritizationFee:k()})),Lc=I({total:k(),validator:k(),foundation:k(),epoch:k()}),Cc=I({epoch:k(),slotIndex:k(),slotsInEpoch:k(),absoluteSlot:k(),blockHeight:D(k()),transactionCount:D(k())}),Nc=I({slotsPerEpoch:k(),leaderScheduleSlotOffset:k(),warmup:Ne(),firstNormalEpoch:k(),firstNormalSlot:k()}),Oc=js(B(),z(k())),_r=K(me([I({}),B()])),zc=I({err:_r}),Kc=Zt("receivedSignature"),Uc=I({"solana-core":B(),"feature-set":D(k())}),Wc=I({program:B(),programId:Yt,parsed:Ur()}),qc=I({programId:Yt,accounts:z(Yt),data:B()}),os=Xt(I({err:K(me([I({}),B()])),logs:K(z(B())),accounts:D(K(z(K(I({executable:Ne(),owner:B(),lamports:k(),data:z(B()),rentEpoch:D(k())}))))),unitsConsumed:D(k()),returnData:D(K(I({programId:B(),data:Bi([B(),Zt("base64")])}))),innerInstructions:D(K(z(I({index:k(),instructions:z(me([Wc,qc]))}))))})),Fc=Xt(I({byIdentity:js(B(),z(k())),range:I({firstSlot:k(),lastSlot:k()})}));function Dc(a,t,e,r,s,i){const u=e||Sc;let m;i!=null&&console.warn("You have supplied an `httpAgent` when creating a `Connection` in a browser environment.It has been ignored; `httpAgent` is only used in Node environments.");let w;return r&&(w=async(M,x)=>{const L=await new Promise((_,E)=>{try{r(M,x,(A,N)=>_([A,N]))}catch(A){E(A)}});return await u(...L)}),new Wa(async(M,x)=>{const L={method:"POST",body:M,agent:m,headers:Object.assign({"Content-Type":"application/json"},t||{},Vu)};try{let _=5,E,A=500;for(;w?E=await w(a,L):E=await u(a,L),!(E.status!==429||s===!0||(_-=1,_===0));)console.error(`Server responded with ${E.status} ${E.statusText}.  Retrying after ${A}ms delay...`),await wr(A),A*=2;const N=await E.text();E.ok?x(null,N):x(new Error(`${E.status} ${E.statusText}: ${N}`))}catch(_){_ instanceof Error&&x(_)}},{})}function Vc(a){return(t,e)=>new Promise((r,s)=>{a.request(t,e,(i,u)=>{if(i){s(i);return}r(u)})})}function $c(a){return t=>new Promise((e,r)=>{t.length===0&&e([]);const s=t.map(i=>a.request(i.methodName,i.args));a.request(s,(i,u)=>{if(i){r(i);return}e(u)})})}const Hc=Tt(Pc),Gc=Tt(Lc),jc=Tt(Bc),Jc=Tt(Cc),Zc=Tt(Nc),Yc=Tt(Oc),Xc=Tt(k()),Qc=Xt(I({total:k(),circulating:k(),nonCirculating:k(),nonCirculatingAccounts:z(Yt)})),di=I({amount:B(),uiAmount:K(k()),decimals:k(),uiAmountString:D(B())}),tu=Xt(z(I({address:Yt,amount:B(),uiAmount:K(k()),decimals:k(),uiAmountString:D(B())}))),eu=Xt(z(I({pubkey:Yt,account:I({executable:Ne(),owner:Yt,lamports:k(),data:Ki,rentEpoch:k()})}))),pi=I({program:B(),parsed:Ur(),space:k()}),ru=Xt(z(I({pubkey:Yt,account:I({executable:Ne(),owner:Yt,lamports:k(),data:pi,rentEpoch:k()})}))),nu=Xt(z(I({lamports:k(),address:Yt}))),pn=I({executable:Ne(),owner:Yt,lamports:k(),data:Ki,rentEpoch:k()}),iu=I({pubkey:Yt,account:pn}),su=vn(me([Ti($),pi]),me([co,pi]),a=>Array.isArray(a)?O(a,Ki):a),gi=I({executable:Ne(),owner:Yt,lamports:k(),data:su,rentEpoch:k()}),ou=I({pubkey:Yt,account:gi}),au=I({state:me([Zt("active"),Zt("inactive"),Zt("activating"),Zt("deactivating")]),active:k(),inactive:k()}),cu=Tt(z(I({signature:B(),slot:k(),err:_r,memo:K(B()),blockTime:D(K(k()))}))),uu=Tt(z(I({signature:B(),slot:k(),err:_r,memo:K(B()),blockTime:D(K(k()))}))),hu=I({subscription:k(),result:Dn(pn)}),lu=I({pubkey:Yt,account:pn}),fu=I({subscription:k(),result:Dn(lu)}),du=I({parent:k(),slot:k(),root:k()}),pu=I({subscription:k(),result:du}),gu=me([I({type:me([Zt("firstShredReceived"),Zt("completed"),Zt("optimisticConfirmation"),Zt("root")]),slot:k(),timestamp:k()}),I({type:Zt("createdBank"),parent:k(),slot:k(),timestamp:k()}),I({type:Zt("frozen"),slot:k(),timestamp:k(),stats:I({numTransactionEntries:k(),numSuccessfulTransactions:k(),numFailedTransactions:k(),maxTransactionsPerEntry:k()})}),I({type:Zt("dead"),slot:k(),timestamp:k(),err:B()})]),mu=I({subscription:k(),result:gu}),yu=I({subscription:k(),result:Dn(me([zc,Kc]))}),wu=I({subscription:k(),result:k()}),vu=I({pubkey:B(),gossip:K(B()),tpu:K(B()),rpc:K(B()),version:K(B())}),as=I({votePubkey:B(),nodePubkey:B(),activatedStake:k(),epochVoteAccount:Ne(),epochCredits:z(Bi([k(),k(),k()])),commission:k(),lastVote:k(),rootSlot:K(k())}),bu=Tt(I({current:z(as),delinquent:z(as)})),ku=me([Zt("processed"),Zt("confirmed"),Zt("finalized")]),Su=I({slot:k(),confirmations:K(k()),err:_r,confirmationStatus:D(ku)}),Mu=Xt(z(K(Su))),_u=Tt(k()),lo=I({accountKey:Yt,writableIndexes:z(k()),readonlyIndexes:z(k())}),Ui=I({signatures:z(B()),message:I({accountKeys:z(B()),header:I({numRequiredSignatures:k(),numReadonlySignedAccounts:k(),numReadonlyUnsignedAccounts:k()}),instructions:z(I({accounts:z(k()),data:B(),programIdIndex:k()})),recentBlockhash:B(),addressTableLookups:D(z(lo))})}),fo=I({pubkey:Yt,signer:Ne(),writable:Ne(),source:D(me([Zt("transaction"),Zt("lookupTable")]))}),po=I({accountKeys:z(fo),signatures:z(B())}),go=I({parsed:Ur(),program:B(),programId:Yt}),mo=I({accounts:z(Yt),data:B(),programId:Yt}),xu=me([mo,go]),Iu=me([I({parsed:Ur(),program:B(),programId:B()}),I({accounts:z(B()),data:B(),programId:B()})]),yo=vn(xu,Iu,a=>"accounts"in a?O(a,mo):O(a,go)),wo=I({signatures:z(B()),message:I({accountKeys:z(fo),instructions:z(yo),recentBlockhash:B(),addressTableLookups:D(K(z(lo)))})}),Ln=I({accountIndex:k(),mint:B(),owner:D(B()),programId:D(B()),uiTokenAmount:di}),vo=I({writable:z(Yt),readonly:z(Yt)}),Vn=I({err:_r,fee:k(),innerInstructions:D(K(z(I({index:k(),instructions:z(I({accounts:z(k()),data:B(),programIdIndex:k()}))})))),preBalances:z(k()),postBalances:z(k()),logMessages:D(K(z(B()))),preTokenBalances:D(K(z(Ln))),postTokenBalances:D(K(z(Ln))),loadedAddresses:D(vo),computeUnitsConsumed:D(k())}),Wi=I({err:_r,fee:k(),innerInstructions:D(K(z(I({index:k(),instructions:z(yo)})))),preBalances:z(k()),postBalances:z(k()),logMessages:D(K(z(B()))),preTokenBalances:D(K(z(Ln))),postTokenBalances:D(K(z(Ln))),loadedAddresses:D(vo),computeUnitsConsumed:D(k())}),Wr=me([Zt(0),Zt("legacy")]),xr=I({pubkey:B(),lamports:k(),postBalance:K(k()),rewardType:K(B()),commission:D(K(k()))}),Au=Tt(K(I({blockhash:B(),previousBlockhash:B(),parentSlot:k(),transactions:z(I({transaction:Ui,meta:K(Vn),version:D(Wr)})),rewards:D(z(xr)),blockTime:K(k()),blockHeight:K(k())}))),Eu=Tt(K(I({blockhash:B(),previousBlockhash:B(),parentSlot:k(),rewards:D(z(xr)),blockTime:K(k()),blockHeight:K(k())}))),Ru=Tt(K(I({blockhash:B(),previousBlockhash:B(),parentSlot:k(),transactions:z(I({transaction:po,meta:K(Vn),version:D(Wr)})),rewards:D(z(xr)),blockTime:K(k()),blockHeight:K(k())}))),Pu=Tt(K(I({blockhash:B(),previousBlockhash:B(),parentSlot:k(),transactions:z(I({transaction:wo,meta:K(Wi),version:D(Wr)})),rewards:D(z(xr)),blockTime:K(k()),blockHeight:K(k())}))),Tu=Tt(K(I({blockhash:B(),previousBlockhash:B(),parentSlot:k(),transactions:z(I({transaction:po,meta:K(Wi),version:D(Wr)})),rewards:D(z(xr)),blockTime:K(k()),blockHeight:K(k())}))),Bu=Tt(K(I({blockhash:B(),previousBlockhash:B(),parentSlot:k(),rewards:D(z(xr)),blockTime:K(k()),blockHeight:K(k())}))),Lu=Tt(K(I({blockhash:B(),previousBlockhash:B(),parentSlot:k(),transactions:z(I({transaction:Ui,meta:K(Vn)})),rewards:D(z(xr)),blockTime:K(k())}))),cs=Tt(K(I({blockhash:B(),previousBlockhash:B(),parentSlot:k(),signatures:z(B()),blockTime:K(k())}))),oi=Tt(K(I({slot:k(),meta:K(Vn),blockTime:D(K(k())),transaction:Ui,version:D(Wr)}))),Sn=Tt(K(I({slot:k(),transaction:wo,meta:K(Wi),blockTime:D(K(k())),version:D(Wr)}))),Cu=Xt(I({blockhash:B(),feeCalculator:I({lamportsPerSignature:k()})})),Nu=Xt(I({blockhash:B(),lastValidBlockHeight:k()})),Ou=Xt(Ne()),zu=I({slot:k(),numTransactions:k(),numSlots:k(),samplePeriodSecs:k()}),Ku=Tt(z(zu)),Uu=Xt(K(I({feeCalculator:I({lamportsPerSignature:k()})}))),Wu=Tt(B()),qu=Tt(B()),Fu=I({err:_r,logs:z(B()),signature:B()}),Du=I({result:Dn(Fu),subscription:k()}),Vu={"solana-client":"js/1.95.8"};class bo{constructor(t,e){this._commitment=void 0,this._confirmTransactionInitialTimeout=void 0,this._rpcEndpoint=void 0,this._rpcWsEndpoint=void 0,this._rpcClient=void 0,this._rpcRequest=void 0,this._rpcBatchRequest=void 0,this._rpcWebSocket=void 0,this._rpcWebSocketConnected=!1,this._rpcWebSocketHeartbeat=null,this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketGeneration=0,this._disableBlockhashCaching=!1,this._pollingBlockhash=!1,this._blockhashInfo={latestBlockhash:null,lastFetch:0,transactionSignatures:[],simulatedSignatures:[]},this._nextClientSubscriptionId=0,this._subscriptionDisposeFunctionsByClientSubscriptionId={},this._subscriptionHashByClientSubscriptionId={},this._subscriptionStateChangeCallbacksByHash={},this._subscriptionCallbacksByServerSubscriptionId={},this._subscriptionsByHash={},this._subscriptionsAutoDisposedByRpc=new Set,this.getBlockHeight=(()=>{const b={};return async M=>{const{commitment:x,config:L}=Ht(M),_=this._buildArgs([],x,void 0,L),E=ns(_);return b[E]=b[E]??(async()=>{try{const A=await this._rpcRequest("getBlockHeight",_),N=O(A,Tt(k()));if("error"in N)throw new F(N.error,"failed to get block height information");return N.result}finally{delete b[E]}})(),await b[E]}})();let r,s,i,u,m,w;e&&typeof e=="string"?this._commitment=e:e&&(this._commitment=e.commitment,this._confirmTransactionInitialTimeout=e.confirmTransactionInitialTimeout,r=e.wsEndpoint,s=e.httpHeaders,i=e.fetch,u=e.fetchMiddleware,m=e.disableRetryOnRateLimit,w=e.httpAgent),this._rpcEndpoint=Ec(t),this._rpcWsEndpoint=r||Ac(t),this._rpcClient=Dc(t,s,i,u,m,w),this._rpcRequest=Vc(this._rpcClient),this._rpcBatchRequest=$c(this._rpcClient),this._rpcWebSocket=new Mc(this._rpcWsEndpoint,{autoconnect:!1,max_reconnects:1/0}),this._rpcWebSocket.on("open",this._wsOnOpen.bind(this)),this._rpcWebSocket.on("error",this._wsOnError.bind(this)),this._rpcWebSocket.on("close",this._wsOnClose.bind(this)),this._rpcWebSocket.on("accountNotification",this._wsOnAccountNotification.bind(this)),this._rpcWebSocket.on("programNotification",this._wsOnProgramAccountNotification.bind(this)),this._rpcWebSocket.on("slotNotification",this._wsOnSlotNotification.bind(this)),this._rpcWebSocket.on("slotsUpdatesNotification",this._wsOnSlotUpdatesNotification.bind(this)),this._rpcWebSocket.on("signatureNotification",this._wsOnSignatureNotification.bind(this)),this._rpcWebSocket.on("rootNotification",this._wsOnRootNotification.bind(this)),this._rpcWebSocket.on("logsNotification",this._wsOnLogsNotification.bind(this))}get commitment(){return this._commitment}get rpcEndpoint(){return this._rpcEndpoint}async getBalanceAndContext(t,e){const{commitment:r,config:s}=Ht(e),i=this._buildArgs([t.toBase58()],r,void 0,s),u=await this._rpcRequest("getBalance",i),m=O(u,Xt(k()));if("error"in m)throw new F(m.error,`failed to get balance for ${t.toBase58()}`);return m.result}async getBalance(t,e){return await this.getBalanceAndContext(t,e).then(r=>r.value).catch(r=>{throw new Error("failed to get balance of account "+t.toBase58()+": "+r)})}async getBlockTime(t){const e=await this._rpcRequest("getBlockTime",[t]),r=O(e,Tt(K(k())));if("error"in r)throw new F(r.error,`failed to get block time for slot ${t}`);return r.result}async getMinimumLedgerSlot(){const t=await this._rpcRequest("minimumLedgerSlot",[]),e=O(t,Tt(k()));if("error"in e)throw new F(e.error,"failed to get minimum ledger slot");return e.result}async getFirstAvailableBlock(){const t=await this._rpcRequest("getFirstAvailableBlock",[]),e=O(t,Xc);if("error"in e)throw new F(e.error,"failed to get first available block");return e.result}async getSupply(t){let e={};typeof t=="string"?e={commitment:t}:t?e={...t,commitment:t&&t.commitment||this.commitment}:e={commitment:this.commitment};const r=await this._rpcRequest("getSupply",[e]),s=O(r,Qc);if("error"in s)throw new F(s.error,"failed to get supply");return s.result}async getTokenSupply(t,e){const r=this._buildArgs([t.toBase58()],e),s=await this._rpcRequest("getTokenSupply",r),i=O(s,Xt(di));if("error"in i)throw new F(i.error,"failed to get token supply");return i.result}async getTokenAccountBalance(t,e){const r=this._buildArgs([t.toBase58()],e),s=await this._rpcRequest("getTokenAccountBalance",r),i=O(s,Xt(di));if("error"in i)throw new F(i.error,"failed to get token account balance");return i.result}async getTokenAccountsByOwner(t,e,r){const{commitment:s,config:i}=Ht(r);let u=[t.toBase58()];"mint"in e?u.push({mint:e.mint.toBase58()}):u.push({programId:e.programId.toBase58()});const m=this._buildArgs(u,s,"base64",i),w=await this._rpcRequest("getTokenAccountsByOwner",m),b=O(w,eu);if("error"in b)throw new F(b.error,`failed to get token accounts owned by account ${t.toBase58()}`);return b.result}async getParsedTokenAccountsByOwner(t,e,r){let s=[t.toBase58()];"mint"in e?s.push({mint:e.mint.toBase58()}):s.push({programId:e.programId.toBase58()});const i=this._buildArgs(s,r,"jsonParsed"),u=await this._rpcRequest("getTokenAccountsByOwner",i),m=O(u,ru);if("error"in m)throw new F(m.error,`failed to get token accounts owned by account ${t.toBase58()}`);return m.result}async getLargestAccounts(t){const e={...t,commitment:t&&t.commitment||this.commitment},r=e.filter||e.commitment?[e]:[],s=await this._rpcRequest("getLargestAccounts",r),i=O(s,nu);if("error"in i)throw new F(i.error,"failed to get largest accounts");return i.result}async getTokenLargestAccounts(t,e){const r=this._buildArgs([t.toBase58()],e),s=await this._rpcRequest("getTokenLargestAccounts",r),i=O(s,tu);if("error"in i)throw new F(i.error,"failed to get token largest accounts");return i.result}async getAccountInfoAndContext(t,e){const{commitment:r,config:s}=Ht(e),i=this._buildArgs([t.toBase58()],r,"base64",s),u=await this._rpcRequest("getAccountInfo",i),m=O(u,Xt(K(pn)));if("error"in m)throw new F(m.error,`failed to get info about account ${t.toBase58()}`);return m.result}async getParsedAccountInfo(t,e){const{commitment:r,config:s}=Ht(e),i=this._buildArgs([t.toBase58()],r,"jsonParsed",s),u=await this._rpcRequest("getAccountInfo",i),m=O(u,Xt(K(gi)));if("error"in m)throw new F(m.error,`failed to get info about account ${t.toBase58()}`);return m.result}async getAccountInfo(t,e){try{return(await this.getAccountInfoAndContext(t,e)).value}catch(r){throw new Error("failed to get info about account "+t.toBase58()+": "+r)}}async getMultipleParsedAccounts(t,e){const{commitment:r,config:s}=Ht(e),i=t.map(b=>b.toBase58()),u=this._buildArgs([i],r,"jsonParsed",s),m=await this._rpcRequest("getMultipleAccounts",u),w=O(m,Xt(z(K(gi))));if("error"in w)throw new F(w.error,`failed to get info for accounts ${i}`);return w.result}async getMultipleAccountsInfoAndContext(t,e){const{commitment:r,config:s}=Ht(e),i=t.map(b=>b.toBase58()),u=this._buildArgs([i],r,"base64",s),m=await this._rpcRequest("getMultipleAccounts",u),w=O(m,Xt(z(K(pn))));if("error"in w)throw new F(w.error,`failed to get info for accounts ${i}`);return w.result}async getMultipleAccountsInfo(t,e){return(await this.getMultipleAccountsInfoAndContext(t,e)).value}async getStakeActivation(t,e,r){const{commitment:s,config:i}=Ht(e),u=this._buildArgs([t.toBase58()],s,void 0,{...i,epoch:r??(i==null?void 0:i.epoch)}),m=await this._rpcRequest("getStakeActivation",u),w=O(m,Tt(au));if("error"in w)throw new F(w.error,`failed to get Stake Activation ${t.toBase58()}`);return w.result}async getProgramAccounts(t,e){const{commitment:r,config:s}=Ht(e),{encoding:i,...u}=s||{},m=this._buildArgs([t.toBase58()],r,i||"base64",{...u,...u.filters?{filters:ss(u.filters)}:null}),w=await this._rpcRequest("getProgramAccounts",m),b=z(iu),M=u.withContext===!0?O(w,Xt(b)):O(w,Tt(b));if("error"in M)throw new F(M.error,`failed to get accounts owned by program ${t.toBase58()}`);return M.result}async getParsedProgramAccounts(t,e){const{commitment:r,config:s}=Ht(e),i=this._buildArgs([t.toBase58()],r,"jsonParsed",s),u=await this._rpcRequest("getProgramAccounts",i),m=O(u,Tt(z(ou)));if("error"in m)throw new F(m.error,`failed to get accounts owned by program ${t.toBase58()}`);return m.result}async confirmTransaction(t,e){var i;let r;if(typeof t=="string")r=t;else{const u=t;if((i=u.abortSignal)!=null&&i.aborted)return Promise.reject(u.abortSignal.reason);r=u.signature}let s;try{s=ae.decode(r)}catch{throw new Error("signature must be base58 encoded: "+r)}return Ut(s.length===64,"signature has invalid length"),typeof t=="string"?await this.confirmTransactionUsingLegacyTimeoutStrategy({commitment:e||this.commitment,signature:r}):"lastValidBlockHeight"in t?await this.confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:e||this.commitment,strategy:t}):await this.confirmTransactionUsingDurableNonceStrategy({commitment:e||this.commitment,strategy:t})}getCancellationPromise(t){return new Promise((e,r)=>{t!=null&&(t.aborted?r(t.reason):t.addEventListener("abort",()=>{r(t.reason)}))})}getTransactionConfirmationPromise({commitment:t,signature:e}){let r,s,i=!1;const u=new Promise((w,b)=>{try{r=this.onSignature(e,(x,L)=>{r=void 0;const _={context:L,value:x};w({__type:qe.PROCESSED,response:_})},t);const M=new Promise(x=>{r==null?x():s=this._onSubscriptionStateChange(r,L=>{L==="subscribed"&&x()})});(async()=>{if(await M,i)return;const x=await this.getSignatureStatus(e);if(i||x==null)return;const{context:L,value:_}=x;if(_!=null)if(_!=null&&_.err)b(_.err);else{switch(t){case"confirmed":case"single":case"singleGossip":{if(_.confirmationStatus==="processed")return;break}case"finalized":case"max":case"root":{if(_.confirmationStatus==="processed"||_.confirmationStatus==="confirmed")return;break}case"processed":case"recent":}i=!0,w({__type:qe.PROCESSED,response:{context:L,value:_}})}})()}catch(M){b(M)}});return{abortConfirmation:()=>{s&&(s(),s=void 0),r!=null&&(this.removeSignatureListener(r),r=void 0)},confirmationPromise:u}}async confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:t,strategy:{abortSignal:e,lastValidBlockHeight:r,signature:s}}){let i=!1;const u=new Promise(x=>{const L=async()=>{try{return await this.getBlockHeight(t)}catch{return-1}};(async()=>{let _=await L();if(!i){for(;_<=r;)if(await wr(1e3),i||(_=await L(),i))return;x({__type:qe.BLOCKHEIGHT_EXCEEDED})}})()}),{abortConfirmation:m,confirmationPromise:w}=this.getTransactionConfirmationPromise({commitment:t,signature:s}),b=this.getCancellationPromise(e);let M;try{const x=await Promise.race([b,w,u]);if(x.__type===qe.PROCESSED)M=x.response;else throw new Ni(s)}finally{i=!0,m()}return M}async confirmTransactionUsingDurableNonceStrategy({commitment:t,strategy:{abortSignal:e,minContextSlot:r,nonceAccountPubkey:s,nonceValue:i,signature:u}}){let m=!1;const w=new Promise(_=>{let E=i,A=null;const N=async()=>{try{const{context:U,value:G}=await this.getNonceAndContext(s,{commitment:t,minContextSlot:r});return A=U.slot,G==null?void 0:G.nonce}catch{return E}};(async()=>{if(E=await N(),!m)for(;;){if(i!==E){_({__type:qe.NONCE_INVALID,slotInWhichNonceDidAdvance:A});return}if(await wr(2e3),m||(E=await N(),m))return}})()}),{abortConfirmation:b,confirmationPromise:M}=this.getTransactionConfirmationPromise({commitment:t,signature:u}),x=this.getCancellationPromise(e);let L;try{const _=await Promise.race([x,M,w]);if(_.__type===qe.PROCESSED)L=_.response;else{let E;for(;;){const A=await this.getSignatureStatus(u);if(A==null)break;if(A.context.slot<(_.slotInWhichNonceDidAdvance??r)){await wr(400);continue}E=A;break}if(E!=null&&E.value){const A=t||"finalized",{confirmationStatus:N}=E.value;switch(A){case"processed":case"recent":if(N!=="processed"&&N!=="confirmed"&&N!=="finalized")throw new Er(u);break;case"confirmed":case"single":case"singleGossip":if(N!=="confirmed"&&N!=="finalized")throw new Er(u);break;case"finalized":case"max":case"root":if(N!=="finalized")throw new Er(u);break;default:}L={context:E.context,value:{err:E.value.err}}}else throw new Er(u)}}finally{m=!0,b()}return L}async confirmTransactionUsingLegacyTimeoutStrategy({commitment:t,signature:e}){let r;const s=new Promise(w=>{let b=this._confirmTransactionInitialTimeout||6e4;switch(t){case"processed":case"recent":case"single":case"confirmed":case"singleGossip":{b=this._confirmTransactionInitialTimeout||3e4;break}}r=setTimeout(()=>w({__type:qe.TIMED_OUT,timeoutMs:b}),b)}),{abortConfirmation:i,confirmationPromise:u}=this.getTransactionConfirmationPromise({commitment:t,signature:e});let m;try{const w=await Promise.race([u,s]);if(w.__type===qe.PROCESSED)m=w.response;else throw new Oi(e,w.timeoutMs/1e3)}finally{clearTimeout(r),i()}return m}async getClusterNodes(){const t=await this._rpcRequest("getClusterNodes",[]),e=O(t,Tt(z(vu)));if("error"in e)throw new F(e.error,"failed to get cluster nodes");return e.result}async getVoteAccounts(t){const e=this._buildArgs([],t),r=await this._rpcRequest("getVoteAccounts",e),s=O(r,bu);if("error"in s)throw new F(s.error,"failed to get vote accounts");return s.result}async getSlot(t){const{commitment:e,config:r}=Ht(t),s=this._buildArgs([],e,void 0,r),i=await this._rpcRequest("getSlot",s),u=O(i,Tt(k()));if("error"in u)throw new F(u.error,"failed to get slot");return u.result}async getSlotLeader(t){const{commitment:e,config:r}=Ht(t),s=this._buildArgs([],e,void 0,r),i=await this._rpcRequest("getSlotLeader",s),u=O(i,Tt(B()));if("error"in u)throw new F(u.error,"failed to get slot leader");return u.result}async getSlotLeaders(t,e){const r=[t,e],s=await this._rpcRequest("getSlotLeaders",r),i=O(s,Tt(z(Yt)));if("error"in i)throw new F(i.error,"failed to get slot leaders");return i.result}async getSignatureStatus(t,e){const{context:r,value:s}=await this.getSignatureStatuses([t],e);Ut(s.length===1);const i=s[0];return{context:r,value:i}}async getSignatureStatuses(t,e){const r=[t];e&&r.push(e);const s=await this._rpcRequest("getSignatureStatuses",r),i=O(s,Mu);if("error"in i)throw new F(i.error,"failed to get signature status");return i.result}async getTransactionCount(t){const{commitment:e,config:r}=Ht(t),s=this._buildArgs([],e,void 0,r),i=await this._rpcRequest("getTransactionCount",s),u=O(i,Tt(k()));if("error"in u)throw new F(u.error,"failed to get transaction count");return u.result}async getTotalSupply(t){return(await this.getSupply({commitment:t,excludeNonCirculatingAccountsList:!0})).value.total}async getInflationGovernor(t){const e=this._buildArgs([],t),r=await this._rpcRequest("getInflationGovernor",e),s=O(r,Hc);if("error"in s)throw new F(s.error,"failed to get inflation");return s.result}async getInflationReward(t,e,r){const{commitment:s,config:i}=Ht(r),u=this._buildArgs([t.map(b=>b.toBase58())],s,void 0,{...i,epoch:e??(i==null?void 0:i.epoch)}),m=await this._rpcRequest("getInflationReward",u),w=O(m,Tc);if("error"in w)throw new F(w.error,"failed to get inflation reward");return w.result}async getInflationRate(){const t=await this._rpcRequest("getInflationRate",[]),e=O(t,Gc);if("error"in e)throw new F(e.error,"failed to get inflation rate");return e.result}async getEpochInfo(t){const{commitment:e,config:r}=Ht(t),s=this._buildArgs([],e,void 0,r),i=await this._rpcRequest("getEpochInfo",s),u=O(i,Jc);if("error"in u)throw new F(u.error,"failed to get epoch info");return u.result}async getEpochSchedule(){const t=await this._rpcRequest("getEpochSchedule",[]),e=O(t,Zc);if("error"in e)throw new F(e.error,"failed to get epoch schedule");const r=e.result;return new ao(r.slotsPerEpoch,r.leaderScheduleSlotOffset,r.warmup,r.firstNormalEpoch,r.firstNormalSlot)}async getLeaderSchedule(){const t=await this._rpcRequest("getLeaderSchedule",[]),e=O(t,Yc);if("error"in e)throw new F(e.error,"failed to get leader schedule");return e.result}async getMinimumBalanceForRentExemption(t,e){const r=this._buildArgs([t],e),s=await this._rpcRequest("getMinimumBalanceForRentExemption",r),i=O(s,_u);return"error"in i?(console.warn("Unable to fetch minimum balance for rent exemption"),0):i.result}async getRecentBlockhashAndContext(t){const e=this._buildArgs([],t),r=await this._rpcRequest("getRecentBlockhash",e),s=O(r,Cu);if("error"in s)throw new F(s.error,"failed to get recent blockhash");return s.result}async getRecentPerformanceSamples(t){const e=await this._rpcRequest("getRecentPerformanceSamples",t?[t]:[]),r=O(e,Ku);if("error"in r)throw new F(r.error,"failed to get recent performance samples");return r.result}async getFeeCalculatorForBlockhash(t,e){const r=this._buildArgs([t],e),s=await this._rpcRequest("getFeeCalculatorForBlockhash",r),i=O(s,Uu);if("error"in i)throw new F(i.error,"failed to get fee calculator");const{context:u,value:m}=i.result;return{context:u,value:m!==null?m.feeCalculator:null}}async getFeeForMessage(t,e){const r=Bt(t.serialize()).toString("base64"),s=this._buildArgs([r],e),i=await this._rpcRequest("getFeeForMessage",s),u=O(i,Xt(K(k())));if("error"in u)throw new F(u.error,"failed to get fee for message");if(u.result===null)throw new Error("invalid blockhash");return u.result}async getRecentPrioritizationFees(t){var u;const e=(u=t==null?void 0:t.lockedWritableAccounts)==null?void 0:u.map(m=>m.toBase58()),r=e!=null&&e.length?[e]:[],s=await this._rpcRequest("getRecentPrioritizationFees",r),i=O(s,jc);if("error"in i)throw new F(i.error,"failed to get recent prioritization fees");return i.result}async getRecentBlockhash(t){try{return(await this.getRecentBlockhashAndContext(t)).value}catch(e){throw new Error("failed to get recent blockhash: "+e)}}async getLatestBlockhash(t){try{return(await this.getLatestBlockhashAndContext(t)).value}catch(e){throw new Error("failed to get recent blockhash: "+e)}}async getLatestBlockhashAndContext(t){const{commitment:e,config:r}=Ht(t),s=this._buildArgs([],e,void 0,r),i=await this._rpcRequest("getLatestBlockhash",s),u=O(i,Nu);if("error"in u)throw new F(u.error,"failed to get latest blockhash");return u.result}async isBlockhashValid(t,e){const{commitment:r,config:s}=Ht(e),i=this._buildArgs([t],r,void 0,s),u=await this._rpcRequest("isBlockhashValid",i),m=O(u,Ou);if("error"in m)throw new F(m.error,"failed to determine if the blockhash `"+t+"`is valid");return m.result}async getVersion(){const t=await this._rpcRequest("getVersion",[]),e=O(t,Tt(Uc));if("error"in e)throw new F(e.error,"failed to get version");return e.result}async getGenesisHash(){const t=await this._rpcRequest("getGenesisHash",[]),e=O(t,Tt(B()));if("error"in e)throw new F(e.error,"failed to get genesis hash");return e.result}async getBlock(t,e){const{commitment:r,config:s}=Ht(e),i=this._buildArgsAtLeastConfirmed([t],r,void 0,s),u=await this._rpcRequest("getBlock",i);try{switch(s==null?void 0:s.transactionDetails){case"accounts":{const m=O(u,Ru);if("error"in m)throw m.error;return m.result}case"none":{const m=O(u,Eu);if("error"in m)throw m.error;return m.result}default:{const m=O(u,Au);if("error"in m)throw m.error;const{result:w}=m;return w?{...w,transactions:w.transactions.map(({transaction:b,meta:M,version:x})=>({meta:M,transaction:{...b,message:si(x,b.message)},version:x}))}:null}}}catch(m){throw new F(m,"failed to get confirmed block")}}async getParsedBlock(t,e){const{commitment:r,config:s}=Ht(e),i=this._buildArgsAtLeastConfirmed([t],r,"jsonParsed",s),u=await this._rpcRequest("getBlock",i);try{switch(s==null?void 0:s.transactionDetails){case"accounts":{const m=O(u,Tu);if("error"in m)throw m.error;return m.result}case"none":{const m=O(u,Bu);if("error"in m)throw m.error;return m.result}default:{const m=O(u,Pu);if("error"in m)throw m.error;return m.result}}}catch(m){throw new F(m,"failed to get block")}}async getBlockProduction(t){let e,r;if(typeof t=="string")r=t;else if(t){const{commitment:m,...w}=t;r=m,e=w}const s=this._buildArgs([],r,"base64",e),i=await this._rpcRequest("getBlockProduction",s),u=O(i,Fc);if("error"in u)throw new F(u.error,"failed to get block production information");return u.result}async getTransaction(t,e){const{commitment:r,config:s}=Ht(e),i=this._buildArgsAtLeastConfirmed([t],r,void 0,s),u=await this._rpcRequest("getTransaction",i),m=O(u,oi);if("error"in m)throw new F(m.error,"failed to get transaction");const w=m.result;return w&&{...w,transaction:{...w.transaction,message:si(w.version,w.transaction.message)}}}async getParsedTransaction(t,e){const{commitment:r,config:s}=Ht(e),i=this._buildArgsAtLeastConfirmed([t],r,"jsonParsed",s),u=await this._rpcRequest("getTransaction",i),m=O(u,Sn);if("error"in m)throw new F(m.error,"failed to get transaction");return m.result}async getParsedTransactions(t,e){const{commitment:r,config:s}=Ht(e),i=t.map(w=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([w],r,"jsonParsed",s)}));return(await this._rpcBatchRequest(i)).map(w=>{const b=O(w,Sn);if("error"in b)throw new F(b.error,"failed to get transactions");return b.result})}async getTransactions(t,e){const{commitment:r,config:s}=Ht(e),i=t.map(w=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([w],r,void 0,s)}));return(await this._rpcBatchRequest(i)).map(w=>{const b=O(w,oi);if("error"in b)throw new F(b.error,"failed to get transactions");const M=b.result;return M&&{...M,transaction:{...M.transaction,message:si(M.version,M.transaction.message)}}})}async getConfirmedBlock(t,e){const r=this._buildArgsAtLeastConfirmed([t],e),s=await this._rpcRequest("getConfirmedBlock",r),i=O(s,Lu);if("error"in i)throw new F(i.error,"failed to get confirmed block");const u=i.result;if(!u)throw new Error("Confirmed block "+t+" not found");const m={...u,transactions:u.transactions.map(({transaction:w,meta:b})=>{const M=new Ae(w.message);return{meta:b,transaction:{...w,message:M}}})};return{...m,transactions:m.transactions.map(({transaction:w,meta:b})=>({meta:b,transaction:Ot.populate(w.message,w.signatures)}))}}async getBlocks(t,e,r){const s=this._buildArgsAtLeastConfirmed(e!==void 0?[t,e]:[t],r),i=await this._rpcRequest("getBlocks",s),u=O(i,Tt(z(k())));if("error"in u)throw new F(u.error,"failed to get blocks");return u.result}async getBlockSignatures(t,e){const r=this._buildArgsAtLeastConfirmed([t],e,void 0,{transactionDetails:"signatures",rewards:!1}),s=await this._rpcRequest("getBlock",r),i=O(s,cs);if("error"in i)throw new F(i.error,"failed to get block");const u=i.result;if(!u)throw new Error("Block "+t+" not found");return u}async getConfirmedBlockSignatures(t,e){const r=this._buildArgsAtLeastConfirmed([t],e,void 0,{transactionDetails:"signatures",rewards:!1}),s=await this._rpcRequest("getConfirmedBlock",r),i=O(s,cs);if("error"in i)throw new F(i.error,"failed to get confirmed block");const u=i.result;if(!u)throw new Error("Confirmed block "+t+" not found");return u}async getConfirmedTransaction(t,e){const r=this._buildArgsAtLeastConfirmed([t],e),s=await this._rpcRequest("getConfirmedTransaction",r),i=O(s,oi);if("error"in i)throw new F(i.error,"failed to get transaction");const u=i.result;if(!u)return u;const m=new Ae(u.transaction.message),w=u.transaction.signatures;return{...u,transaction:Ot.populate(m,w)}}async getParsedConfirmedTransaction(t,e){const r=this._buildArgsAtLeastConfirmed([t],e,"jsonParsed"),s=await this._rpcRequest("getConfirmedTransaction",r),i=O(s,Sn);if("error"in i)throw new F(i.error,"failed to get confirmed transaction");return i.result}async getParsedConfirmedTransactions(t,e){const r=t.map(u=>({methodName:"getConfirmedTransaction",args:this._buildArgsAtLeastConfirmed([u],e,"jsonParsed")}));return(await this._rpcBatchRequest(r)).map(u=>{const m=O(u,Sn);if("error"in m)throw new F(m.error,"failed to get confirmed transactions");return m.result})}async getConfirmedSignaturesForAddress(t,e,r){let s={},i=await this.getFirstAvailableBlock();for(;!("until"in s)&&(e--,!(e<=0||e<i));)try{const w=await this.getConfirmedBlockSignatures(e,"finalized");w.signatures.length>0&&(s.until=w.signatures[w.signatures.length-1].toString())}catch(w){if(w instanceof Error&&w.message.includes("skipped"))continue;throw w}let u=await this.getSlot("finalized");for(;!("before"in s)&&(r++,!(r>u));)try{const w=await this.getConfirmedBlockSignatures(r);w.signatures.length>0&&(s.before=w.signatures[w.signatures.length-1].toString())}catch(w){if(w instanceof Error&&w.message.includes("skipped"))continue;throw w}return(await this.getConfirmedSignaturesForAddress2(t,s)).map(w=>w.signature)}async getConfirmedSignaturesForAddress2(t,e,r){const s=this._buildArgsAtLeastConfirmed([t.toBase58()],r,void 0,e),i=await this._rpcRequest("getConfirmedSignaturesForAddress2",s),u=O(i,cu);if("error"in u)throw new F(u.error,"failed to get confirmed signatures for address");return u.result}async getSignaturesForAddress(t,e,r){const s=this._buildArgsAtLeastConfirmed([t.toBase58()],r,void 0,e),i=await this._rpcRequest("getSignaturesForAddress",s),u=O(i,uu);if("error"in u)throw new F(u.error,"failed to get signatures for address");return u.result}async getAddressLookupTable(t,e){const{context:r,value:s}=await this.getAccountInfoAndContext(t,e);let i=null;return s!==null&&(i=new fi({key:t,state:fi.deserialize(s.data)})),{context:r,value:i}}async getNonceAndContext(t,e){const{context:r,value:s}=await this.getAccountInfoAndContext(t,e);let i=null;return s!==null&&(i=Fn.fromAccountData(s.data)),{context:r,value:i}}async getNonce(t,e){return await this.getNonceAndContext(t,e).then(r=>r.value).catch(r=>{throw new Error("failed to get nonce for account "+t.toBase58()+": "+r)})}async requestAirdrop(t,e){const r=await this._rpcRequest("requestAirdrop",[t.toBase58(),e]),s=O(r,Wu);if("error"in s)throw new F(s.error,`airdrop to ${t.toBase58()} failed`);return s.result}async _blockhashWithExpiryBlockHeight(t){if(!t){for(;this._pollingBlockhash;)await wr(100);const r=Date.now()-this._blockhashInfo.lastFetch>=uo;if(this._blockhashInfo.latestBlockhash!==null&&!r)return this._blockhashInfo.latestBlockhash}return await this._pollNewBlockhash()}async _pollNewBlockhash(){this._pollingBlockhash=!0;try{const t=Date.now(),e=this._blockhashInfo.latestBlockhash,r=e?e.blockhash:null;for(let s=0;s<50;s++){const i=await this.getLatestBlockhash("finalized");if(r!==i.blockhash)return this._blockhashInfo={latestBlockhash:i,lastFetch:Date.now(),transactionSignatures:[],simulatedSignatures:[]},i;await wr(io/2)}throw new Error(`Unable to obtain a new blockhash after ${Date.now()-t}ms`)}finally{this._pollingBlockhash=!1}}async getStakeMinimumDelegation(t){const{commitment:e,config:r}=Ht(t),s=this._buildArgs([],e,"base64",r),i=await this._rpcRequest("getStakeMinimumDelegation",s),u=O(i,Xt(k()));if("error"in u)throw new F(u.error,"failed to get stake minimum delegation");return u.result}async simulateTransaction(t,e,r){if("message"in t){const A=t.serialize(),N=$.from(A).toString("base64");if(Array.isArray(e)||r!==void 0)throw new Error("Invalid arguments");const U=e||{};U.encoding="base64","commitment"in U||(U.commitment=this.commitment),e&&typeof e=="object"&&"innerInstructions"in e&&(U.innerInstructions=e.innerInstructions);const G=[N,U],qt=await this._rpcRequest("simulateTransaction",G),Ft=O(qt,os);if("error"in Ft)throw new Error("failed to simulate transaction: "+Ft.error.message);return Ft.result}let s;if(t instanceof Ot){let E=t;s=new Ot,s.feePayer=E.feePayer,s.instructions=t.instructions,s.nonceInfo=E.nonceInfo,s.signatures=E.signatures}else s=Ot.populate(t),s._message=s._json=void 0;if(e!==void 0&&!Array.isArray(e))throw new Error("Invalid arguments");const i=e;if(s.nonceInfo&&i)s.sign(...i);else{let E=this._disableBlockhashCaching;for(;;){const A=await this._blockhashWithExpiryBlockHeight(E);if(s.lastValidBlockHeight=A.lastValidBlockHeight,s.recentBlockhash=A.blockhash,!i)break;if(s.sign(...i),!s.signature)throw new Error("!signature");const N=s.signature.toString("base64");if(!this._blockhashInfo.simulatedSignatures.includes(N)&&!this._blockhashInfo.transactionSignatures.includes(N)){this._blockhashInfo.simulatedSignatures.push(N);break}else E=!0}}const u=s._compile(),m=u.serialize(),b=s._serialize(m).toString("base64"),M={encoding:"base64",commitment:this.commitment};if(r){const E=(Array.isArray(r)?r:u.nonProgramIds()).map(A=>A.toBase58());M.accounts={encoding:"base64",addresses:E}}i&&(M.sigVerify=!0),e&&typeof e=="object"&&"innerInstructions"in e&&(M.innerInstructions=e.innerInstructions);const x=[b,M],L=await this._rpcRequest("simulateTransaction",x),_=O(L,os);if("error"in _){let E;if("data"in _.error&&(E=_.error.data.logs,E&&Array.isArray(E))){const A=`
    `,N=A+E.join(A);console.error(_.error.message,N)}throw new dn({action:"simulate",signature:"",transactionMessage:_.error.message,logs:E})}return _.result}async sendTransaction(t,e,r){if("version"in t){if(e&&Array.isArray(e))throw new Error("Invalid arguments");const u=t.serialize();return await this.sendRawTransaction(u,e)}if(e===void 0||!Array.isArray(e))throw new Error("Invalid arguments");const s=e;if(t.nonceInfo)t.sign(...s);else{let u=this._disableBlockhashCaching;for(;;){const m=await this._blockhashWithExpiryBlockHeight(u);if(t.lastValidBlockHeight=m.lastValidBlockHeight,t.recentBlockhash=m.blockhash,t.sign(...s),!t.signature)throw new Error("!signature");const w=t.signature.toString("base64");if(this._blockhashInfo.transactionSignatures.includes(w))u=!0;else{this._blockhashInfo.transactionSignatures.push(w);break}}}const i=t.serialize();return await this.sendRawTransaction(i,r)}async sendRawTransaction(t,e){const r=Bt(t).toString("base64");return await this.sendEncodedTransaction(r,e)}async sendEncodedTransaction(t,e){const r={encoding:"base64"},s=e&&e.skipPreflight,i=s===!0?"processed":e&&e.preflightCommitment||this.commitment;e&&e.maxRetries!=null&&(r.maxRetries=e.maxRetries),e&&e.minContextSlot!=null&&(r.minContextSlot=e.minContextSlot),s&&(r.skipPreflight=s),i&&(r.preflightCommitment=i);const u=[t,r],m=await this._rpcRequest("sendTransaction",u),w=O(m,qu);if("error"in w){let b;throw"data"in w.error&&(b=w.error.data.logs),new dn({action:s?"send":"simulate",signature:"",transactionMessage:w.error.message,logs:b})}return w.result}_wsOnOpen(){this._rpcWebSocketConnected=!0,this._rpcWebSocketHeartbeat=setInterval(()=>{(async()=>{try{await this._rpcWebSocket.notify("ping")}catch{}})()},5e3),this._updateSubscriptions()}_wsOnError(t){this._rpcWebSocketConnected=!1,console.error("ws error:",t.message)}_wsOnClose(t){if(this._rpcWebSocketConnected=!1,this._rpcWebSocketGeneration=(this._rpcWebSocketGeneration+1)%Number.MAX_SAFE_INTEGER,this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null),this._rpcWebSocketHeartbeat&&(clearInterval(this._rpcWebSocketHeartbeat),this._rpcWebSocketHeartbeat=null),t===1e3){this._updateSubscriptions();return}this._subscriptionCallbacksByServerSubscriptionId={},Object.entries(this._subscriptionsByHash).forEach(([e,r])=>{this._setSubscription(e,{...r,state:"pending"})})}_setSubscription(t,e){var s;const r=(s=this._subscriptionsByHash[t])==null?void 0:s.state;if(this._subscriptionsByHash[t]=e,r!==e.state){const i=this._subscriptionStateChangeCallbacksByHash[t];i&&i.forEach(u=>{try{u(e.state)}catch{}})}}_onSubscriptionStateChange(t,e){var i;const r=this._subscriptionHashByClientSubscriptionId[t];if(r==null)return()=>{};const s=(i=this._subscriptionStateChangeCallbacksByHash)[r]||(i[r]=new Set);return s.add(e),()=>{s.delete(e),s.size===0&&delete this._subscriptionStateChangeCallbacksByHash[r]}}async _updateSubscriptions(){if(Object.keys(this._subscriptionsByHash).length===0){this._rpcWebSocketConnected&&(this._rpcWebSocketConnected=!1,this._rpcWebSocketIdleTimeout=setTimeout(()=>{this._rpcWebSocketIdleTimeout=null;try{this._rpcWebSocket.close()}catch(r){r instanceof Error&&console.log(`Error when closing socket connection: ${r.message}`)}},500));return}if(this._rpcWebSocketIdleTimeout!==null&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketConnected=!0),!this._rpcWebSocketConnected){this._rpcWebSocket.connect();return}const t=this._rpcWebSocketGeneration,e=()=>t===this._rpcWebSocketGeneration;await Promise.all(Object.keys(this._subscriptionsByHash).map(async r=>{const s=this._subscriptionsByHash[r];if(s!==void 0)switch(s.state){case"pending":case"unsubscribed":if(s.callbacks.size===0){delete this._subscriptionsByHash[r],s.state==="unsubscribed"&&delete this._subscriptionCallbacksByServerSubscriptionId[s.serverSubscriptionId],await this._updateSubscriptions();return}await(async()=>{const{args:i,method:u}=s;try{this._setSubscription(r,{...s,state:"subscribing"});const m=await this._rpcWebSocket.call(u,i);this._setSubscription(r,{...s,serverSubscriptionId:m,state:"subscribed"}),this._subscriptionCallbacksByServerSubscriptionId[m]=s.callbacks,await this._updateSubscriptions()}catch(m){if(console.error(`Received ${m instanceof Error?"":"JSON-RPC "}error calling \`${u}\``,{args:i,error:m}),!e())return;this._setSubscription(r,{...s,state:"pending"}),await this._updateSubscriptions()}})();break;case"subscribed":s.callbacks.size===0&&await(async()=>{const{serverSubscriptionId:i,unsubscribeMethod:u}=s;if(this._subscriptionsAutoDisposedByRpc.has(i))this._subscriptionsAutoDisposedByRpc.delete(i);else{this._setSubscription(r,{...s,state:"unsubscribing"}),this._setSubscription(r,{...s,state:"unsubscribing"});try{await this._rpcWebSocket.call(u,[i])}catch(m){if(m instanceof Error&&console.error(`${u} error:`,m.message),!e())return;this._setSubscription(r,{...s,state:"subscribed"}),await this._updateSubscriptions();return}}this._setSubscription(r,{...s,state:"unsubscribed"}),await this._updateSubscriptions()})();break}}))}_handleServerNotification(t,e){const r=this._subscriptionCallbacksByServerSubscriptionId[t];r!==void 0&&r.forEach(s=>{try{s(...e)}catch(i){console.error(i)}})}_wsOnAccountNotification(t){const{result:e,subscription:r}=O(t,hu);this._handleServerNotification(r,[e.value,e.context])}_makeSubscription(t,e){const r=this._nextClientSubscriptionId++,s=ns([t.method,e]),i=this._subscriptionsByHash[s];return i===void 0?this._subscriptionsByHash[s]={...t,args:e,callbacks:new Set([t.callback]),state:"pending"}:i.callbacks.add(t.callback),this._subscriptionHashByClientSubscriptionId[r]=s,this._subscriptionDisposeFunctionsByClientSubscriptionId[r]=async()=>{delete this._subscriptionDisposeFunctionsByClientSubscriptionId[r],delete this._subscriptionHashByClientSubscriptionId[r];const u=this._subscriptionsByHash[s];Ut(u!==void 0,`Could not find a \`Subscription\` when tearing down client subscription #${r}`),u.callbacks.delete(t.callback),await this._updateSubscriptions()},this._updateSubscriptions(),r}onAccountChange(t,e,r){const{commitment:s,config:i}=Ht(r),u=this._buildArgs([t.toBase58()],s||this._commitment||"finalized","base64",i);return this._makeSubscription({callback:e,method:"accountSubscribe",unsubscribeMethod:"accountUnsubscribe"},u)}async removeAccountChangeListener(t){await this._unsubscribeClientSubscription(t,"account change")}_wsOnProgramAccountNotification(t){const{result:e,subscription:r}=O(t,fu);this._handleServerNotification(r,[{accountId:e.value.pubkey,accountInfo:e.value.account},e.context])}onProgramAccountChange(t,e,r,s){const{commitment:i,config:u}=Ht(r),m=this._buildArgs([t.toBase58()],i||this._commitment||"finalized","base64",u||(s?{filters:ss(s)}:void 0));return this._makeSubscription({callback:e,method:"programSubscribe",unsubscribeMethod:"programUnsubscribe"},m)}async removeProgramAccountChangeListener(t){await this._unsubscribeClientSubscription(t,"program account change")}onLogs(t,e,r){const s=this._buildArgs([typeof t=="object"?{mentions:[t.toString()]}:t],r||this._commitment||"finalized");return this._makeSubscription({callback:e,method:"logsSubscribe",unsubscribeMethod:"logsUnsubscribe"},s)}async removeOnLogsListener(t){await this._unsubscribeClientSubscription(t,"logs")}_wsOnLogsNotification(t){const{result:e,subscription:r}=O(t,Du);this._handleServerNotification(r,[e.value,e.context])}_wsOnSlotNotification(t){const{result:e,subscription:r}=O(t,pu);this._handleServerNotification(r,[e])}onSlotChange(t){return this._makeSubscription({callback:t,method:"slotSubscribe",unsubscribeMethod:"slotUnsubscribe"},[])}async removeSlotChangeListener(t){await this._unsubscribeClientSubscription(t,"slot change")}_wsOnSlotUpdatesNotification(t){const{result:e,subscription:r}=O(t,mu);this._handleServerNotification(r,[e])}onSlotUpdate(t){return this._makeSubscription({callback:t,method:"slotsUpdatesSubscribe",unsubscribeMethod:"slotsUpdatesUnsubscribe"},[])}async removeSlotUpdateListener(t){await this._unsubscribeClientSubscription(t,"slot update")}async _unsubscribeClientSubscription(t,e){const r=this._subscriptionDisposeFunctionsByClientSubscriptionId[t];r?await r():console.warn(`Ignored unsubscribe request because an active subscription with id \`${t}\` for '${e}' events could not be found.`)}_buildArgs(t,e,r,s){const i=e||this._commitment;if(i||r||s){let u={};r&&(u.encoding=r),i&&(u.commitment=i),s&&(u=Object.assign(u,s)),t.push(u)}return t}_buildArgsAtLeastConfirmed(t,e,r,s){const i=e||this._commitment;if(i&&!["confirmed","finalized"].includes(i))throw new Error("Using Connection with default commitment: `"+this._commitment+"`, but method requires at least `confirmed`");return this._buildArgs(t,e,r,s)}_wsOnSignatureNotification(t){const{result:e,subscription:r}=O(t,yu);e.value!=="receivedSignature"&&this._subscriptionsAutoDisposedByRpc.add(r),this._handleServerNotification(r,e.value==="receivedSignature"?[{type:"received"},e.context]:[{type:"status",result:e.value},e.context])}onSignature(t,e,r){const s=this._buildArgs([t],r||this._commitment||"finalized"),i=this._makeSubscription({callback:(u,m)=>{if(u.type==="status"){e(u.result,m);try{this.removeSignatureListener(i)}catch{}}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},s);return i}onSignatureWithOptions(t,e,r){const{commitment:s,...i}={...r,commitment:r&&r.commitment||this._commitment||"finalized"},u=this._buildArgs([t],s,void 0,i),m=this._makeSubscription({callback:(w,b)=>{e(w,b);try{this.removeSignatureListener(m)}catch{}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},u);return m}async removeSignatureListener(t){await this._unsubscribeClientSubscription(t,"signature result")}_wsOnRootNotification(t){const{result:e,subscription:r}=O(t,wu);this._handleServerNotification(r,[e])}onRootChange(t){return this._makeSubscription({callback:t,method:"rootSubscribe",unsubscribeMethod:"rootUnsubscribe"},[])}async removeRootChangeListener(t){await this._unsubscribeClientSubscription(t,"root change")}}class Tr{constructor(t){this._keypair=void 0,this._keypair=t??Qi()}static generate(){return new Tr(Qi())}static fromSecretKey(t,e){if(t.byteLength!==64)throw new Error("bad secret key size");const r=t.slice(32,64);if(!e||!e.skipValidation){const s=t.slice(0,32),i=Bn(s);for(let u=0;u<32;u++)if(r[u]!==i[u])throw new Error("provided secretKey is invalid")}return new Tr({publicKey:r,secretKey:t})}static fromSeed(t){const e=Bn(t),r=new Uint8Array(64);return r.set(t),r.set(e,32),new Tr({publicKey:e,secretKey:r})}get publicKey(){return new C(this._keypair.publicKey)}get secretKey(){return new Uint8Array(this._keypair.secretKey)}}const De=Object.freeze({CreateLookupTable:{index:0,layout:q([W("instruction"),Nr("recentSlot"),Kt("bumpSeed")])},FreezeLookupTable:{index:1,layout:q([W("instruction")])},ExtendLookupTable:{index:2,layout:q([W("instruction"),Nr(),ce(Ct(),He(W(),-8),"addresses")])},DeactivateLookupTable:{index:3,layout:q([W("instruction")])},CloseLookupTable:{index:4,layout:q([W("instruction")])}});class $u{constructor(){}static decodeInstructionType(t){this.checkProgramId(t.programId);const r=W("instruction").decode(t.data);let s;for(const[i,u]of Object.entries(De))if(u.index==r){s=i;break}if(!s)throw new Error("Invalid Instruction. Should be a LookupTable Instruction");return s}static decodeCreateLookupTable(t){this.checkProgramId(t.programId),this.checkKeysLength(t.keys,4);const{recentSlot:e}=Dt(De.CreateLookupTable,t.data);return{authority:t.keys[1].pubkey,payer:t.keys[2].pubkey,recentSlot:Number(e)}}static decodeExtendLookupTable(t){if(this.checkProgramId(t.programId),t.keys.length<2)throw new Error(`invalid instruction; found ${t.keys.length} keys, expected at least 2`);const{addresses:e}=Dt(De.ExtendLookupTable,t.data);return{lookupTable:t.keys[0].pubkey,authority:t.keys[1].pubkey,payer:t.keys.length>2?t.keys[2].pubkey:void 0,addresses:e.map(r=>new C(r))}}static decodeCloseLookupTable(t){return this.checkProgramId(t.programId),this.checkKeysLength(t.keys,3),{lookupTable:t.keys[0].pubkey,authority:t.keys[1].pubkey,recipient:t.keys[2].pubkey}}static decodeFreezeLookupTable(t){return this.checkProgramId(t.programId),this.checkKeysLength(t.keys,2),{lookupTable:t.keys[0].pubkey,authority:t.keys[1].pubkey}}static decodeDeactivateLookupTable(t){return this.checkProgramId(t.programId),this.checkKeysLength(t.keys,2),{lookupTable:t.keys[0].pubkey,authority:t.keys[1].pubkey}}static checkProgramId(t){if(!t.equals(qi.programId))throw new Error("invalid instruction; programId is not AddressLookupTable Program")}static checkKeysLength(t,e){if(t.length<e)throw new Error(`invalid instruction; found ${t.length} keys, expected at least ${e}`)}}class qi{constructor(){}static createLookupTable(t){const[e,r]=C.findProgramAddressSync([t.authority.toBuffer(),$s(BigInt(t.recentSlot),8)],this.programId),s=De.CreateLookupTable,i=Nt(s,{recentSlot:BigInt(t.recentSlot),bumpSeed:r}),u=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t.authority,isSigner:!0,isWritable:!1},{pubkey:t.payer,isSigner:!0,isWritable:!0},{pubkey:Jt.programId,isSigner:!1,isWritable:!1}];return[new $t({programId:this.programId,keys:u,data:i}),e]}static freezeLookupTable(t){const e=De.FreezeLookupTable,r=Nt(e),s=[{pubkey:t.lookupTable,isSigner:!1,isWritable:!0},{pubkey:t.authority,isSigner:!0,isWritable:!1}];return new $t({programId:this.programId,keys:s,data:r})}static extendLookupTable(t){const e=De.ExtendLookupTable,r=Nt(e,{addresses:t.addresses.map(i=>i.toBytes())}),s=[{pubkey:t.lookupTable,isSigner:!1,isWritable:!0},{pubkey:t.authority,isSigner:!0,isWritable:!1}];return t.payer&&s.push({pubkey:t.payer,isSigner:!0,isWritable:!0},{pubkey:Jt.programId,isSigner:!1,isWritable:!1}),new $t({programId:this.programId,keys:s,data:r})}static deactivateLookupTable(t){const e=De.DeactivateLookupTable,r=Nt(e),s=[{pubkey:t.lookupTable,isSigner:!1,isWritable:!0},{pubkey:t.authority,isSigner:!0,isWritable:!1}];return new $t({programId:this.programId,keys:s,data:r})}static closeLookupTable(t){const e=De.CloseLookupTable,r=Nt(e),s=[{pubkey:t.lookupTable,isSigner:!1,isWritable:!0},{pubkey:t.authority,isSigner:!0,isWritable:!1},{pubkey:t.recipient,isSigner:!1,isWritable:!0}];return new $t({programId:this.programId,keys:s,data:r})}}qi.programId=new C("AddressLookupTab1e1111111111111111111111111");class Hu{constructor(){}static decodeInstructionType(t){this.checkProgramId(t.programId);const r=Kt("instruction").decode(t.data);let s;for(const[i,u]of Object.entries(Be))if(u.index==r){s=i;break}if(!s)throw new Error("Instruction type incorrect; not a ComputeBudgetInstruction");return s}static decodeRequestUnits(t){this.checkProgramId(t.programId);const{units:e,additionalFee:r}=Dt(Be.RequestUnits,t.data);return{units:e,additionalFee:r}}static decodeRequestHeapFrame(t){this.checkProgramId(t.programId);const{bytes:e}=Dt(Be.RequestHeapFrame,t.data);return{bytes:e}}static decodeSetComputeUnitLimit(t){this.checkProgramId(t.programId);const{units:e}=Dt(Be.SetComputeUnitLimit,t.data);return{units:e}}static decodeSetComputeUnitPrice(t){this.checkProgramId(t.programId);const{microLamports:e}=Dt(Be.SetComputeUnitPrice,t.data);return{microLamports:e}}static checkProgramId(t){if(!t.equals(Fi.programId))throw new Error("invalid instruction; programId is not ComputeBudgetProgram")}}const Be=Object.freeze({RequestUnits:{index:0,layout:q([Kt("instruction"),W("units"),W("additionalFee")])},RequestHeapFrame:{index:1,layout:q([Kt("instruction"),W("bytes")])},SetComputeUnitLimit:{index:2,layout:q([Kt("instruction"),W("units")])},SetComputeUnitPrice:{index:3,layout:q([Kt("instruction"),Nr("microLamports")])}});class Fi{constructor(){}static requestUnits(t){const e=Be.RequestUnits,r=Nt(e,t);return new $t({keys:[],programId:this.programId,data:r})}static requestHeapFrame(t){const e=Be.RequestHeapFrame,r=Nt(e,t);return new $t({keys:[],programId:this.programId,data:r})}static setComputeUnitLimit(t){const e=Be.SetComputeUnitLimit,r=Nt(e,t);return new $t({keys:[],programId:this.programId,data:r})}static setComputeUnitPrice(t){const e=Be.SetComputeUnitPrice,r=Nt(e,{microLamports:BigInt(t.microLamports)});return new $t({keys:[],programId:this.programId,data:r})}}Fi.programId=new C("ComputeBudget111111111111111111111111111111");const us=64,hs=32,ls=64,fs=q([Kt("numSignatures"),Kt("padding"),Me("signatureOffset"),Me("signatureInstructionIndex"),Me("publicKeyOffset"),Me("publicKeyInstructionIndex"),Me("messageDataOffset"),Me("messageDataSize"),Me("messageInstructionIndex")]);class $n{constructor(){}static createInstructionWithPublicKey(t){const{publicKey:e,message:r,signature:s,instructionIndex:i}=t;Ut(e.length===hs,`Public Key must be ${hs} bytes but received ${e.length} bytes`),Ut(s.length===ls,`Signature must be ${ls} bytes but received ${s.length} bytes`);const u=fs.span,m=u+e.length,w=m+s.length,b=1,M=$.alloc(w+r.length),x=i??65535;return fs.encode({numSignatures:b,padding:0,signatureOffset:m,signatureInstructionIndex:x,publicKeyOffset:u,publicKeyInstructionIndex:x,messageDataOffset:w,messageDataSize:r.length,messageInstructionIndex:x},M),M.fill(e,u),M.fill(s,m),M.fill(r,w),new $t({keys:[],programId:$n.programId,data:M})}static createInstructionWithPrivateKey(t){const{privateKey:e,message:r,instructionIndex:s}=t;Ut(e.length===us,`Private key must be ${us} bytes but received ${e.length} bytes`);try{const i=Tr.fromSecretKey(e),u=i.publicKey.toBytes(),m=Li(r,i.secretKey);return this.createInstructionWithPublicKey({publicKey:u,message:r,signature:m,instructionIndex:s})}catch(i){throw new Error(`Error creating instruction; ${i}`)}}}$n.programId=new C("Ed25519SigVerify111111111111111111111111111");const Gu=(a,t)=>{const e=wi.sign(a,t);return[e.toCompactRawBytes(),e.recovery]};wi.utils.isValidPrivateKey;const ju=wi.getPublicKey,ds=32,ai=20,ps=64,Ju=11,ci=q([Kt("numSignatures"),Me("signatureOffset"),Kt("signatureInstructionIndex"),Me("ethAddressOffset"),Kt("ethAddressInstructionIndex"),Me("messageDataOffset"),Me("messageDataSize"),Kt("messageInstructionIndex"),jt(20,"ethAddress"),jt(64,"signature"),Kt("recoveryId")]);class Br{constructor(){}static publicKeyToEthAddress(t){Ut(t.length===ps,`Public key must be ${ps} bytes but received ${t.length} bytes`);try{return $.from(Ji(Bt(t))).slice(-ai)}catch(e){throw new Error(`Error constructing Ethereum address: ${e}`)}}static createInstructionWithPublicKey(t){const{publicKey:e,message:r,signature:s,recoveryId:i,instructionIndex:u}=t;return Br.createInstructionWithEthAddress({ethAddress:Br.publicKeyToEthAddress(e),message:r,signature:s,recoveryId:i,instructionIndex:u})}static createInstructionWithEthAddress(t){const{ethAddress:e,message:r,signature:s,recoveryId:i,instructionIndex:u=0}=t;let m;typeof e=="string"?e.startsWith("0x")?m=$.from(e.substr(2),"hex"):m=$.from(e,"hex"):m=e,Ut(m.length===ai,`Address must be ${ai} bytes but received ${m.length} bytes`);const w=1+Ju,b=w,M=w+m.length,x=M+s.length+1,L=1,_=$.alloc(ci.span+r.length);return ci.encode({numSignatures:L,signatureOffset:M,signatureInstructionIndex:u,ethAddressOffset:b,ethAddressInstructionIndex:u,messageDataOffset:x,messageDataSize:r.length,messageInstructionIndex:u,signature:Bt(s),ethAddress:Bt(m),recoveryId:i},_),_.fill(Bt(r),ci.span),new $t({keys:[],programId:Br.programId,data:_})}static createInstructionWithPrivateKey(t){const{privateKey:e,message:r,instructionIndex:s}=t;Ut(e.length===ds,`Private key must be ${ds} bytes but received ${e.length} bytes`);try{const i=Bt(e),u=ju(i,!1).slice(1),m=$.from(Ji(Bt(r))),[w,b]=Gu(m,i);return this.createInstructionWithPublicKey({publicKey:u,message:r,signature:w,recoveryId:b,instructionIndex:s})}catch(i){throw new Error(`Error creating instruction; ${i}`)}}}Br.programId=new C("KeccakSecp256k11111111111111111111111111111");var ko;const So=new C("StakeConfig11111111111111111111111111111111");class Mo{constructor(t,e){this.staker=void 0,this.withdrawer=void 0,this.staker=t,this.withdrawer=e}}class bn{constructor(t,e,r){this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=t,this.epoch=e,this.custodian=r}}ko=bn;bn.default=new ko(0,0,C.default);class Zu{constructor(){}static decodeInstructionType(t){this.checkProgramId(t.programId);const r=W("instruction").decode(t.data);let s;for(const[i,u]of Object.entries(ne))if(u.index==r){s=i;break}if(!s)throw new Error("Instruction type incorrect; not a StakeInstruction");return s}static decodeInitialize(t){this.checkProgramId(t.programId),this.checkKeyLength(t.keys,2);const{authorized:e,lockup:r}=Dt(ne.Initialize,t.data);return{stakePubkey:t.keys[0].pubkey,authorized:new Mo(new C(e.staker),new C(e.withdrawer)),lockup:new bn(r.unixTimestamp,r.epoch,new C(r.custodian))}}static decodeDelegate(t){return this.checkProgramId(t.programId),this.checkKeyLength(t.keys,6),Dt(ne.Delegate,t.data),{stakePubkey:t.keys[0].pubkey,votePubkey:t.keys[1].pubkey,authorizedPubkey:t.keys[5].pubkey}}static decodeAuthorize(t){this.checkProgramId(t.programId),this.checkKeyLength(t.keys,3);const{newAuthorized:e,stakeAuthorizationType:r}=Dt(ne.Authorize,t.data),s={stakePubkey:t.keys[0].pubkey,authorizedPubkey:t.keys[2].pubkey,newAuthorizedPubkey:new C(e),stakeAuthorizationType:{index:r}};return t.keys.length>3&&(s.custodianPubkey=t.keys[3].pubkey),s}static decodeAuthorizeWithSeed(t){this.checkProgramId(t.programId),this.checkKeyLength(t.keys,2);const{newAuthorized:e,stakeAuthorizationType:r,authoritySeed:s,authorityOwner:i}=Dt(ne.AuthorizeWithSeed,t.data),u={stakePubkey:t.keys[0].pubkey,authorityBase:t.keys[1].pubkey,authoritySeed:s,authorityOwner:new C(i),newAuthorizedPubkey:new C(e),stakeAuthorizationType:{index:r}};return t.keys.length>3&&(u.custodianPubkey=t.keys[3].pubkey),u}static decodeSplit(t){this.checkProgramId(t.programId),this.checkKeyLength(t.keys,3);const{lamports:e}=Dt(ne.Split,t.data);return{stakePubkey:t.keys[0].pubkey,splitStakePubkey:t.keys[1].pubkey,authorizedPubkey:t.keys[2].pubkey,lamports:e}}static decodeMerge(t){return this.checkProgramId(t.programId),this.checkKeyLength(t.keys,3),Dt(ne.Merge,t.data),{stakePubkey:t.keys[0].pubkey,sourceStakePubKey:t.keys[1].pubkey,authorizedPubkey:t.keys[4].pubkey}}static decodeWithdraw(t){this.checkProgramId(t.programId),this.checkKeyLength(t.keys,5);const{lamports:e}=Dt(ne.Withdraw,t.data),r={stakePubkey:t.keys[0].pubkey,toPubkey:t.keys[1].pubkey,authorizedPubkey:t.keys[4].pubkey,lamports:e};return t.keys.length>5&&(r.custodianPubkey=t.keys[5].pubkey),r}static decodeDeactivate(t){return this.checkProgramId(t.programId),this.checkKeyLength(t.keys,3),Dt(ne.Deactivate,t.data),{stakePubkey:t.keys[0].pubkey,authorizedPubkey:t.keys[2].pubkey}}static checkProgramId(t){if(!t.equals(Hn.programId))throw new Error("invalid instruction; programId is not StakeProgram")}static checkKeyLength(t,e){if(t.length<e)throw new Error(`invalid instruction; found ${t.length} keys, expected at least ${e}`)}}const ne=Object.freeze({Initialize:{index:0,layout:q([W("instruction"),Xa(),Qa()])},Authorize:{index:1,layout:q([W("instruction"),Ct("newAuthorized"),W("stakeAuthorizationType")])},Delegate:{index:2,layout:q([W("instruction")])},Split:{index:3,layout:q([W("instruction"),be("lamports")])},Withdraw:{index:4,layout:q([W("instruction"),be("lamports")])},Deactivate:{index:5,layout:q([W("instruction")])},Merge:{index:7,layout:q([W("instruction")])},AuthorizeWithSeed:{index:8,layout:q([W("instruction"),Ct("newAuthorized"),W("stakeAuthorizationType"),vr("authoritySeed"),Ct("authorityOwner")])}}),Yu=Object.freeze({Staker:{index:0},Withdrawer:{index:1}});class Hn{constructor(){}static initialize(t){const{stakePubkey:e,authorized:r,lockup:s}=t,i=s||bn.default,u=ne.Initialize,m=Nt(u,{authorized:{staker:Bt(r.staker.toBuffer()),withdrawer:Bt(r.withdrawer.toBuffer())},lockup:{unixTimestamp:i.unixTimestamp,epoch:i.epoch,custodian:Bt(i.custodian.toBuffer())}}),w={keys:[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:Cr,isSigner:!1,isWritable:!1}],programId:this.programId,data:m};return new $t(w)}static createAccountWithSeed(t){const e=new Ot;e.add(Jt.createAccountWithSeed({fromPubkey:t.fromPubkey,newAccountPubkey:t.stakePubkey,basePubkey:t.basePubkey,seed:t.seed,lamports:t.lamports,space:this.space,programId:this.programId}));const{stakePubkey:r,authorized:s,lockup:i}=t;return e.add(this.initialize({stakePubkey:r,authorized:s,lockup:i}))}static createAccount(t){const e=new Ot;e.add(Jt.createAccount({fromPubkey:t.fromPubkey,newAccountPubkey:t.stakePubkey,lamports:t.lamports,space:this.space,programId:this.programId}));const{stakePubkey:r,authorized:s,lockup:i}=t;return e.add(this.initialize({stakePubkey:r,authorized:s,lockup:i}))}static delegate(t){const{stakePubkey:e,authorizedPubkey:r,votePubkey:s}=t,i=ne.Delegate,u=Nt(i);return new Ot().add({keys:[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:Pe,isSigner:!1,isWritable:!1},{pubkey:xn,isSigner:!1,isWritable:!1},{pubkey:So,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:u})}static authorize(t){const{stakePubkey:e,authorizedPubkey:r,newAuthorizedPubkey:s,stakeAuthorizationType:i,custodianPubkey:u}=t,m=ne.Authorize,w=Nt(m,{newAuthorized:Bt(s.toBuffer()),stakeAuthorizationType:i.index}),b=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:Pe,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1}];return u&&b.push({pubkey:u,isSigner:!0,isWritable:!1}),new Ot().add({keys:b,programId:this.programId,data:w})}static authorizeWithSeed(t){const{stakePubkey:e,authorityBase:r,authoritySeed:s,authorityOwner:i,newAuthorizedPubkey:u,stakeAuthorizationType:m,custodianPubkey:w}=t,b=ne.AuthorizeWithSeed,M=Nt(b,{newAuthorized:Bt(u.toBuffer()),stakeAuthorizationType:m.index,authoritySeed:s,authorityOwner:Bt(i.toBuffer())}),x=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1},{pubkey:Pe,isSigner:!1,isWritable:!1}];return w&&x.push({pubkey:w,isSigner:!0,isWritable:!1}),new Ot().add({keys:x,programId:this.programId,data:M})}static splitInstruction(t){const{stakePubkey:e,authorizedPubkey:r,splitStakePubkey:s,lamports:i}=t,u=ne.Split,m=Nt(u,{lamports:i});return new $t({keys:[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:m})}static split(t,e){const r=new Ot;return r.add(Jt.createAccount({fromPubkey:t.authorizedPubkey,newAccountPubkey:t.splitStakePubkey,lamports:e,space:this.space,programId:this.programId})),r.add(this.splitInstruction(t))}static splitWithSeed(t,e){const{stakePubkey:r,authorizedPubkey:s,splitStakePubkey:i,basePubkey:u,seed:m,lamports:w}=t,b=new Ot;return b.add(Jt.allocate({accountPubkey:i,basePubkey:u,seed:m,space:this.space,programId:this.programId})),e&&e>0&&b.add(Jt.transfer({fromPubkey:t.authorizedPubkey,toPubkey:i,lamports:e})),b.add(this.splitInstruction({stakePubkey:r,authorizedPubkey:s,splitStakePubkey:i,lamports:w}))}static merge(t){const{stakePubkey:e,sourceStakePubKey:r,authorizedPubkey:s}=t,i=ne.Merge,u=Nt(i);return new Ot().add({keys:[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:Pe,isSigner:!1,isWritable:!1},{pubkey:xn,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!0,isWritable:!1}],programId:this.programId,data:u})}static withdraw(t){const{stakePubkey:e,authorizedPubkey:r,toPubkey:s,lamports:i,custodianPubkey:u}=t,m=ne.Withdraw,w=Nt(m,{lamports:i}),b=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:Pe,isSigner:!1,isWritable:!1},{pubkey:xn,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}];return u&&b.push({pubkey:u,isSigner:!0,isWritable:!1}),new Ot().add({keys:b,programId:this.programId,data:w})}static deactivate(t){const{stakePubkey:e,authorizedPubkey:r}=t,s=ne.Deactivate,i=Nt(s);return new Ot().add({keys:[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:Pe,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:i})}}Hn.programId=new C("Stake11111111111111111111111111111111111111");Hn.space=200;class _o{constructor(t,e,r,s){this.nodePubkey=void 0,this.authorizedVoter=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.nodePubkey=t,this.authorizedVoter=e,this.authorizedWithdrawer=r,this.commission=s}}class Xu{constructor(){}static decodeInstructionType(t){this.checkProgramId(t.programId);const r=W("instruction").decode(t.data);let s;for(const[i,u]of Object.entries(Le))if(u.index==r){s=i;break}if(!s)throw new Error("Instruction type incorrect; not a VoteInstruction");return s}static decodeInitializeAccount(t){this.checkProgramId(t.programId),this.checkKeyLength(t.keys,4);const{voteInit:e}=Dt(Le.InitializeAccount,t.data);return{votePubkey:t.keys[0].pubkey,nodePubkey:t.keys[3].pubkey,voteInit:new _o(new C(e.nodePubkey),new C(e.authorizedVoter),new C(e.authorizedWithdrawer),e.commission)}}static decodeAuthorize(t){this.checkProgramId(t.programId),this.checkKeyLength(t.keys,3);const{newAuthorized:e,voteAuthorizationType:r}=Dt(Le.Authorize,t.data);return{votePubkey:t.keys[0].pubkey,authorizedPubkey:t.keys[2].pubkey,newAuthorizedPubkey:new C(e),voteAuthorizationType:{index:r}}}static decodeAuthorizeWithSeed(t){this.checkProgramId(t.programId),this.checkKeyLength(t.keys,3);const{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:e,currentAuthorityDerivedKeySeed:r,newAuthorized:s,voteAuthorizationType:i}}=Dt(Le.AuthorizeWithSeed,t.data);return{currentAuthorityDerivedKeyBasePubkey:t.keys[2].pubkey,currentAuthorityDerivedKeyOwnerPubkey:new C(e),currentAuthorityDerivedKeySeed:r,newAuthorizedPubkey:new C(s),voteAuthorizationType:{index:i},votePubkey:t.keys[0].pubkey}}static decodeWithdraw(t){this.checkProgramId(t.programId),this.checkKeyLength(t.keys,3);const{lamports:e}=Dt(Le.Withdraw,t.data);return{votePubkey:t.keys[0].pubkey,authorizedWithdrawerPubkey:t.keys[2].pubkey,lamports:e,toPubkey:t.keys[1].pubkey}}static checkProgramId(t){if(!t.equals(qr.programId))throw new Error("invalid instruction; programId is not VoteProgram")}static checkKeyLength(t,e){if(t.length<e)throw new Error(`invalid instruction; found ${t.length} keys, expected at least ${e}`)}}const Le=Object.freeze({InitializeAccount:{index:0,layout:q([W("instruction"),tc()])},Authorize:{index:1,layout:q([W("instruction"),Ct("newAuthorized"),W("voteAuthorizationType")])},Withdraw:{index:3,layout:q([W("instruction"),be("lamports")])},UpdateValidatorIdentity:{index:4,layout:q([W("instruction")])},AuthorizeWithSeed:{index:10,layout:q([W("instruction"),ec()])}}),Qu=Object.freeze({Voter:{index:0},Withdrawer:{index:1}});class qr{constructor(){}static initializeAccount(t){const{votePubkey:e,nodePubkey:r,voteInit:s}=t,i=Le.InitializeAccount,u=Nt(i,{voteInit:{nodePubkey:Bt(s.nodePubkey.toBuffer()),authorizedVoter:Bt(s.authorizedVoter.toBuffer()),authorizedWithdrawer:Bt(s.authorizedWithdrawer.toBuffer()),commission:s.commission}}),m={keys:[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:Cr,isSigner:!1,isWritable:!1},{pubkey:Pe,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:u};return new $t(m)}static createAccount(t){const e=new Ot;return e.add(Jt.createAccount({fromPubkey:t.fromPubkey,newAccountPubkey:t.votePubkey,lamports:t.lamports,space:this.space,programId:this.programId})),e.add(this.initializeAccount({votePubkey:t.votePubkey,nodePubkey:t.voteInit.nodePubkey,voteInit:t.voteInit}))}static authorize(t){const{votePubkey:e,authorizedPubkey:r,newAuthorizedPubkey:s,voteAuthorizationType:i}=t,u=Le.Authorize,m=Nt(u,{newAuthorized:Bt(s.toBuffer()),voteAuthorizationType:i.index}),w=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:Pe,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}];return new Ot().add({keys:w,programId:this.programId,data:m})}static authorizeWithSeed(t){const{currentAuthorityDerivedKeyBasePubkey:e,currentAuthorityDerivedKeyOwnerPubkey:r,currentAuthorityDerivedKeySeed:s,newAuthorizedPubkey:i,voteAuthorizationType:u,votePubkey:m}=t,w=Le.AuthorizeWithSeed,b=Nt(w,{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:Bt(r.toBuffer()),currentAuthorityDerivedKeySeed:s,newAuthorized:Bt(i.toBuffer()),voteAuthorizationType:u.index}}),M=[{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:Pe,isSigner:!1,isWritable:!1},{pubkey:e,isSigner:!0,isWritable:!1}];return new Ot().add({keys:M,programId:this.programId,data:b})}static withdraw(t){const{votePubkey:e,authorizedWithdrawerPubkey:r,lamports:s,toPubkey:i}=t,u=Le.Withdraw,m=Nt(u,{lamports:s}),w=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1}];return new Ot().add({keys:w,programId:this.programId,data:m})}static safeWithdraw(t,e,r){if(t.lamports>e-r)throw new Error("Withdraw will leave vote account with insufficient funds.");return qr.withdraw(t)}static updateValidatorIdentity(t){const{votePubkey:e,authorizedWithdrawerPubkey:r,nodePubkey:s}=t,i=Le.UpdateValidatorIdentity,u=Nt(i),m=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!0,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}];return new Ot().add({keys:m,programId:this.programId,data:u})}}qr.programId=new C("Vote111111111111111111111111111111111111111");qr.space=3762;const xo=new C("Va1idator1nfo111111111111111111111111111111"),th=I({name:B(),website:D(B()),details:D(B()),iconUrl:D(B()),keybaseUsername:D(B())});class Di{constructor(t,e){this.key=void 0,this.info=void 0,this.key=t,this.info=e}static fromConfigData(t){let e=[...t];if(ye(e)!==2)return null;const s=[];for(let i=0;i<2;i++){const u=new C(we(e,0,Ce)),m=Te(e)===1;s.push({publicKey:u,isSigner:m})}if(s[0].publicKey.equals(xo)&&s[1].isSigner){const i=vr().decode($.from(e)),u=JSON.parse(i);return Hs(u,th),new Di(s[1].publicKey,u)}return null}}const eh=new C("Vote111111111111111111111111111111111111111"),rh=q([Ct("nodePubkey"),Ct("authorizedWithdrawer"),Kt("commission"),se(),ce(q([se("slot"),W("confirmationCount")]),He(W(),-8),"votes"),Kt("rootSlotValid"),se("rootSlot"),se(),ce(q([se("epoch"),Ct("authorizedVoter")]),He(W(),-8),"authorizedVoters"),q([ce(q([Ct("authorizedPubkey"),se("epochOfLastAuthorizedSwitch"),se("targetEpoch")]),32,"buf"),se("idx"),Kt("isEmpty")],"priorVoters"),se(),ce(q([se("epoch"),se("credits"),se("prevCredits")]),He(W(),-8),"epochCredits"),q([se("slot"),se("timestamp")],"lastTimestamp")]);class Vi{constructor(t){this.nodePubkey=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.rootSlot=void 0,this.votes=void 0,this.authorizedVoters=void 0,this.priorVoters=void 0,this.epochCredits=void 0,this.lastTimestamp=void 0,this.nodePubkey=t.nodePubkey,this.authorizedWithdrawer=t.authorizedWithdrawer,this.commission=t.commission,this.rootSlot=t.rootSlot,this.votes=t.votes,this.authorizedVoters=t.authorizedVoters,this.priorVoters=t.priorVoters,this.epochCredits=t.epochCredits,this.lastTimestamp=t.lastTimestamp}static fromAccountData(t){const r=rh.decode(Bt(t),4);let s=r.rootSlot;return r.rootSlotValid||(s=null),new Vi({nodePubkey:new C(r.nodePubkey),authorizedWithdrawer:new C(r.authorizedWithdrawer),commission:r.commission,votes:r.votes,rootSlot:s,authorizedVoters:r.authorizedVoters.map(nh),priorVoters:ih(r.priorVoters),epochCredits:r.epochCredits,lastTimestamp:r.lastTimestamp})}}function nh({authorizedVoter:a,epoch:t}){return{epoch:t,authorizedVoter:new C(a)}}function gs({authorizedPubkey:a,epochOfLastAuthorizedSwitch:t,targetEpoch:e}){return{authorizedPubkey:new C(a),epochOfLastAuthorizedSwitch:t,targetEpoch:e}}function ih({buf:a,idx:t,isEmpty:e}){return e?[]:[...a.slice(t+1).map(gs),...a.slice(0,t).map(gs)]}const ms={http:{devnet:"http://api.devnet.solana.com",testnet:"http://api.testnet.solana.com","mainnet-beta":"http://api.mainnet-beta.solana.com/"},https:{devnet:"https://api.devnet.solana.com",testnet:"https://api.testnet.solana.com","mainnet-beta":"https://api.mainnet-beta.solana.com/"}};function sh(a,t){const e=t===!1?"http":"https";if(!a)return ms[e].devnet;const r=ms[e][a];if(!r)throw new Error(`Unknown ${e} cluster: ${a}`);return r}async function oh(a,t,e,r){let s,i;e&&Object.prototype.hasOwnProperty.call(e,"lastValidBlockHeight")||e&&Object.prototype.hasOwnProperty.call(e,"nonceValue")?(s=e,i=r):i=e;const u=i&&{skipPreflight:i.skipPreflight,preflightCommitment:i.preflightCommitment||i.commitment,minContextSlot:i.minContextSlot},m=await a.sendRawTransaction(t,u),w=i&&i.commitment,M=(await(s?a.confirmTransaction(s,w):a.confirmTransaction(m,w))).value;if(M.err)throw m!=null?new dn({action:u!=null&&u.skipPreflight?"send":"simulate",signature:m,transactionMessage:`Status: (${JSON.stringify(M)})`}):new Error(`Raw transaction ${m} failed (${JSON.stringify(M)})`);return m}const ah=1e9,ch=Object.freeze(Object.defineProperty({__proto__:null,Account:Ja,AddressLookupTableAccount:fi,AddressLookupTableInstruction:$u,AddressLookupTableProgram:qi,Authorized:Mo,BLOCKHASH_CACHE_TIMEOUT_MS:uo,BPF_LOADER_DEPRECATED_PROGRAM_ID:Za,BPF_LOADER_PROGRAM_ID:mc,BpfLoader:yc,COMPUTE_BUDGET_INSTRUCTION_LAYOUTS:Be,ComputeBudgetInstruction:Hu,ComputeBudgetProgram:Fi,Connection:bo,Ed25519Program:$n,Enum:Ga,EpochSchedule:ao,FeeCalculatorLayout:so,Keypair:Tr,LAMPORTS_PER_SOL:ah,LOOKUP_TABLE_INSTRUCTION_LAYOUTS:De,Loader:kr,Lockup:bn,MAX_SEED_LENGTH:eo,Message:Ae,MessageAccountKeys:fn,MessageV0:br,NONCE_ACCOUNT_LENGTH:li,NonceAccount:Fn,PACKET_DATA_SIZE:Ge,PUBLIC_KEY_LENGTH:Ce,PublicKey:C,SIGNATURE_LENGTH_IN_BYTES:ln,SOLANA_SCHEMA:un,STAKE_CONFIG_ID:So,STAKE_INSTRUCTION_LAYOUTS:ne,SYSTEM_INSTRUCTION_LAYOUTS:Gt,SYSVAR_CLOCK_PUBKEY:Pe,SYSVAR_EPOCH_SCHEDULE_PUBKEY:oc,SYSVAR_INSTRUCTIONS_PUBKEY:ac,SYSVAR_RECENT_BLOCKHASHES_PUBKEY:_n,SYSVAR_RENT_PUBKEY:Cr,SYSVAR_REWARDS_PUBKEY:cc,SYSVAR_SLOT_HASHES_PUBKEY:uc,SYSVAR_SLOT_HISTORY_PUBKEY:hc,SYSVAR_STAKE_HISTORY_PUBKEY:xn,Secp256k1Program:Br,SendTransactionError:dn,SolanaJSONRPCError:F,SolanaJSONRPCErrorCode:lc,StakeAuthorizationLayout:Yu,StakeInstruction:Zu,StakeProgram:Hn,Struct:Ci,SystemInstruction:pc,SystemProgram:Jt,Transaction:Ot,TransactionExpiredBlockheightExceededError:Ni,TransactionExpiredNonceInvalidError:Er,TransactionExpiredTimeoutError:Oi,TransactionInstruction:$t,TransactionMessage:Rr,TransactionStatus:qe,VALIDATOR_INFO_KEY:xo,VERSION_PREFIX_MASK:Wn,VOTE_PROGRAM_ID:eh,ValidatorInfo:Di,VersionedMessage:zi,VersionedTransaction:Pr,VoteAccount:Vi,VoteAuthorizationLayout:Qu,VoteInit:_o,VoteInstruction:Xu,VoteProgram:qr,clusterApiUrl:sh,sendAndConfirmRawTransaction:oh,sendAndConfirmTransaction:hi},Symbol.toStringTag,{value:"Module"})),uh=yi(ch);function hh(a){if(a.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),e=0;e<t.length;e++)t[e]=255;for(var r=0;r<a.length;r++){var s=a.charAt(r),i=s.charCodeAt(0);if(t[i]!==255)throw new TypeError(s+" is ambiguous");t[i]=r}var u=a.length,m=a.charAt(0),w=Math.log(u)/Math.log(256),b=Math.log(256)/Math.log(u);function M(_){if(_ instanceof Uint8Array||(ArrayBuffer.isView(_)?_=new Uint8Array(_.buffer,_.byteOffset,_.byteLength):Array.isArray(_)&&(_=Uint8Array.from(_))),!(_ instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(_.length===0)return"";for(var E=0,A=0,N=0,U=_.length;N!==U&&_[N]===0;)N++,E++;for(var G=(U-N)*b+1>>>0,qt=new Uint8Array(G);N!==U;){for(var Ft=_[N],Qt=0,Lt=G-1;(Ft!==0||Qt<A)&&Lt!==-1;Lt--,Qt++)Ft+=256*qt[Lt]>>>0,qt[Lt]=Ft%u>>>0,Ft=Ft/u>>>0;if(Ft!==0)throw new Error("Non-zero carry");A=Qt,N++}for(var te=G-A;te!==G&&qt[te]===0;)te++;for(var Ee=m.repeat(E);te<G;++te)Ee+=a.charAt(qt[te]);return Ee}function x(_){if(typeof _!="string")throw new TypeError("Expected String");if(_.length===0)return new Uint8Array;for(var E=0,A=0,N=0;_[E]===m;)A++,E++;for(var U=(_.length-E)*w+1>>>0,G=new Uint8Array(U);_[E];){var qt=t[_.charCodeAt(E)];if(qt===255)return;for(var Ft=0,Qt=U-1;(qt!==0||Ft<N)&&Qt!==-1;Qt--,Ft++)qt+=u*G[Qt]>>>0,G[Qt]=qt%256>>>0,qt=qt/256>>>0;if(qt!==0)throw new Error("Non-zero carry");N=Ft,E++}for(var Lt=U-N;Lt!==U&&G[Lt]===0;)Lt++;for(var te=new Uint8Array(A+(U-Lt)),Ee=A;Lt!==U;)te[Ee++]=G[Lt++];return te}function L(_){var E=x(_);if(E)return E;throw new Error("Non-base"+u+" character")}return{encode:M,decodeUnsafe:x,decode:L}}var lh=hh;const fh=lh,dh="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";var ph=fh(dh),Mn=de&&de.__awaiter||function(a,t,e,r){function s(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function m(M){try{b(r.next(M))}catch(x){u(x)}}function w(M){try{b(r.throw(M))}catch(x){u(x)}}function b(M){M.done?i(M.value):s(M.value).then(m,w)}b((r=r.apply(a,t||[])).next())})},gh=de&&de.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(gn,"__esModule",{value:!0});gn.OKXSolanaProvider=void 0;const gr=uh,Ue=gh(ph),We=Ro;class Io{getRealChainId(t){if(t==null)if(this.chainsSet.size==1){let e="",r=this.defaultChainMap;if(this.chainsSet.forEach(function(s){r.has(s)&&(e=r.get(s))}),e=="")throw new Error("unsupported chainId");return e}else throw new Error("connected to multiple solana chains,chainId can not be null");else{if(t.startsWith("svm"))return t;if(this.caip.includes(t))return t;throw new Error("wrong chainId")}}getConnectedNamespace(){var t,e,r;(r=(e=(t=this.provider.session)===null||t===void 0?void 0:t.namespaces)===null||e===void 0?void 0:e.solana)===null||r===void 0||r.chains.forEach(s=>{this.chainsSet.add(s.split(":")[0])})}constructor(t){this.chainsSet=new Set,this.caip=["solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","sonic:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","sonic:EtWTRABZaYq6iMfeYKouRu166VU2xqa1"],this.defaultChainMap=new Map,this.provider=t,this.defaultChainMap.set("solana","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp"),this.defaultChainMap.set("sonic","sonic:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"),this.getConnectedNamespace()}signMessage(t,e){return Mn(this,void 0,void 0,function*(){var r,s,i;let u=t;((s=(r=this.provider.session)===null||r===void 0?void 0:r.wallet)===null||s===void 0?void 0:s.appName)=="OKX Wallet"?u=Ue.default.encode(new TextEncoder().encode(t)):u=t,e=this.getRealChainId(e);try{let m={chainId:e,method:"solana_signMessage",params:{message:u,pubkey:(i=this.getAccount(e))===null||i===void 0?void 0:i.address}},w=yield this.provider.request(m,e);if((0,We.logDebug)("signMessage111",w),"result"in w){let b=w.result;return new Promise((M,x)=>{var L;M({signature:Ue.default.decode(b),publicKey:(L=this.getAccount(e))===null||L===void 0?void 0:L.address})})}else return(0,We.logDebug)("signMessage111",w),new Promise((b,M)=>{b(w.error)})}catch(m){return console.error(" --Error--",m),new Promise((w,b)=>{w(m)})}})}getAccount(t){var e,r,s,i;let u=(r=(e=this.provider.session)===null||e===void 0?void 0:e.namespaces.solana)===null||r===void 0?void 0:r.accounts[0];if(t!=null&&(u=(i=(s=this.provider.session)===null||s===void 0?void 0:s.namespaces.solana)===null||i===void 0?void 0:i.accounts.filter(function(w){return w.startsWith(t)})[0]),(0,We.logDebug)("getAccount",u),!u)return;const m=u.split(":")[2];if(m)return{address:m,publicKey:new gr.PublicKey(m)}}signTransaction(t,e){var r,s;(0,We.logDebug)("OKXSolanaProvider",typeof t),e=this.getRealChainId(e);try{let i=t.serialize({requireAllSignatures:!1,verifySignatures:!1}),u={data:Ue.default.encode(i),from:(r=this.getAccount(e))===null||r===void 0?void 0:r.address};return this.getSignedTransaction("solana_signTransaction",u,e)}catch{let u=t.serialize(),m={data:Ue.default.encode(u),from:(s=this.getAccount(e))===null||s===void 0?void 0:s.address};return this.getSignedTransaction("solana_signTransaction",m,e)}}signAllTransactions(t,e){return Mn(this,void 0,void 0,function*(){e=this.getRealChainId(e);try{var r=t.map(i=>{var u,m;return i instanceof gr.VersionedTransaction?m=i.serialize():m=i.serialize({requireAllSignatures:!1,verifySignatures:!1}),{data:Ue.default.encode(m),from:(u=this.getAccount(e))===null||u===void 0?void 0:u.address}});const s=yield this.provider.request({method:"solana_signAllTransactions",params:{transactions:r}},e);if("result"in s){let i=s.result,u=JSON.parse(i).map(m=>{let w=Ue.default.decode(m);try{let b=gr.Transaction.from(w);return(0,We.logDebug)("verifySignatures",b.verifySignatures()),b}catch{return gr.VersionedTransaction.deserialize(w)}});return new Promise((m,w)=>{m(u)})}else return new Promise((i,u)=>{i(s)})}catch(s){return(0,We.logDebug)("getSignedTransaction",s),new Promise((i,u)=>{i(s)})}})}signAndSendTransaction(t,e){return Mn(this,void 0,void 0,function*(){var r,s;e=this.getRealChainId(e);try{let i={};try{let m=t.serialize({requireAllSignatures:!1,verifySignatures:!1});i={data:Ue.default.encode(m),from:(r=this.getAccount(e))===null||r===void 0?void 0:r.address}}catch{let w=t.serialize();i={data:Ue.default.encode(w),from:(s=this.getAccount(e))===null||s===void 0?void 0:s.address}}let u=yield this.provider.request({method:"solana_signAndSendTransaction",params:i},e);if("result"in u){let m=u.result;return new Promise((w,b)=>{w(m)})}else return new Promise((m,w)=>{m(u)})}catch(i){return(0,We.logDebug)("getSignedTransaction",i),new Promise((u,m)=>{u(i)})}})}getSignedTransaction(t,e,r){return Mn(this,void 0,void 0,function*(){try{let s=yield this.provider.request({method:t,params:e},r);if("result"in s){let i=s.result,u=Ue.default.decode(i),m;try{m=gr.Transaction.from(u)}catch{m=gr.VersionedTransaction.deserialize(u)}return m instanceof gr.VersionedTransaction||(0,We.logDebug)("verifySignatures",m.verifySignatures()),new Promise((w,b)=>{w(m)})}else return new Promise((i,u)=>{u(s)})}catch(s){return(0,We.logDebug)("getSignedTransaction",s),new Promise((i,u)=>{i(s)})}})}}gn.OKXSolanaProvider=Io;gn.default=Io;(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.OKXSolanaProvider=void 0;var t=gn;Object.defineProperty(a,"OKXSolanaProvider",{enumerable:!0,get:function(){return t.OKXSolanaProvider}})})(vs);const mh="solana",yh=Bo({props:{chainId:{type:String,required:!0},chainName:String},setup(a){const t=a.chainId,e=Hi({}),r=Hi("");return{chainId:t,chainNamespaces:{solana:{chains:[t],defaultChain:t}},chainName:a.chainName,transaction:e,transactionResult:r,solProvider:void 0}},components:{ConnectLayout:Po},computed:{usesSolanaChain(){return this.chainId.startsWith(mh)}},methods:{getProvider(){if(!$i.provider)throw alert("Please connect a wallet first"),Error("No provider");this.solProvider||(this.solProvider=new vs.OKXSolanaProvider($i.provider))},async prepareTransaction(){try{this.getProvider()}catch(r){throw r}const a=new bo(this.getSolConnect()),t=this.solProvider.getAccount();if(!t)throw Error("No account found");const{blockhash:e}=await a.getLatestBlockhash();return{account:t,blockhash:e}},async sol_signMessage(){try{this.getProvider()}catch(e){console.error(e.message);return}this.transaction={method:"solana_signMessage",params:{message:"Hello Solana",pubkey:""}};const a=await this.solProvider.signMessage("Hello Solana",this.chainId);console.log("sol signMessage message",a);const t=To.sign.detached.verify(new TextEncoder().encode("Hello Solana"),a.signature,new C(a.publicKey).toBytes());console.log(t),this.transactionResult=String(t)},async sol_signVersionedTransaction(){let a,t;try{const i=await this.prepareTransaction();a=i.account,t=i.blockhash}catch(i){console.error(i.message);return}const e=new Rr({payerKey:a.publicKey,recentBlockhash:t,instructions:[Jt.transfer({fromPubkey:a.publicKey,toPubkey:a.publicKey,lamports:100})]}).compileToV0Message();let r=new Pr(e);this.transaction=r;let s=await this.solProvider.signTransaction(r,this.chainId);console.log("sol_signTransaction result",JSON.stringify(s)),typeof s=="string"?this.transactionResult=s:this.transactionResult=JSON.stringify(s)},async sol_signAndSendVersionedTransaction(){let a,t;try{const i=await this.prepareTransaction();a=i.account,t=i.blockhash}catch(i){console.error(i.message);return}const e=new Rr({payerKey:a.publicKey,recentBlockhash:t,instructions:[Jt.transfer({fromPubkey:a.publicKey,toPubkey:a.publicKey,lamports:100})]}).compileToV0Message();let r=new Pr(e);this.transaction=r;let s=await this.solProvider.signAndSendTransaction(r,this.chainId);console.log("sol_signTransaction result",JSON.stringify(s)),typeof s=="string"?this.transactionResult=s:this.transactionResult=JSON.stringify(s)},async sol_signAllVersionedTransactions(){let a,t;try{const i=await this.prepareTransaction();a=i.account,t=i.blockhash}catch(i){console.error(i.message);return}const e=new Rr({payerKey:a.publicKey,recentBlockhash:t,instructions:[Jt.transfer({fromPubkey:a.publicKey,toPubkey:a.publicKey,lamports:100})]}).compileToV0Message();let r=new Pr(e);this.transaction=r;let s=await this.solProvider.signAllTransactions([r],this.chainId);console.log("sol_signTransaction result",JSON.stringify(s)),typeof s=="string"?this.transactionResult=s:this.transactionResult=JSON.stringify(s)},async sol_signAndSendTransaction(){let a,t;try{const s=await this.prepareTransaction();a=s.account,t=s.blockhash}catch(s){console.error(s.message);return}const e=new Ot({feePayer:a.publicKey,recentBlockhash:t}).add(Jt.transfer({fromPubkey:a.publicKey,toPubkey:a.publicKey,lamports:100}));this.transaction=e;const r=await this.solProvider.signAndSendTransaction(e,this.chainId);this.transactionResult=JSON.stringify(r)},async sol_signTransaction(){let a,t;try{const s=await this.prepareTransaction();a=s.account,t=s.blockhash}catch(s){console.error(s.message);return}const e=new Ot({feePayer:a.publicKey,recentBlockhash:t}).add(Jt.transfer({fromPubkey:a.publicKey,toPubkey:a.publicKey,lamports:1e3}));this.transaction=e;let r=await this.solProvider.signTransaction(e,this.chainId);console.log("sol_signTransaction result",JSON.stringify(r)),typeof r=="string"?this.transactionResult=r:this.transactionResult=JSON.stringify(r)},async sol_signAllTransactions(){let a,t;try{const s=await this.prepareTransaction();a=s.account,t=s.blockhash}catch(s){console.error(s.message);return}const e=new Ot({feePayer:a.publicKey,recentBlockhash:t}).add(Jt.transfer({fromPubkey:a.publicKey,toPubkey:a.publicKey,lamports:100}));this.transaction=e;let r=await this.solProvider.signAllTransactions([e],this.chainId);typeof r=="string"?this.transactionResult=r:this.transactionResult=JSON.stringify(r)},getSolConnect(){let a="https://www.okx.com/fullnode/sol/discover/rpc";return this.chainId==="solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp"?a="https://www.okx.com//fullnode/sol/discover/rpc":this.chainId==="solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"?a="https://www.okx.com/fullnode/soltestnet/discover/rpc":this.chainId==="svm:70000062"&&(a="https://www.okx.com/fullnode/sonic/testnet/discover/rpc"),a}}});function wh(a,t,e,r,s,i){const u=Gn("el-button"),m=Gn("el-card"),w=Gn("ConnectLayout");return jn(),Jn(w,{chainId:a.chainId,chainNamespaces:a.chainNamespaces,transaction:a.transaction,transactionResult:a.transactionResult},{default:Re(()=>[Ir(m,null,{header:Re(()=>[Co("div",null,No(a.chainName||"SOL")+" methods",1)]),default:Re(()=>[Ir(u,{type:"primary",onClick:a.sol_signMessage},{default:Re(()=>t[0]||(t[0]=[pr("solana_signMessage")])),_:1},8,["onClick"]),Ir(u,{type:"primary",onClick:a.sol_signTransaction},{default:Re(()=>t[1]||(t[1]=[pr("solana_signTransaction")])),_:1},8,["onClick"]),a.usesSolanaChain?(jn(),Jn(u,{key:0,type:"primary",onClick:a.sol_signVersionedTransaction},{default:Re(()=>t[2]||(t[2]=[pr(" solana_signVersionedTransaction ")])),_:1},8,["onClick"])):Gi("",!0),Ir(u,{type:"primary",onClick:a.sol_signAllTransactions},{default:Re(()=>t[3]||(t[3]=[pr(" solana_signAllTransactions ")])),_:1},8,["onClick"]),Ir(u,{type:"primary",onClick:a.sol_signAllVersionedTransactions},{default:Re(()=>t[4]||(t[4]=[pr(" solana_signAllVersionedTransactions ")])),_:1},8,["onClick"]),Ir(u,{type:"primary",onClick:a.sol_signAndSendTransaction},{default:Re(()=>t[5]||(t[5]=[pr(" solana_signAndSendTransaction ")])),_:1},8,["onClick"]),a.usesSolanaChain?(jn(),Jn(u,{key:1,type:"primary",onClick:a.sol_signAndSendVersionedTransaction},{default:Re(()=>t[6]||(t[6]=[pr(" solana_signAndSendVersionedTransaction ")])),_:1},8,["onClick"])):Gi("",!0)]),_:1})]),_:1},8,["chainId","chainNamespaces","transaction","transactionResult"])}const Eh=Lo(yh,[["render",wh]]);export{Eh as S};
