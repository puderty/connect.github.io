(function(){var e={9277:function(e,t,o){"use strict";var n=o(5130),a=o(2098),l=(o(4188),o(6768)),r=o(4232);const s={id:"app"};function i(e,t,o,a,i,c){const d=(0,l.g2)("el-header"),u=(0,l.g2)("el-col"),f=(0,l.g2)("el-row"),g=(0,l.g2)("el-card"),p=(0,l.g2)("el-checkbox"),h=(0,l.g2)("el-option"),k=(0,l.g2)("el-select"),w=(0,l.g2)("el-input"),b=(0,l.g2)("el-button"),m=(0,l.g2)("qrcode-vue"),y=(0,l.g2)("el-main"),v=(0,l.g2)("el-container");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("div",s,[(0,l.bF)(v,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,null,{default:(0,l.k6)((()=>t[12]||(t[12]=[(0,l.eW)("OKX Connect")]))),_:1}),(0,l.bF)(y,null,{default:(0,l.k6)((()=>[(0,l.bF)(g,{class:"wallet-info"},{header:(0,l.k6)((()=>t[13]||(t[13]=[(0,l.Lk)("div",null,"钱包信息",-1)]))),default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"info-row"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{span:24},{default:(0,l.k6)((()=>[t[14]||(t[14]=(0,l.Lk)("strong",null,"Wallet Address:",-1)),(0,l.eW)(" "+(0,r.v_)(c.getWalletAddress),1)])),_:1})])),_:1}),(0,l.bF)(f,{class:"info-row"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{span:24},{default:(0,l.k6)((()=>[t[15]||(t[15]=(0,l.Lk)("strong",null,"当前状态 :",-1)),(0,l.eW)(" "+(0,r.v_)(e.currentStatus),1)])),_:1})])),_:1})])),_:1}),(0,l.bF)(g,{class:"wallet-actions"},{header:(0,l.k6)((()=>t[16]||(t[16]=[(0,l.Lk)("div",null,"钱包操作",-1)]))),default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"info-row"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{span:24},{default:(0,l.k6)((()=>[(0,l.bF)(p,{modelValue:e.withUI,"onUpdate:modelValue":t[0]||(t[0]=t=>e.withUI=t),onChange:e.handleWithUI},{default:(0,l.k6)((()=>t[17]||(t[17]=[(0,l.eW)("是否展示UI")]))),_:1},8,["modelValue","onChange"])])),_:1})])),_:1}),(0,l.bF)(f,{style:{"align-items":"center","justify-content":"space-between"}},{default:(0,l.k6)((()=>[(0,l.bF)(u,{span:4,style:{gap:"2px"}},{default:(0,l.k6)((()=>t[18]||(t[18]=[(0,l.Lk)("p",{style:{"font-size":"11pt",margin:"0px"}},"Return Strategy",-1),(0,l.Lk)("p",{style:{"font-size":"9pt",margin:"0px"}},"(Mobile only)",-1)]))),_:1}),(0,l.bF)(u,{span:10},{default:(0,l.k6)((()=>[(0,l.bF)(k,{modelValue:e.returnStrategy,"onUpdate:modelValue":t[1]||(t[1]=t=>e.returnStrategy=t),onChange:c.handleReturnStrategySelect,placeholder:"Return Strategy"},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.returnStrategies,(e=>((0,l.uX)(),(0,l.Wv)(h,{key:`return-strategy-select-option-${e}`,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),(0,l.bF)(u,{span:10},{default:(0,l.k6)((()=>["deeplink"===e.returnStrategy?((0,l.uX)(),(0,l.Wv)(w,{key:0,modelValue:e.deeplink,"onUpdate:modelValue":t[2]||(t[2]=t=>e.deeplink=t),onChange:c.handleReturnStrategyDeeplink,placeholder:"Deeplink",disabled:"deeplink"!==e.returnStrategy,style:{margin:"0px"}},null,8,["modelValue","onChange","disabled"])):(0,l.Q3)("",!0)])),_:1})])),_:1}),(0,l.bF)(f,{gutter:12},{default:(0,l.k6)((()=>[(0,l.bF)(u,{span:24},{default:(0,l.k6)((()=>[(0,l.bF)(w,{modelValue:e.testProofPayload,"onUpdate:modelValue":t[3]||(t[3]=t=>e.testProofPayload=t),placeholder:"proofPayload"},null,8,["modelValue"])])),_:1})])),_:1}),e.showVerifyRow?((0,l.uX)(),(0,l.Wv)(f,{key:0,class:"info-row"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{span:24},{default:(0,l.k6)((()=>[t[19]||(t[19]=(0,l.Lk)("strong",null,"签名验证:",-1)),(0,l.eW)(" "+(0,r.v_)(e.ProofPayloadVerify),1)])),_:1})])),_:1})):(0,l.Q3)("",!0),(0,l.bF)(f,{gutter:12,class:"button-row"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{span:24},{default:(0,l.k6)((()=>[(0,l.bF)(b,{type:"warning",onClick:c.walletInit,icon:"el-icon-refresh-right"},{default:(0,l.k6)((()=>t[20]||(t[20]=[(0,l.eW)("钱包初始化")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,l.bF)(f,{gutter:12,class:"button-row"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{span:24},{default:(0,l.k6)((()=>[(0,l.bF)(b,{type:"primary",onClick:c.connectBtnClicked,icon:"el-icon-connection"},{default:(0,l.k6)((()=>[(0,l.eW)((0,r.v_)(e.connectStatusStr),1)])),_:1},8,["onClick"])])),_:1})])),_:1}),((0,l.uX)(),(0,l.Wv)(l.Im,{to:"body"},[e.showModal?((0,l.uX)(),(0,l.CE)("div",{key:0,class:"modal-overlay",onClick:t[6]||(t[6]=(...e)=>c.closeModal&&c.closeModal(...e))},[(0,l.Lk)("div",{class:"modal-content",onClick:t[5]||(t[5]=(0,n.D$)((()=>{}),["stop"]))},[(0,l.Lk)("button",{class:"close-button",onClick:t[4]||(t[4]=(...e)=>c.closeModal&&c.closeModal(...e))},"×"),t[21]||(t[21]=(0,l.Lk)("h2",null,"扫描二维码",-1)),(0,l.bF)(m,{value:e.qrValue,size:200,level:"H"},null,8,["value"])])])):(0,l.Q3)("",!0)])),(0,l.bF)(f,{gutter:12,class:"button-row"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{span:24},{default:(0,l.k6)((()=>[(0,l.bF)(b,{type:"warning",onClick:c.resotreConnectAction,icon:"el-icon-refresh-right"},{default:(0,l.k6)((()=>t[22]||(t[22]=[(0,l.eW)("尝试重连")]))),_:1},8,["onClick"])])),_:1})])),_:1}),(0,l.bF)(f,{gutter:12,class:"button-row"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{span:24},{default:(0,l.k6)((()=>[(0,l.bF)(b,{type:"danger",onClick:c.disconnectAction,icon:"el-icon-switch-button",disabled:0==e.walletAddress.length},{default:(0,l.k6)((()=>[(0,l.eW)((0,r.v_)(e.disconnectStatusStr),1)])),_:1},8,["onClick","disabled"])])),_:1})])),_:1})])),_:1}),(0,l.bF)(g,{class:"transaction"},{header:(0,l.k6)((()=>t[23]||(t[23]=[(0,l.Lk)("div",null,"交易",-1)]))),default:(0,l.k6)((()=>[(0,l.bF)(f,{gutter:12},{default:(0,l.k6)((()=>[(0,l.bF)(u,{span:8},{default:(0,l.k6)((()=>[(0,l.bF)(b,{type:"primary",onClick:t[7]||(t[7]=e=>c.mockSwap())},{default:(0,l.k6)((()=>t[24]||(t[24]=[(0,l.eW)("swap")]))),_:1})])),_:1}),(0,l.bF)(u,{span:8},{default:(0,l.k6)((()=>[(0,l.bF)(b,{type:"success",onClick:t[8]||(t[8]=e=>c.mockTransaction())},{default:(0,l.k6)((()=>t[25]||(t[25]=[(0,l.eW)("转账")]))),_:1})])),_:1})])),_:1}),(0,l.bF)(u,{xs:24,sm:12},{default:(0,l.k6)((()=>[t[26]||(t[26]=(0,l.Lk)("div",{class:"input-label"},"交易数据:",-1)),(0,l.bF)(w,{modelValue:e.testTransaction,"onUpdate:modelValue":t[9]||(t[9]=t=>e.testTransaction=t),placeholder:"sendTransactions"},null,8,["modelValue"])])),_:1}),(0,l.bF)(u,{xs:24,sm:12},{default:(0,l.k6)((()=>[t[27]||(t[27]=(0,l.Lk)("div",{class:"input-label"},"签名结果 :",-1)),(0,l.bF)(w,{modelValue:e.testboc,"onUpdate:modelValue":t[10]||(t[10]=t=>e.testboc=t),placeholder:"boc"},null,8,["modelValue"])])),_:1}),(0,l.bF)(f,{gutter:12,class:"button-row"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{span:24},{default:(0,l.k6)((()=>[(0,l.bF)(b,{type:"primary",onClick:t[11]||(t[11]=e=>c.sendTransaction())},{default:(0,l.k6)((()=>[(0,l.eW)((0,r.v_)(e.testTransactionStr),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})]),t[28]||(t[28]=(0,l.Lk)("div",{id:"button-root"},null,-1))],64)}var c=o(9273),d=o(7805),u=o(9877),f="none",g="tg://resolve",p="en_US",h=d.THEME.LIGHT,k={name:"App",components:{QrcodeVue:u.Ay},data:()=>({testTopic:"",testPublicKey:"",testProofPayload:"",pendingDeepLink:"-",logList:[],connectReady:!1,connectStatusStr:"连接钱包",disconnectStatusStr:"断开钱包",localPubKey:"",localSecKey:"",testTransaction:"",testTransactionStr:"发送交易",walletAddress:"",testboc:"",ProofPayloadVerify:"",showModal:!1,showVerifyRow:!1,qrValue:"https://www.okx.com/download",currentStatus:"",language:p,theme:h,THEME:d.THEME,withUI:"true"==localStorage.getItem("autoRefresh"),returnStrategies:["none","back","deeplink"],returnStrategy:f,deeplink:g,handleWithUI:e=>{localStorage.setItem("autoRefresh",`${e}`),location.reload()}}),computed:{getWalletAddress:function(){return this.walletAddress}},methods:{async connectBtnClicked(){console.log(`encryptStoreMsg   connectBtnClicked  ${Date.now()}`),this.testTonSdk()},async disconnectAction(){try{console.log("get disconnect wallet btn clicked"),await window.provider.disconnect()}catch(e){console.log("Disconnect  error ==>> ",e.message),this.currentStatus=e.message}},async walletInit(){var e;this.withUI?(console.log("---init wallet UI--"),e=new d.OKXTonConnectUI({dappMetaData:{name:"OKX TON Connect Demo",icon:"https://avatars.githubusercontent.com/u/37784886",manifestUrl:"https://app.ston.fi/tonconnect-manifest.json"},actionsConfiguration:{returnStrategy:"tg://resolve",tmaReturnUrl:"back",modals:"all"},uiPreferences:{theme:d.THEME.LIGHT},buttonRootId:"button-root",language:"en_US"})):(console.log("---init wallet---"),e=new c.OKXTonConnect({metaData:{name:"OKX TON Connect Demo",icon:"https://avatars.githubusercontent.com/u/37784886"}})),window.tonTest=e},async resotreConnectAction(){console.log("get restore wallet btn clicked"),window.provider.restoreConnection()},async mockSwap(){var e={messages:[{address:"EQARULUYsmJq1RiZ-YiH-IJLcAZUVkVff-KBPwEmmaQGH6aC",amount:"205000000",payload:"te6cckEBAgEAhwABbQ+KfqUAAADNgG7tIEATEtAIAO87mQKicbKgHIk4pSPP4k5xhHqutqYgAB7USnesDnCcECwbgQMBAJUlk4VhgBD3JEg1TUr75iTijBghOKm/sxNDXUBl7CD6WMut0Q85x4RafwA/Es89DBXoTxuqxVFxyBbzt9Rav2HBUKl7hmkvLuKHLBCW57aK"}],validUntil:1792481054,network:-239};this.testTransaction=JSON.stringify(e)},async mockTransaction(){let e=window.provider.account,t=e.address;var o={messages:[{address:"UQDXlIPZgiC7ugBqdg68ZQ4zBVGaTEfTQd1ywCDB8exACtQK",amount:11e5}],valid_until:1792481054,from:t,network:"-239"};this.testTransaction=JSON.stringify(o)},async mockTransactionNFT(){var e={from:"EQD8Szz0MFehPG6rFUXHIFvO31Fq_YcFQqXuGaS8u4ocsMqN",messages:[{address:"EQBpDpRrE3b4g01AXoyCQbnUGTpVCCgCBGyTPWvKvwDyQKqZ",amount:"20000000",payload:"te6cckEBAQEAUwAAoV/MPRQAAAAAAAAAAIAa8pB7MEQXd0ANTsHXjKHGYKozSYj6aDuuWAQYPj2IAVAD8Szz0MFehPG6rFUXHIFvO31Fq/YcFQqXuGaS8u4ocsAgKGBCo0E="}],valid_until:1792481054,network:"-239"};this.testTransaction=JSON.stringify(e)},async sendTransaction(){if(console.log("sendTransaction"),console.log("sendTransaction内容------",this.testTransaction),this.testTransaction){const o=JSON.parse(this.testTransaction);try{var e=await window.provider.sendTransaction(o);this.testboc=e.boc}catch(t){t.code===c.OKX_CONNECT_ERROR_CODES.USER_REJECTS_ERROR?this.testboc="用户拒绝交易":this.testboc="签名错误！"}}else alert("交易数据为空，请选则或输入交易数据。")},async testTonSdk(){if(window.provider.connected)console.log("you have connected wallet");else{console.log("APP ---connect Proof---\x3e>>>----",this.testProofPayload);let e={tonProof:this.testProofPayload,redirect:"tg://resolve",tmaReturnUrl:"tg://resolve"};this.isPC(),!this.isSafariOrChrome()||window?.TelegramWebview||window?.TelegramWebviewProxy||(e.redirect=null),console.log("Is Mobile ==>",e),window.provider instanceof d.OKXTonConnectUI?(this.testProofPayload&&window.provider.setConnectRequestParameters({state:"ready",value:{tonProof:this.testProofPayload}}),await window.provider.openModal().catch((e=>console.error("发生了错误：",e)))):window.provider instanceof c.OKXTonConnect&&window.provider.connect(e).then((e=>{console.log("Current Url ---:",e),e&&this.isPC()&&(this.qrValue=e,this.showModal=!0)}))}},closeModal(){this.showModal=!1},isPC(){const e=navigator.userAgent;console.log("current device ua is ===>",e);const t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"];let o=!0;for(let n=0;n<t.length;n++)if(e.indexOf(t[n])>0){o=!1;break}return o},isSafariOrChrome(){const e=navigator.userAgent,t=["Safari","Chrome"];let o=!1;for(let n=0;n<t.length;n++)if(e.indexOf(t[n])>0){o=!0;break}return o},handleReturnStrategySelect(e){console.log("handleReturnStrat",window.provider),f="deeplink"===e?this.deeplink:e,this.withUI&&(window.provider.uiOptions={actionsConfiguration:{returnStrategy:f,modals:"all"},buttonRootId:"button-root"})},handleReturnStrategyDeeplink(e){console.log(window.provider),f=e,this.withUI&&(window.provider.uiOptions={actionsConfiguration:{returnStrategy:e,modals:"all"},buttonRootId:"button-root"})}},created(){for(const e of Object.values(c.OKX_TON_CONNECTION_AND_TRANSACTION_EVENT))console.log(e),window.addEventListener(e,(t=>{console.log(e,t.detail),this.currentStatus=e}));window.addEventListener("okx-ton-connect-connection-info-before-jump",(e=>{console.log("链接详情   :::",e.detail)}))},mounted(){var e,t=document.createElement("script");t.src="https://telegram.org/js/telegram-web-app.js",t.id="tgsdk",document.getElementsByTagName("head")[0].appendChild(t),window.okxLogDebug=!0,this.connectReady=!0,document.title="OKX Connect TON",this.withUI?(console.log("---init wallet UI--"),e=new d.OKXTonConnectUI({dappMetaData:{name:"OKX TON Connect Demo",icon:"https://avatars.githubusercontent.com/u/37784886",manifestUrl:"https://app.ston.fi/tonconnect-manifest.json"},actionsConfiguration:{returnStrategy:"tg://resolve",tmaReturnUrl:"back",modals:"all"},uiPreferences:{theme:d.THEME.LIGHT},buttonRootId:"button-root",language:"en_US"})):(console.log("---init wallet------"),e=new c.OKXTonConnect({metaData:{name:"OKX TON Connect Demo",icon:"https://avatars.githubusercontent.com/u/37784886"}})),window.provider=e,window.provider.onStatusChange((e=>{if(console.log("APP ---TON.onStatusChange>>----",e),e){if(this.walletAddress=e.account.address,this.testProofPayload){var t={address:this.walletAddress,network:e.account.chain,public_key:e.account.publicKey,proof:{...e.connectItems.tonProof.proof,state_init:e.account.walletStateInit}};console.log(`checkProof => ${JSON.stringify(t)}`)}else this.ProofPayloadVerify=": no proof";this.showModal=!1}else this.walletAddress="disconnected"}),(e=>{this.showModal=!1,e.code===c.OKX_CONNECT_ERROR_CODES.USER_REJECTS_ERROR?this.walletAddress=`用户拒绝链接: code(${e.code}) `:this.walletAddress=`链接报错: code(${e.code})  ${e.message}`}))}},w=o(1241);const b=(0,w.A)(k,[["render",i],["__scopeId","data-v-aad3e5d2"]]);var m=b;const y=(0,n.Ef)(m);y.use(a.A),y.mount("#app")},9432:function(){},477:function(){},1281:function(){}},t={};function o(n){var a=t[n];if(void 0!==a)return a.exports;var l=t[n]={exports:{}};return e[n].call(l.exports,l,l.exports,o),l.exports}o.m=e,function(){o.amdO={}}(),function(){var e=[];o.O=function(t,n,a,l){if(!n){var r=1/0;for(d=0;d<e.length;d++){n=e[d][0],a=e[d][1],l=e[d][2];for(var s=!0,i=0;i<n.length;i++)(!1&l||r>=l)&&Object.keys(o.O).every((function(e){return o.O[e](n[i])}))?n.splice(i--,1):(s=!1,l<r&&(r=l));if(s){e.splice(d--,1);var c=a();void 0!==c&&(t=c)}}return t}l=l||0;for(var d=e.length;d>0&&e[d-1][2]>l;d--)e[d]=e[d-1];e[d]=[n,a,l]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var a,l,r=n[0],s=n[1],i=n[2],c=0;if(r.some((function(t){return 0!==e[t]}))){for(a in s)o.o(s,a)&&(o.m[a]=s[a]);if(i)var d=i(o)}for(t&&t(n);c<r.length;c++)l=r[c],o.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return o.O(d)},n=self["webpackChunkokxconnectdemo"]=self["webpackChunkokxconnectdemo"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[504],(function(){return o(9277)}));n=o.O(n)})();
//# sourceMappingURL=app.09e634bd.js.map